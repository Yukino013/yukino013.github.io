<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>我在看着你 | 我在看着你</title><meta name="author" content="黑板擦"><meta name="copyright" content="黑板擦"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="title: Vue3+TS封装组件库项目date: 2024-03-07 22:29:35tags: [Project,Vue,TypeScript]category: Project 1.介绍2.项目文件结构安装eslint插件 项目文件结构  components ​	 Button ​			Button.vue - 组件 ​			style.css - 样式 ​			types.ts -">
<meta property="og:type" content="article">
<meta property="og:title" content="我在看着你">
<meta property="og:url" content="http://example.com/2024/03/07/Vue3-TS%E5%B0%81%E8%A3%85%E7%BB%84%E4%BB%B6%E5%BA%93%E9%A1%B9%E7%9B%AE/index.html">
<meta property="og:site_name" content="我在看着你">
<meta property="og:description" content="title: Vue3+TS封装组件库项目date: 2024-03-07 22:29:35tags: [Project,Vue,TypeScript]category: Project 1.介绍2.项目文件结构安装eslint插件 项目文件结构  components ​	 Button ​			Button.vue - 组件 ​			style.css - 样式 ​			types.ts -">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/Snipaste_2024-04-06_01-13-21.png">
<meta property="article:published_time" content="2024-03-07T14:29:35.228Z">
<meta property="article:modified_time" content="2024-04-23T13:37:51.517Z">
<meta property="article:author" content="黑板擦">
<meta property="article:tag" content="博客">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/Snipaste_2024-04-06_01-13-21.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/2024/03/07/Vue3-TS%E5%B0%81%E8%A3%85%E7%BB%84%E4%BB%B6%E5%BA%93%E9%A1%B9%E7%9B%AE/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '我在看着你',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-04-23 21:37:51'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const now = new Date()
          const hour = now.getHours()
          const isNight = hour <= 6 || hour >= 18
          if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
          else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/./img/Snipaste_2024-04-06_01-08-30.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">47</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">23</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">19</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 時間軸</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 追番</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/bangumis/"><i class="fa-fw fas fa-video"></i><span> 番剧</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/./img/Snipaste_2024-04-06_01-13-21.png')"><nav id="nav"><span id="blog-info"><a href="/" title="我在看着你"><span class="site-name">我在看着你</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 時間軸</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 追番</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/bangumis/"><i class="fa-fw fas fa-video"></i><span> 番剧</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">无题</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-03-07T14:29:35.228Z" title="发表于 2024-03-07 22:29:35">2024-03-07</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-04-23T13:37:51.517Z" title="更新于 2024-04-23 21:37:51">2024-04-23</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>title: Vue3+TS封装组件库项目<br>date: 2024-03-07 22:29:35<br>tags: [Project,Vue,TypeScript]<br>category: Project</p>
<h2 id="1-介绍"><a href="#1-介绍" class="headerlink" title="1.介绍"></a>1.介绍</h2><h2 id="2-项目文件结构"><a href="#2-项目文件结构" class="headerlink" title="2.项目文件结构"></a>2.项目文件结构</h2><p><strong>安装eslint插件</strong></p>
<p><strong>项目文件结构</strong></p>
<ul>
<li><p>components</p>
<p>​	 Button</p>
<p>​			Button.vue - 组件</p>
<p>​			style.css - 样式</p>
<p>​			types.ts - 一些辅助的typescript类型</p>
<p>​			Button.test.tsx -测试文件</p>
</li>
<li><p>hooks</p>
<p>​			useMousePosition.ts</p>
</li>
</ul>
<p><strong>初始化项目</strong></p>
<ul>
<li>vue官方基于vite的封装工具-create-vue   <a target="_blank" rel="noopener" href="https://github.com/vuejs/create-vue">https://github.com/vuejs/create-vue</a></li>
<li>npm create vue@3</li>
<li>Vite+Vue3+Typescript+ESlint</li>
</ul>
<h4 id="–save-dev-的作用"><a href="#–save-dev-的作用" class="headerlink" title="–save-dev 的作用"></a>–save-dev 的作用</h4><p>使用命令 –save 或者说不写命令 –save  ,都会把信息记录到 dependencies   中；</p>
<p>dependencies 中记录的都是项目在运行时需要的文件；</p>
<p>使用命令 –save-dev 则会把信息记录到 devDependencies  中；</p>
<p>devDependencies 中记录的是项目在开发过程中需要使用的一些文件，在项目最终运行时是不需要的；</p>
<p>也就是说我们开发完成后，最终的项目中是不需要这些文件的；</p>
<h2 id="3-Button组件"><a href="#3-Button组件" class="headerlink" title="3.Button组件"></a>3.Button组件</h2><h3 id="1-需求分析"><a href="#1-需求分析" class="headerlink" title="(1)需求分析"></a>(1)需求分析</h3><p>Button组件大部分关注样式，没有交互。</p>
<p>根据分析可以得到具体的属性列表:</p>
<ul>
<li><p>type:不同的样式(Default,Primary.Danger,Info,Success,Warning)</p>
</li>
<li><p>plain:样式的不同展现模式 boolean</p>
</li>
<li><p>round:圆角 boolean</p>
</li>
<li><p>circle: 圆形按钮,适合图标boolean</p>
</li>
<li><p>size: 不同大小(small&#x2F;normal&#x2F;large)</p>
</li>
<li><p>disabled: 禁用boolean</p>
</li>
<li><p>图标:后面再添加</p>
</li>
<li><p>loading: 后面再添加</p>
<p><strong>Button组件的本质就是class名称的组合</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span>=<span class="string">&quot;vk-button-primary vk-button-large is-plain is-round is-disabled&quot;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="2-代码编写"><a href="#2-代码编写" class="headerlink" title="(2)代码编写"></a>(2)代码编写</h3><h4 id="1-导入接口问题"><a href="#1-导入接口问题" class="headerlink" title="1.导入接口问题"></a>1.导入接口问题</h4><p>为了在声明 <code>props</code> 和 <code>emits</code> 选项时获得完整的类型推导支持，我们可以使用 <code>defineProps</code> 和 <code>defineEmits</code> API，它们将自动地在 <code>&lt;script setup&gt;</code> 中可用：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">const props = defineProps(&#123;</span><br><span class="line">  foo: String</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">const emit = defineEmits([&#x27;change&#x27;, &#x27;delete&#x27;])</span><br><span class="line">// setup 代码</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li><code>defineProps</code> 和 <code>defineEmits</code> 都是只能在 <code>&lt;script setup&gt;</code> 中使用的<strong>编译器宏</strong>。他们不需要导入，且会随着 <code>&lt;script setup&gt;</code> 的处理过程一同被编译掉。</li>
<li><code>defineProps</code> 接收与 <code>props</code> 选项相同的值，<code>defineEmits</code> 接收与 <code>emits</code> 选项相同的值。</li>
<li><code>defineProps</code> 和 <code>defineEmits</code> 在选项传入后，会提供恰当的类型推导。</li>
</ul>
<p>问题：</p>
<p><img src="/../images/Vue3_%E5%B0%81%E8%A3%85%E7%BB%84%E4%BB%B6%E5%BA%93%E9%A1%B9%E7%9B%AE/3.png"></p>
<p>在定义完按钮类型后在Button组件导入时会有爆红的问题(无法引入)：</p>
<p><img src="/../images/Vue3_%E5%B0%81%E8%A3%85%E7%BB%84%E4%BB%B6%E5%BA%93%E9%A1%B9%E7%9B%AE/1.png"></p>
<p>如果是Vue3.2版本及以下，我们需要安装一个插件Vue Macros来解决这个问题，但这个问题在Vue3.3中已经解决，不需要再安装插件</p>
<img src="../images/Vue3_封装组件库项目/2.png" style="zoom:80%;">



<h4 id="2-defineProps–为组件的-props-标注类型"><a href="#2-defineProps–为组件的-props-标注类型" class="headerlink" title="2.defineProps–为组件的 props 标注类型"></a>2.defineProps–为组件的 props 标注类型</h4><p>可以将 props 的类型移入一个单独的接口中：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">interface Props &#123;</span><br><span class="line">  foo: string</span><br><span class="line">  bar?: number</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const props = defineProps&lt;Props&gt;()</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>这同样适用于 <code>Props</code> 从另一个源文件中导入的情况：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import type &#123; Props &#125; from &#x27;./foo&#x27;</span><br><span class="line"></span><br><span class="line">const props = defineProps&lt;Props&gt;()</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>



<h4 id="3-withDefaults–为-props-声明默认值"><a href="#3-withDefaults–为-props-声明默认值" class="headerlink" title="3.withDefaults–为 props 声明默认值"></a>3.withDefaults–为 props 声明默认值</h4><p><img src="/../images/Vue3_%E5%B0%81%E8%A3%85%E7%BB%84%E4%BB%B6%E5%BA%93%E9%A1%B9%E7%9B%AE/11.png"></p>
<p><strong>例子1:</strong></p>
<p><strong>父组件:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;TsSample :msg=&#x27;msg&#x27; @on-updated=&#x27;onUpdated&#x27; title=&#x27;title&#x27; @on-delete=&#x27;onDelete&#x27;/&gt; </span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<p><strong>子组件:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;h1&gt;ts sample&lt;/h1&gt;</span><br><span class="line">  &lt;p&gt;&#123;&#123; msg &#125;&#125;&lt;/p&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<p>第一种方式:<strong>分离模式</strong></p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Props</span>&#123;</span><br><span class="line">    msg?:(<span class="built_in">string</span>|<span class="built_in">number</span>|<span class="built_in">boolean</span>),</span><br><span class="line">     title?:<span class="built_in">string</span>[]</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="title function_">withDefaults</span>(defineProps&lt;<span class="title class_">Props</span>&gt;(),&#123;</span><br><span class="line">    <span class="attr">msg</span>:<span class="string">&#x27;hello&#x27;</span>,</span><br><span class="line">    <span class="attr">title</span>:<span class="function">()=&gt;</span>[<span class="string">&#x27;one&#x27;</span>,<span class="string">&#x27;two&#x27;</span>]</span><br><span class="line"> &#125;)</span><br></pre></td></tr></table></figure>

<p>第二种方式:<strong>组合模式</strong></p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">withDefaults</span>(</span><br><span class="line">  defineProps&lt;&#123; msg?: (<span class="built_in">string</span> | <span class="built_in">number</span> | <span class="built_in">boolean</span>), title?: <span class="built_in">string</span> &#125;&gt;(),&#123;</span><br><span class="line">      <span class="attr">msg</span>:<span class="string">&#x27;hello vite&#x27;</span>,</span><br><span class="line">      <span class="attr">title</span>:<span class="string">&#x27;默认标题&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h4 id="4-defineExpose"><a href="#4-defineExpose" class="headerlink" title="4.defineExpose"></a>4.defineExpose</h4><p><img src="/../images/Vue3_%E5%B0%81%E8%A3%85%E7%BB%84%E4%BB%B6%E5%BA%93%E9%A1%B9%E7%9B%AE/10.png"></p>
<h4 id="5-PropType"><a href="#5-PropType" class="headerlink" title="5.PropType"></a>5.PropType</h4><p><img src="/../images/Vue3_%E5%B0%81%E8%A3%85%E7%BB%84%E4%BB%B6%E5%BA%93%E9%A1%B9%E7%9B%AE/13.png"></p>
<p><img src="/../images/Vue3_%E5%B0%81%E8%A3%85%E7%BB%84%E4%BB%B6%E5%BA%93%E9%A1%B9%E7%9B%AE/14.png"></p>
<h4 id="6-defineOptions"><a href="#6-defineOptions" class="headerlink" title="6.defineOptions"></a>6.defineOptions</h4><p><img src="/../images/Vue3_%E5%B0%81%E8%A3%85%E7%BB%84%E4%BB%B6%E5%BA%93%E9%A1%B9%E7%9B%AE/15.png"></p>
<h4 id="7-CSS方案-PostCSS"><a href="#7-CSS方案-PostCSS" class="headerlink" title="7.CSS方案_PostCSS"></a>7.CSS方案_PostCSS</h4><p><strong>CSS预处理器</strong></p>
<ul>
<li><p>Sass-Ruby,LibSass</p>
</li>
<li><p>Less -Javascript,Less.js</p>
</li>
<li><p>Stylus-Node.js</p>
</li>
<li><p>Postcss <a target="_blank" rel="noopener" href="https://postcss.org/">https://postcss.org/</a></p>
</li>
<li><p><input checked disabled type="checkbox"> 
轻量级</p>
</li>
<li><p><input checked disabled type="checkbox"> 
插件化-postcss-each postcss-for等</p>
</li>
<li><p><input checked disabled type="checkbox"> 
Vite原生支持-<a target="_blank" rel="noopener" href="https://vitejs,dev/guide/features,html#postcss">https://vitejs,dev/guide/features,html#postcss</a></p>
</li>
</ul>
<h4 id="8-CSS-Modules使用"><a href="#8-CSS-Modules使用" class="headerlink" title="8.CSS Modules使用"></a>8.CSS Modules使用</h4><p>文档地址：<a target="_blank" rel="noopener" href="https://github.com/css-modules/css-modules">https://github.com/css-modules/css-modules</a><br>Vite是直接支持的：<a target="_blank" rel="noopener" href="https://cn.vitejs.dev/guide/features.html#css-modules">https://cn.vitejs.dev/guide/features.html#css-modules</a></p>
<ul>
<li>可重用</li>
<li>作用域隔离</li>
</ul>
<p>缺点:</p>
<ul>
<li>看起来不像是CSS的正常写法</li>
<li>定义CSS全局样式比较麻烦</li>
<li>需要额外的loader来生成Typescript的支持</li>
<li>生成的类名并不友好</li>
</ul>
<h4 id="9-色彩系统"><a href="#9-色彩系统" class="headerlink" title="9.色彩系统"></a>9.色彩系统</h4><p>参考：<a target="_blank" rel="noopener" href="https://ant.design/docs/spec/colors-cn">https://ant.design/docs/spec/colors-cn</a><br><strong>系统色版</strong></p>
<ul>
<li>基础色板</li>
<li>中性色板</li>
</ul>
<p><strong>产品色板</strong></p>
<ul>
<li>品牌色</li>
<li>功能色</li>
</ul>
<h3 id="3-Button总结"><a href="#3-Button总结" class="headerlink" title="(3)Button总结"></a>(3)Button总结</h3><p><strong>需求分析:</strong></p>
<ul>
<li>确定props</li>
<li>确定组件展示方式</li>
<li>确定事件</li>
</ul>
<p><strong>初始化项目以及项目结构：</strong></p>
<ul>
<li>create-vue</li>
<li>项目结构</li>
</ul>
<p><strong>组件编码</strong></p>
<ul>
<li><p>props的定义方式</p>
</li>
<li><p>对象形式<br>Typescript类型方式，有一些限制</p>
</li>
</ul>
<p><strong>原生属性</strong></p>
<p><strong>defineExpose定义实例导出</strong></p>
<p><strong>是否能支持原生的事件？比如Click–<a target="_blank" rel="noopener" href="https://cn.vuejs.org/guide/components/attrs.html#nested-component-inheritance">https://cn.vuejs.org/guide/components/attrs.html#nested-component-inheritance</a></strong></p>
<p><strong>样式解决方案</strong></p>
<ul>
<li>选择PostCSS作为预处理器</li>
<li>了解色彩系统</li>
<li>使用CSS变量添加颜色系统</li>
<li>添加Button样式</li>
</ul>
<p>​			   善用变量覆盖</p>
<p>​       		使用PostCSS插件</p>
<ul>
<li>扩展：使用了PostCSS动态生成主题颜色</li>
</ul>
<h2 id="4-Collapse组件"><a href="#4-Collapse组件" class="headerlink" title="4.Collapse组件"></a>4.Collapse组件</h2><h3 id="1-需求分析-1"><a href="#1-需求分析-1" class="headerlink" title="(1)需求分析"></a>(1)需求分析</h3><p><strong>为什么选择这个组件</strong></p>
<ul>
<li><p>静态展示</p>
</li>
<li><p>简单的交互</p>
</li>
<li><p>多种解决方案</p>
</li>
<li><p><input checked disabled type="checkbox"> 
Provide&#x2F;Inject</p>
</li>
<li><p><input checked disabled type="checkbox"> 
v-model实现</p>
</li>
<li><p><input checked disabled type="checkbox"> 
slots</p>
</li>
<li><p><input checked disabled type="checkbox"> 
Transition</p>
</li>
</ul>
<h3 id="2-代码编写-1"><a href="#2-代码编写-1" class="headerlink" title="(2)代码编写"></a>(2)代码编写</h3><h4 id="1-确定属性"><a href="#1-确定属性" class="headerlink" title="1.确定属性"></a>1.确定属性</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//方案二</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">ItemProps</span></span><br><span class="line">name:<span class="built_in">string</span> <span class="built_in">number</span>,</span><br><span class="line">title:<span class="built_in">string</span>,</span><br><span class="line">disabled:<span class="built_in">boolean</span></span><br><span class="line">&#125;</span><br><span class="line">//支持v-model</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">CollapseProps</span>&#123;</span><br><span class="line"><span class="comment">//当前打开的items,可以多个，比如</span></span><br><span class="line"><span class="title function_">ref</span>([<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;c&#x27;</span>])</span><br><span class="line"><span class="comment">//那么就是a,c item打开</span></span><br><span class="line"><span class="attr">modelvalue</span>:<span class="built_in">string</span>[]</span><br><span class="line"><span class="comment">//是否支持手风琴模式，开启一个，另外一个自动关闭</span></span><br><span class="line"><span class="attr">accordion</span>:<span class="built_in">boolean</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2-确定事件"><a href="#2-确定事件" class="headerlink" title="2.确定事件"></a>2.确定事件</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Emits</span>&#123;</span><br><span class="line">(<span class="attr">e</span>:<span class="string">&#x27;change&#x27;</span>,<span class="attr">values</span>:<span class="built_in">string</span>[])</span><br><span class="line">(<span class="attr">e</span>:<span class="string">&#x27;update:modelvalue&#x27;</span>,<span class="attr">values</span>:<span class="built_in">string</span>[]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3-思路分析"><a href="#3-思路分析" class="headerlink" title="3.思路分析"></a>3.思路分析</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//维护一个可变化响应式数组，代表打开的items(使用item的name)</span></span><br><span class="line"><span class="title function_">ref</span>([<span class="string">&#x27;a&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">//点击特定的item的时候，观察它是否存在于	数组，进行添加或者删除</span></span><br><span class="line">[<span class="string">&#x27;a&#x27;</span>]</span><br><span class="line">添加=&gt;[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>]</span><br><span class="line">删除=&gt;[<span class="string">&#x27;b&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">//在Item组件内部，判断当前name是否存在与数组中，来判断是否打开或者关闭</span></span><br><span class="line"><span class="comment">//Item a中</span></span><br><span class="line">[<span class="string">&#x27;b&#x27;</span>].<span class="title function_">includes</span>(props.<span class="property">title</span>)</span><br><span class="line"><span class="comment">//不存在  关闭</span></span><br><span class="line"><span class="comment">//Item b中</span></span><br></pre></td></tr></table></figure>

<p>难点，怎样将对应的父组件Collapsel属性传递给Item,这里是slot实现的，看起来不是很好传递。</p>
<p><strong>答案</strong>：使用<code>provide</code>和<code>inject</code>传递信息</p>
<p>要为具名插槽传入内容，我们需要使用一个含v-slot指令的template元素，并将目标插槽的名字传给该指令：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">BaseLavout</span>&gt;</span></span><br><span class="line">&lt; template v-slot.header&gt;</span><br><span class="line"><span class="comment">&lt;!--header插槽的内容放这里--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">BaseLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>v-slot有对应的简写#，因此</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">template v-slot:header</span><br></pre></td></tr></table></figure>

<p>可以简写为</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">template #header</span><br></pre></td></tr></table></figure>

<p>其意思就是“将这部分模板片段传入子组件的header插槽中”。</p>
<h4 id="4-BEM样式语法"><a href="#4-BEM样式语法" class="headerlink" title="4.BEM样式语法"></a>4.BEM样式语法</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">//Block component</span><br><span class="line"><span class="selector-class">.btn</span> &#123;&#125;</span><br><span class="line">//Element that depends upon the block *</span><br><span class="line"><span class="selector-class">.btn__price</span> &#123;&#125;</span><br><span class="line">//Modifier that changes the style of the block *</span><br><span class="line"><span class="selector-class">.btn--orange</span>&#123;&#125;</span><br><span class="line"><span class="selector-class">.btn--big</span> &#123;&#125;</span><br></pre></td></tr></table></figure>

<h4 id="5-InjectionKey"><a href="#5-InjectionKey" class="headerlink" title="5.InjectionKey"></a>5.InjectionKey</h4><p>在 Vue3 中使用 TS 时，父组件通过 provide 函数注入的数据类型往往是未知的，而子组件调用 inject 引入数据时也无法确定具体的数据类型是什么，这就产生了可维护性问题，比如某位同事写了下面这段代码时</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; inject &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span></span><br><span class="line"><span class="title function_">inject</span>(<span class="string">&#x27;Colors&#x27;</span>);</span><br></pre></td></tr></table></figure>


<p>对于 <code>colors</code> 导数的数据类型我们并不知道是什么，它可以是对象 or 数组亦或是字符串，只能顺瓜摸藤找到它的 <code>provide</code>，对于小项目找一下可能不花费什么时间，但对于大型项目来说很明显是不可取的，于是官方提供了 <code>InjectionKey</code> 函数来对传参进行类型约束，确保父子间传递的数据类型是可见、透明的。</p>
<p><code>InjectionKey</code> 函数的使用也很简单，原理是将 <code>provide</code> 与 <code>inject</code> 的第一个参数即 <code>key</code> 通过声明 <code>symbol</code> 的方式关联起来即可</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. 将 InjectionKey 定义的数据类型放到 keys/index.ts 下维护</span></span><br><span class="line"><span class="comment">// keys/index.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">InjectionKey</span>, <span class="title class_">Ref</span> &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span></span><br><span class="line"><span class="comment">// 限制了 provide 导出的数据必须是 ref 且 boolean 类型</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="attr">showPopupKey</span>: <span class="title class_">InjectionKey</span>&lt;<span class="title class_">Ref</span>&lt;<span class="built_in">boolean</span>&gt;&gt; = <span class="title class_">Symbol</span>()</span><br><span class="line"><span class="comment">// 限制了 provide 导出的数据必须是 string</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="attr">titleKey</span>: <span class="title class_">InjectionKey</span>&lt;<span class="built_in">string</span>&gt; = <span class="title class_">Symbol</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. 在 A .vue 文件中调用 provide 导出数据，第一个参数则是我们上面定义好的数据类型，第二个参数是对应数据类型的值</span></span><br><span class="line"><span class="keyword">import</span> &#123; provide, <span class="title class_">InjectionKey</span>, <span class="title class_">Ref</span> &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span></span><br><span class="line"><span class="keyword">import</span> &#123; showPopupKey &#125; <span class="string">&#x27;@/keys&#x27;</span></span><br><span class="line"><span class="keyword">const</span> showPopup = <span class="title function_">ref</span>(<span class="literal">false</span>)</span><br><span class="line"><span class="comment">// 正确</span></span><br><span class="line"><span class="title function_">provide</span>(showPopupKey, showPopup) </span><br><span class="line"><span class="comment">// TS 报错： &#x27;Hello&#x27; 是字符串，与 showPopupKey 不匹配</span></span><br><span class="line"><span class="title function_">provide</span>(showPopupKey, <span class="string">&#x27;Hello&#x27;</span>)</span><br><span class="line"><span class="comment">// 正确</span></span><br><span class="line"><span class="title function_">provide</span>(titleKey, <span class="string">&#x27;Hello&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. 在 B.vue 文件中导入数据</span></span><br><span class="line"><span class="keyword">import</span> &#123; showPopupKey &#125; <span class="keyword">from</span> <span class="string">&#x27;@/keys&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; inject &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="title function_">inject</span>(showPopupKey) <span class="comment">// 现在获取到的数据类型是安全的</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>有了 <code>InjectionKey</code> 函数后就不用再担心 provide&amp;<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=inject&spm=1001.2101.3001.7020">inject</a> 之间的数据类型问题了，我们只需找到 InjectionKey 关联的 key即可</p>
<h4 id="6-Transition"><a href="#6-Transition" class="headerlink" title="6.Transition"></a>6.Transition</h4><p><img src="/../images/Vue3_%E5%B0%81%E8%A3%85%E7%BB%84%E4%BB%B6%E5%BA%93%E9%A1%B9%E7%9B%AE/28.png"></p>
<p><img src="/../images/Vue3_%E5%B0%81%E8%A3%85%E7%BB%84%E4%BB%B6%E5%BA%93%E9%A1%B9%E7%9B%AE/29.png"></p>
<p><img src="/../images/Vue3_%E5%B0%81%E8%A3%85%E7%BB%84%E4%BB%B6%E5%BA%93%E9%A1%B9%E7%9B%AE/30.png"></p>
<p><img src="/../images/Vue3_%E5%B0%81%E8%A3%85%E7%BB%84%E4%BB%B6%E5%BA%93%E9%A1%B9%E7%9B%AE/31.png"></p>
<p>7.Transition JavaScript钩子</p>
<p><img src="/../images/Vue3_%E5%B0%81%E8%A3%85%E7%BB%84%E4%BB%B6%E5%BA%93%E9%A1%B9%E7%9B%AE/32.png"></p>
<p><img src="/../images/Vue3_%E5%B0%81%E8%A3%85%E7%BB%84%E4%BB%B6%E5%BA%93%E9%A1%B9%E7%9B%AE/33.png"></p>
<p><img src="/../images/Vue3_%E5%B0%81%E8%A3%85%E7%BB%84%E4%BB%B6%E5%BA%93%E9%A1%B9%E7%9B%AE/34.png"></p>
<h4 id="7-Record"><a href="#7-Record" class="headerlink" title="7.Record"></a>7.Record</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Record&lt;K,T&gt;</span><br></pre></td></tr></table></figure>

<p>构造一个对象类型，<code>Keys</code> 表示对象的属性键 、<code>Type</code> 表示对象的属性值，用于将一种类型属性映射到另一种类型</p>
<p>理解为：将 K 的每一个值都定义为 T 类型</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Record</span>&lt;K <span class="keyword">extends</span> keyof <span class="built_in">any</span>, T&gt; = &#123;</span><br><span class="line">    [P <span class="keyword">in</span> K]: T;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>即将K中的每个属性([P in K]),都转为T类型</p>
<p><strong>结合项目的代码</strong></p>
<p>使用 <code>Record&lt;string, (el: HTMLElement) =&gt; void&gt;</code> 主要是为了明确指定了对象的结构，即对象的键是字符串类型，而值是一个函数，这个函数接受一个参数 <code>el</code>，类型为 <code>HTMLElement</code>，并且不返回任何值。这样的明确定义可以提高代码的可读性和可维护性。</p>
<p>使用 <code>Record</code> 这样的类型定义有以下几个优点：</p>
<ol>
<li><strong>类型约束</strong>: <code>Record</code> 提供了对对象结构的明确约束，确保了对象的键和值符合预期的类型。</li>
<li><strong>静态类型检查</strong>: 使用 <code>Record</code> 可以让 TypeScript 在编译时进行静态类型检查，确保代码的类型安全性。</li>
<li><strong>自文档化</strong>: 通过明确指定对象结构，使得代码更易于理解和维护，同时也可以作为文档来阐明代码的预期行为。</li>
<li><strong>代码提示</strong>: 使用 <code>Record</code> 可以使得编辑器对对象的键和值进行更好的代码提示，帮助开发人员编写正确的代码。</li>
</ol>
<h3 id="3-Collapse总结"><a href="#3-Collapse总结" class="headerlink" title="(3)Collapse总结"></a>(3)Collapse总结</h3><p>当遇到类似列表结构组件，两种常用的实现组件的组织结构</p>
<p><strong>方案一:传入数组</strong></p>
<p>特点:1.实现起来相对简单 2.展示复杂类型节点比较麻烦 3.语义化稍差</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;Collapse items=&quot;items&quot;&gt;</span><br><span class="line">&lt;/Collapse&gt;</span><br><span class="line">const items =[</span><br><span class="line">	&#123;</span><br><span class="line">name:&#x27;a&#x27;,</span><br><span class="line">title:&#x27;title a&#x27;,</span><br><span class="line">content:&#x27;&#x27;</span><br><span class="line">	&#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p><strong>方案二:语义化展示</strong></p>
<p>特点: 1.语义化更好 2.复杂节点使用slot展示简单 3.实现起来更复杂</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;Collapse&gt; //父组件</span><br><span class="line">	&lt;CollapseItem name=&quot;a&quot;title=&quot;title a&quot;&gt; //子组件</span><br><span class="line">		&lt;div&gt;</span><br><span class="line">		&lt;h1&gt;复杂样式&lt;/h1&gt;</span><br><span class="line">		&lt;p&gt;He11o~&lt;/p&gt;</span><br><span class="line">		&lt;/div&gt;</span><br><span class="line">	&lt;/CollapseItem&gt;</span><br><span class="line">&lt;/Collapse&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>语义化展示，父子属性传递的常规方式:</p>
<ul>
<li><p>数据状态以及处理放在父组件</p>
</li>
<li><p>使用Provide&#x2F;Inject 传递给子组件</p>
</li>
</ul>
</li>
<li><p>v-model的实现</p>
<ul>
<li>是属性modelValue</li>
<li>事件update:modelValue的语法糖</li>
<li>特别注意属性赋值给内部响应式对象的更新问题(使用watch)</li>
</ul>
</li>
<li><p>使用内置的Transition实现动画效果</p>
<ul>
<li><p>并不提供任何动画</p>
</li>
<li><p>提供一系列的classes标示整个动画过程</p>
</li>
<li><p>提供javascript钩子函数支持高级的自定功能</p>
</li>
</ul>
</li>
</ul>
<h2 id="5-Icon组件"><a href="#5-Icon组件" class="headerlink" title="5.Icon组件"></a>5.Icon组件</h2><h3 id="1-需求分析-2"><a href="#1-需求分析-2" class="headerlink" title="(1)需求分析"></a>(1)需求分析</h3><h3 id="2-代码编写-2"><a href="#2-代码编写-2" class="headerlink" title="(2)代码编写"></a>(2)代码编写</h3><h4 id="1-Inline-SVG-vs-Font-Icon"><a href="#1-Inline-SVG-vs-Font-Icon" class="headerlink" title="1.Inline SVG vs Font Icon"></a>1.Inline SVG vs Font Icon</h4><ul>
<li>svg完全可以控制，font icon只能控制字符相关的属性</li>
<li>font icon需要下载的字体文件较大，除非自己切割打包。</li>
<li>font icon会遇到一些比较奇怪的问题</li>
<li>矢量图标有很大的优势：可调整大小而不失品质，在视网膜屏幕上也可以清晰显示，文件尺寸也非常小。<ul>
<li>icon font：<br>浏览器认为这是文本，所以会对其使用抗锯齿。这可能导致图标不如你想象的那么锐利。</li>
<li>inline SVG：<br>真正的矢量</li>
</ul>
</li>
</ul>
<h4 id="2-现成的图标库"><a href="#2-现成的图标库" class="headerlink" title="2.现成的图标库"></a>2.现成的图标库</h4><ul>
<li><p>Bootstrap Icons</p>
</li>
<li><p>Fontawesome</p>
</li>
<li><p>Ionicon</p>
</li>
</ul>
<h4 id="3-安装svg"><a href="#3-安装svg" class="headerlink" title="3.安装svg"></a>3.安装svg</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//安装svg core</span><br><span class="line">npm i --save @fortawesome/fontawesome-svg-core</span><br><span class="line">//安装图标库</span><br><span class="line">npm i --save @fortawesome/free-solid-svg-icons</span><br><span class="line">//安装基于vue3的包装</span><br><span class="line">npm i --save @fortawesome/vue-fontawesome@latest-3</span><br></pre></td></tr></table></figure>

<h4 id="4-导入组件库"><a href="#4-导入组件库" class="headerlink" title="4.导入组件库"></a>4.导入组件库</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//导入组件svg core</span></span><br><span class="line"><span class="keyword">import</span> &#123; library &#125; <span class="keyword">from</span> <span class="string">&#x27;@fortawesome/fontawesome-svg-core&#x27;</span></span><br><span class="line"><span class="comment">//导入组件库</span></span><br><span class="line"><span class="keyword">import</span> &#123; fas &#125; <span class="keyword">from</span> <span class="string">&#x27;@fortawesome/free-solid-svg-icons&#x27;</span></span><br></pre></td></tr></table></figure>

<h4 id="5-禁用透传"><a href="#5-禁用透传" class="headerlink" title="5.禁用透传"></a>5.禁用透传</h4><p><img src="/../images/Vue3_%E5%B0%81%E8%A3%85%E7%BB%84%E4%BB%B6%E5%BA%93%E9%A1%B9%E7%9B%AE/37.png"></p>
<p><img src="/../images/Vue3_%E5%B0%81%E8%A3%85%E7%BB%84%E4%BB%B6%E5%BA%93%E9%A1%B9%E7%9B%AE/38.png"></p>
<p><img src="/../images/Vue3_%E5%B0%81%E8%A3%85%E7%BB%84%E4%BB%B6%E5%BA%93%E9%A1%B9%E7%9B%AE/39.png"></p>
<p><img src="/../images/Vue3_%E5%B0%81%E8%A3%85%E7%BB%84%E4%BB%B6%E5%BA%93%E9%A1%B9%E7%9B%AE/40.png"></p>
<p><img src="/../images/Vue3_%E5%B0%81%E8%A3%85%E7%BB%84%E4%BB%B6%E5%BA%93%E9%A1%B9%E7%9B%AE/41.png"></p>
<h4 id="6-导入lodash-es的omit用作过滤器"><a href="#6-导入lodash-es的omit用作过滤器" class="headerlink" title="6.导入lodash-es的omit用作过滤器"></a>6.导入lodash-es的omit用作过滤器</h4><p>做到精益求精，要过滤传值时自己添加的属性</p>
<p>安装lodash-es要安装es稳定版本和声明文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm install lodash-es --save</span><br><span class="line"></span><br><span class="line">npm install @types/lodash-es --save-dev</span><br></pre></td></tr></table></figure>

<p>omit<br>_.omit(object, <em>keys)<br>函数返回一个没有列入排除key属性的对象。其中，参数object为JSON格式的对象，</em>keys表示多个需要排除掉的key属性。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> _ = <span class="built_in">require</span>(<span class="string">&#x27;lodash/object&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> originObject = &#123;</span><br><span class="line">  <span class="attr">A</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="attr">B</span>: <span class="number">2</span>,</span><br><span class="line">  <span class="attr">C</span>: <span class="number">3</span>,</span><br><span class="line">  <span class="attr">D</span>: <span class="number">4</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> newObject = _.<span class="title function_">omit</span>(originObject, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(originObject);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(newObject);</span><br><span class="line"></span><br><span class="line">&#123; <span class="attr">A</span>: <span class="number">1</span>, <span class="attr">B</span>: <span class="number">2</span>, <span class="attr">C</span>: <span class="number">3</span>, <span class="attr">D</span>: <span class="number">4</span> &#125;</span><br><span class="line">&#123; <span class="attr">A</span>: <span class="number">1</span>, <span class="attr">D</span>: <span class="number">4</span> &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="3-Icon总结"><a href="#3-Icon总结" class="headerlink" title="(3)Icon总结"></a>(3)Icon总结</h3><p><strong>一些图标库解决方案</strong></p>
<ul>
<li>Bootstrap Icon</li>
<li>Fontawesome</li>
<li>Ionicon</li>
</ul>
<p><strong>二次开发组件</strong></p>
<p>第一步:支持组件的原始属性</p>
<ul>
<li>inheritAttrs:false 不继承属性</li>
<li>使用$props访问所有属性</li>
<li>要注意不继承以后一些默认属性失效的问题$attrs</li>
</ul>
<p>第二步扩充组件属性</p>
<ul>
<li><p>我们添加的type&#x2F;color属性</p>
</li>
<li><p>过滤传递的属性 lodash omit</p>
</li>
</ul>
<h2 id="6-Alert组件"><a href="#6-Alert组件" class="headerlink" title="6.Alert组件"></a>6.Alert组件</h2><h3 id="1-需求分析-3"><a href="#1-需求分析-3" class="headerlink" title="(1)需求分析"></a>(1)需求分析</h3><ul>
<li><p>展示一个对应的条目，有几种不同的type,和我们应用的类型是一一对应</p>
</li>
<li><p>有两种主题，一种深色，一种浅色</p>
</li>
<li><p>点击右侧按钮可以关闭对应的条目</p>
</li>
<li><p>可以定义按钮是否显示</p>
</li>
<li><p>可以自定义里面的文本为复杂的结构</p>
</li>
</ul>
<h2 id="7-组件测试"><a href="#7-组件测试" class="headerlink" title="7.组件测试"></a>7.组件测试</h2><h3 id="为什么要有测试"><a href="#为什么要有测试" class="headerlink" title="为什么要有测试"></a>为什么要有测试</h3><h4 id="出现的问题"><a href="#出现的问题" class="headerlink" title="出现的问题"></a>出现的问题</h4><ul>
<li>新建一堆不同属性的组件，肉眼观测不靠谱</li>
<li>更新代码，要再次进行手动测试</li>
</ul>
<h4 id="测试在国内被严重忽视"><a href="#测试在国内被严重忽视" class="headerlink" title="测试在国内被严重忽视"></a>测试在国内被严重忽视</h4><ul>
<li><p>没有时间</p>
</li>
<li><p>需求一直修改</p>
</li>
<li><p>不知道怎么测试</p>
</li>
</ul>
<h4 id="测试的优点"><a href="#测试的优点" class="headerlink" title="测试的优点"></a>测试的优点</h4><ul>
<li>自动化完成流程，保证代码的运行结果</li>
<li>更早发现Bug</li>
<li>重构和升级更加容易和可靠</li>
</ul>
<h3 id="组件化的框架-Vue，React-非常适合写单元测试"><a href="#组件化的框架-Vue，React-非常适合写单元测试" class="headerlink" title="组件化的框架(Vue，React)非常适合写单元测试"></a>组件化的框架(Vue，React)非常适合写单元测试</h3><ul>
<li>组件化，独立单元，互不影响</li>
<li>属性和界面的映射，固定输入，固定输出</li>
<li>单向数据流</li>
<li>状态管理工具的store可以单独写测试</li>
</ul>
<h3 id="测试框架Vitest简介"><a href="#测试框架Vitest简介" class="headerlink" title="测试框架Vitest简介"></a>测试框架Vitest简介</h3><h4 id="需要选取两种测试工具"><a href="#需要选取两种测试工具" class="headerlink" title="需要选取两种测试工具"></a>需要选取两种测试工具</h4><ul>
<li>通用的测试框架</li>
<li>针对对应库(React或者Vue)的测试库</li>
</ul>
<h4 id="通用测试框架"><a href="#通用测试框架" class="headerlink" title="通用测试框架"></a>通用测试框架</h4><ul>
<li>Mocha</li>
<li>Jest</li>
<li>Vitest （采用）</li>
</ul>
<h4 id="Vitest的优点"><a href="#Vitest的优点" class="headerlink" title="Vitest的优点"></a>Vitest的优点</h4><ul>
<li>基于Vite而生，和Vite完美配合，共享一个生态系统</li>
<li>兼容Jest语法</li>
<li>HMR for tests</li>
<li>ESM，TS，JSX 原生支持</li>
</ul>
<h4 id="测试框架的几大功能"><a href="#测试框架的几大功能" class="headerlink" title="测试框架的几大功能"></a>测试框架的几大功能</h4><ul>
<li><p>断言</p>
<ul>
<li>内置Chai以及兼容Jest expect的 API</li>
</ul>
</li>
<li><p>Mock</p>
</li>
<li><p>代码覆盖率</p>
</li>
<li><p>Snapshot –兼容Jest</p>
</li>
</ul>
<h4 id="安装Vitest"><a href="#安装Vitest" class="headerlink" title="安装Vitest"></a>安装Vitest</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -D vitest</span><br></pre></td></tr></table></figure>

<h4 id="测试方法"><a href="#测试方法" class="headerlink" title="测试方法"></a>测试方法</h4><p>控制台输入</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx vitest 文件名</span><br></pre></td></tr></table></figure>

<p>文件名不需要完全一样，会模糊查询并作用全部文件</p>
<p><img src="/../images/Vue3_%E5%B0%81%E8%A3%85%E7%BB%84%E4%BB%B6%E5%BA%93%E9%A1%B9%E7%9B%AE/42.png"></p>
<h4 id="Vitest的vi用法"><a href="#Vitest的vi用法" class="headerlink" title="Vitest的vi用法"></a>Vitest的vi用法</h4><p><code>vi</code> 是 <code>vitest</code> 测试框架提供的一个辅助工具，用于创建测试桩（mocks）和模拟对象（spies）。它可以让你在测试中模拟函数的行为，以便更容易地进行单元测试。</p>
<p>下面是 <code>vi</code> 的一些常见用法：</p>
<ol>
<li><code>vi.fn()</code>: 创建一个模拟函数，可以用于跟踪函数的调用情况，判断是否被调用以及被调用的参数等。</li>
</ol>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> myFunction = vi.<span class="title function_">fn</span>();</span><br><span class="line"><span class="title function_">myFunction</span>(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line"><span class="title function_">expect</span>(myFunction).<span class="title function_">toHaveBeenCalled</span>(); <span class="comment">// 断言函数被调用过</span></span><br><span class="line"><span class="title function_">expect</span>(myFunction).<span class="title function_">toHaveBeenCalledWith</span>(<span class="number">1</span>, <span class="number">2</span>); <span class="comment">// 断言函数被以特定参数调用过</span></span><br></pre></td></tr></table></figure>

<ol>
<li><code>vi.spyOn(obj, methodName)</code>: 对对象的指定方法进行监视，可以跟踪该方法的调用情况。</li>
</ol>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">  <span class="attr">method</span>: <span class="function">() =&gt;</span> &#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> spy = vi.<span class="title function_">spyOn</span>(obj, <span class="string">&#x27;method&#x27;</span>);</span><br><span class="line">obj.<span class="title function_">method</span>();</span><br><span class="line"><span class="title function_">expect</span>(spy).<span class="title function_">toHaveBeenCalled</span>(); <span class="comment">// 断言方法被调用过</span></span><br></pre></td></tr></table></figure>

<ol>
<li><code>vi.mock(&#39;moduleName&#39;)</code>: 对指定的模块进行模拟，可以控制模块的行为，例如模拟模块的函数返回值等。</li>
</ol>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vi.<span class="title function_">mock</span>(<span class="string">&#x27;axios&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> mockedAxios = axios <span class="keyword">as</span> <span class="title class_">Mocked</span>&lt;<span class="keyword">typeof</span> axios&gt;;</span><br><span class="line">mockedAxios.<span class="property">get</span>.<span class="title function_">mockResolvedValue</span>(&#123; <span class="attr">data</span>: <span class="string">&#x27;mocked data&#x27;</span> &#125;);</span><br></pre></td></tr></table></figure>

<h4 id="Vitest的describe用法"><a href="#Vitest的describe用法" class="headerlink" title="Vitest的describe用法"></a>Vitest的describe用法</h4><p><code>describe</code> 是 <code>vitest</code> 测试框架提供的一个函数，用于描述一个测试套件，通常用来组织一系列相关的测试用例。在描述中，可以包含多个测试用例，并且可以进行嵌套描述以更好地组织测试。</p>
<p>下面是 <code>describe</code> 函数的基本用法：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">describe</span>(description, callback);</span><br></pre></td></tr></table></figure>

<ul>
<li><code>description</code>: 描述测试套件的字符串，通常是一个简短的描述性文字，用来说明该测试套件包含的是哪些测试用例。</li>
<li><code>callback</code>: 一个回调函数，包含了测试用例的定义和实现。在该回调函数内部，可以使用 <code>test</code> 函数定义多个测试用例。</li>
</ul>
<p>例如：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">describe</span>(<span class="string">&#x27;Math operations&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">test</span>(<span class="string">&#x27;Addition&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">expect</span>(<span class="number">1</span> + <span class="number">2</span>).<span class="title function_">toBe</span>(<span class="number">3</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">test</span>(<span class="string">&#x27;Subtraction&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">expect</span>(<span class="number">5</span> - <span class="number">3</span>).<span class="title function_">toBe</span>(<span class="number">2</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>在上面的例子中，我们描述了一个名为 “Math operations” 的测试套件，其中包含了两个测试用例： “Addition” 和 “Subtraction”。每个测试用例都通过 <code>test</code> 函数来定义，并包含了相应的测试逻辑。</p>
<h4 id="Vitest的expect用法"><a href="#Vitest的expect用法" class="headerlink" title="Vitest的expect用法"></a>Vitest的expect用法</h4><p><code>expect</code> 是 <code>vitest</code> 测试框架提供的一个函数，用于对测试结果进行断言，判断实际结果是否符合预期。它通常与各种匹配器（matchers）一起使用，用于对值、对象、函数等进行断言。</p>
<p>下面是 <code>expect</code> 函数的基本用法：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">expect</span>(value);</span><br></pre></td></tr></table></figure>

<p><code>value</code>: 要进行断言的值或表达式。</p>
<p><code>expect</code> 函数返回一个包含一系列断言方法的对象，可以通过链式调用来对值进行不同类型的断言。常见的断言方法包括：</p>
<ul>
<li><code>.toBe(expected)</code>: 断言值等于 <code>expected</code>。</li>
<li><code>.toEqual(expected)</code>: 断言值深度等于 <code>expected</code>，即值的内容与结构都相同。</li>
<li><code>.toBeDefined()</code>: 断言值已定义且不为 <code>undefined</code>。</li>
<li><code>.toBeUndefined()</code>: 断言值为 <code>undefined</code>。</li>
<li><code>.toBeNull()</code>: 断言值为 <code>null</code>。</li>
<li><code>.toBeTruthy()</code>: 断言值为真值，即可以转换为 <code>true</code> 的值。</li>
<li><code>.toBeFalsy()</code>: 断言值为假值，即可以转换为 <code>false</code> 的值。</li>
<li><code>.toHaveBeenCalled()</code>: 断言函数已被调用过。</li>
<li><code>.toHaveBeenCalledWith(arg1, arg2, ...args)</code>: 断言函数被以指定参数调用过。</li>
</ul>
<p>例如：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> result = <span class="title function_">add</span>(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line"><span class="title function_">expect</span>(result).<span class="title function_">toBe</span>(<span class="number">3</span>);</span><br></pre></td></tr></table></figure>

<p>在这个例子中，<code>expect</code> 函数用于断言函数 <code>add</code> 的返回值是否等于 <code>3</code>。</p>
<h3 id="单元测试实用工具库-Vue-test-utils"><a href="#单元测试实用工具库-Vue-test-utils" class="headerlink" title="单元测试实用工具库 Vue-test-utils"></a>单元测试实用工具库 Vue-test-utils</h3><p><a target="_blank" rel="noopener" href="https://v1.test-utils.vuejs.org/zh/">介绍 | Vue Test Utils (vuejs.org)</a></p>
<p>安装</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">❯ npm install --save-dev @vue/test-utils</span><br></pre></td></tr></table></figure>



<h3 id="Vnode以及Render-Function"><a href="#Vnode以及Render-Function" class="headerlink" title="Vnode以及Render Function"></a>Vnode以及Render Function</h3><p><strong>Virtual DOM</strong>: 一种虚拟的，保存在内存中的数据结构，用来代表UI的表现，和真实DOM节点保持同步。Virtual DOM 是由一系列的Vnode组成的。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//模拟一个简单的 Vnode</span></span><br><span class="line"><span class="keyword">const</span> vnode = &#123;</span><br><span class="line">	<span class="attr">type</span>:<span class="string">&#x27;div&#x27;</span>,</span><br><span class="line">	<span class="attr">props</span>:&#123;</span><br><span class="line">		<span class="attr">id</span>:<span class="string">&#x27;hello&#x27;</span></span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="attr">children</span>: [</span><br><span class="line">	]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="虚拟DOM的优点"><a href="#虚拟DOM的优点" class="headerlink" title="虚拟DOM的优点"></a>虚拟DOM的优点</h4><ul>
<li>可以使用一种更方便的方式，供开发者操控UI的状态和结构，不必和真实的DOM节点打交道</li>
<li>更新效率更高，计算需要的最小化操作，并完成更新</li>
</ul>
<h4 id="创建Vnode"><a href="#创建Vnode" class="headerlink" title="创建Vnode"></a>创建Vnode</h4><p><strong>h和createVnode</strong>都可以创建vnode,h是hyperscript的缩写，意思就是”JavaScript that produces<br>HTML(hypertext markup language)”,很多virtualDOM的实现都使用这个函数名称。还有一个函数称之<br>为createVnode,更形象，两个函数的用法几乎是一样的。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; h,createVnode&#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">const</span> vnode =<span class="title function_">h</span>(</span><br><span class="line"><span class="string">&#x27;div&#x27;</span>,<span class="comment">//type</span></span><br><span class="line">&#123;<span class="attr">id</span>:<span class="string">&#x27;foo&#x27;</span>,<span class="attr">class</span>:<span class="string">&#x27;bar&#x27;</span>&#125;,<span class="comment">//props</span></span><br><span class="line">[</span><br><span class="line"><span class="comment">/*children */</span></span><br><span class="line">]</span><br><span class="line">)</span><br></pre></td></tr></table></figure>



<h4 id="测试事件"><a href="#测试事件" class="headerlink" title="测试事件"></a>测试事件</h4><p>触发事件</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">await</span> firstHeader.<span class="title function_">trigger</span>(<span class="string">&#x27;click&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>观测事件是否触发</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//方案一jsx渲染组件：</span></span><br><span class="line"><span class="keyword">const</span> onchange = vi.<span class="title function_">fn</span>()</span><br><span class="line"><span class="title function_">expect</span>(onChange).<span class="title function_">toHaveBeenCalledwith</span>([])</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//方案二普通方式mount组件：</span></span><br><span class="line"><span class="keyword">const</span> changeEvent = wrapper.<span class="title function_">emitted</span>(<span class="string">&#x27;change&#x27;</span>)</span><br><span class="line"><span class="title function_">expect</span>(changeEvent[<span class="number">1</span>]).<span class="title function_">toEqual</span>([[<span class="string">&#x27;b&#x27;</span>]]</span><br><span class="line"><span class="title function_">expect</span>(changeEvent[<span class="number">0</span>]).<span class="title function_">toEqual</span>([[]]</span><br></pre></td></tr></table></figure>



<h3 id="Render-Pipeline"><a href="#Render-Pipeline" class="headerlink" title="Render Pipeline"></a>Render Pipeline</h3><ul>
<li><strong>Compile</strong>,Vue组件的Template会被编译成<code>render function</code>,一个可以返回Virtual DOM树的函数。</li>
<li><strong>Mount</strong>,执行render function,遍历虚拟DOM树，生成真正的DOM节点。</li>
<li><strong>Patch</strong>,当组件中任何响应式对象（依赖）发生变化的时候，执行更新操作。生成新的虚拟节点树，Vue内部会遍历新的虚拟节点树，和旧的树做对比，然后执行必要的更新。</li>
</ul>
<p><img src="/../images/Vue3_%E5%B0%81%E8%A3%85%E7%BB%84%E4%BB%B6%E5%BA%93%E9%A1%B9%E7%9B%AE/43.png"></p>
<h3 id="组件测试总结"><a href="#组件测试总结" class="headerlink" title="组件测试总结"></a>组件测试总结</h3><h4 id="Vue测试框架-vue-test-utils"><a href="#Vue测试框架-vue-test-utils" class="headerlink" title="Vue测试框架-vue-test-utils"></a>Vue测试框架-vue-test-utils</h4><ul>
<li>挂载-mount<ul>
<li>修改vitest的配置，支持dom</li>
<li>environment:’jsdom’</li>
</ul>
</li>
<li>query<ul>
<li>find()&#x2F;get()</li>
<li>findAll()</li>
<li>findComponent()</li>
</ul>
</li>
<li>内容&#x2F;属性<ul>
<li>text()&#x2F;html()</li>
<li>classes()</li>
<li>attributes()</li>
</ul>
</li>
<li>stub模拟子组件</li>
</ul>
<h4 id="VNode以及Render"><a href="#VNode以及Render" class="headerlink" title="VNode以及Render"></a>VNode以及Render</h4><ul>
<li>VNode的概念</li>
<li>使用render function写vue组件</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">setup</span>(<span class="params">props</span>)&#123;</span><br><span class="line"><span class="keyword">const</span> count <span class="title function_">ref</span>(<span class="number">1</span>)</span><br><span class="line">/<span class="keyword">return</span> render <span class="keyword">function</span></span><br><span class="line"><span class="title function_">return</span> ()=<span class="title function_">h</span>(<span class="string">&#x27;h1&#x27;</span>,props.<span class="property">msg</span> count.<span class="property">value</span>)</span><br><span class="line"><span class="variable constant_">JSX</span>-语法糖</span><br><span class="line"><span class="keyword">return</span> ()&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>(props.msg)<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;count.value)<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<h4 id="vitest钩子函数及其他"><a href="#vitest钩子函数及其他" class="headerlink" title="vitest钩子函数及其他"></a>vitest钩子函数及其他</h4><ul>
<li>beforeEach&#x2F;beforeAll</li>
<li>test.skip&#x2F;test.only</li>
</ul>
<h4 id="可进步的"><a href="#可进步的" class="headerlink" title="可进步的"></a>可进步的</h4><p>为手风琴模式的Collapse写测试用例</p>
<ul>
<li>需要在用例中单独mount组件</li>
<li>关键是它行为的不同</li>
</ul>
<h2 id="8-Tooltip组件"><a href="#8-Tooltip组件" class="headerlink" title="8.Tooltip组件"></a>8.Tooltip组件</h2><h3 id="1-需求分析-4"><a href="#1-需求分析-4" class="headerlink" title="(1)需求分析"></a>(1)需求分析</h3><ul>
<li>通用组件</li>
<li>Tooltip</li>
<li>Dropdown</li>
<li>Select等等</li>
</ul>
<h4 id="功能分析"><a href="#功能分析" class="headerlink" title="功能分析"></a>功能分析</h4><p>根本功能，两块区域</p>
<ul>
<li>​	触发区</li>
<li>​	展示区</li>
</ul>
<p>触发方式</p>
<ul>
<li>hover</li>
<li>点击</li>
<li>手动</li>
</ul>
<p>重点就是触发区发生特定事件的时候，展示区的展示与隐藏</p>
<h4 id="展示方案"><a href="#展示方案" class="headerlink" title="展示方案"></a>展示方案</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">//content 字符串</span><br><span class="line">&lt;Tooltip content=&quot;this is the tooltip&quot;&gt;</span><br><span class="line">&lt;Button size=&quot;large&quot;&gt;Trigger me&lt;/Button&gt;</span><br><span class="line">&lt;/Tooltip&gt;</span><br><span class="line">//content 复杂slot</span><br><span class="line">&lt;Tooltip&gt;</span><br><span class="line">&lt;Button size=&quot;large&quot;&gt;Trigger me&lt;/Button&gt;</span><br><span class="line">&lt;template #content&gt;</span><br><span class="line">&lt;h1&gt;He11o!&lt;/h1&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;/Tooltip&gt;</span><br></pre></td></tr></table></figure>

<h4 id="属性"><a href="#属性" class="headerlink" title="属性"></a>属性</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">TooltipProps</span>&#123;</span><br><span class="line">content?:<span class="built_in">string</span>;</span><br><span class="line"><span class="attr">trigger</span>:<span class="string">&#x27;hover&#x27;</span>|<span class="string">&#x27;click&#x27;</span>;</span><br><span class="line">manual?:<span class="built_in">boolean</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="事件"><a href="#事件" class="headerlink" title="事件"></a>事件</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">TooltipEmits</span></span><br><span class="line">(e:&#x27;visible-change&#x27;,value:<span class="built_in">boolean</span>):<span class="built_in">void</span>;</span><br></pre></td></tr></table></figure>

<h4 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">TooltipInstance</span>&#123;</span><br><span class="line"><span class="attr">show</span>:<span class="function">()=&gt;</span><span class="built_in">void</span>;</span><br><span class="line"><span class="attr">hide</span>:<span class="function">()=&gt;</span><span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="动态事件的解决方案"><a href="#动态事件的解决方案" class="headerlink" title="动态事件的解决方案"></a>动态事件的解决方案</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//方案一，使用DOM标准来绑定事件--不推荐</span></span><br><span class="line"><span class="comment">//click</span></span><br><span class="line">domNode.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>,callback)</span><br><span class="line"><span class="comment">//hover</span></span><br><span class="line">domNode.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mouseenter&#x27;</span>,callback)</span><br><span class="line"><span class="comment">//要注意事件的清除</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//方案二，使用v-on来完成--推荐</span></span><br><span class="line"><span class="comment">//@click = v-on:click  缩写形式</span></span><br><span class="line"><span class="comment">//v-on还可以接受一个object作为参数，对object中的每一项都可以作为对应的事件回调</span></span><br><span class="line"><span class="keyword">const</span> events =<span class="string">&#x27;click&#x27;</span>:callback,<span class="string">&#x27;mouseenter&#x27;</span>:callback2</span><br><span class="line">&lt;div v-on=<span class="string">&quot;events&quot;</span>/&gt;</span><br></pre></td></tr></table></figure>



<h3 id="2-代码编写-3"><a href="#2-代码编写-3" class="headerlink" title="(2)代码编写"></a>(2)代码编写</h3><h4 id="1-Tooltip开发计划"><a href="#1-Tooltip开发计划" class="headerlink" title="1.Tooltip开发计划"></a>1.Tooltip开发计划</h4><ul>
<li><p>最基本的实现</p>
</li>
<li><p>支持click&#x2F;hover两种触发方式</p>
</li>
<li><p>支持clickoutside的时候隐藏</p>
</li>
<li><p>支持手动触发</p>
</li>
<li><p>支持popper参数</p>
</li>
<li><p>动画</p>
</li>
<li><p>支持延迟显示</p>
</li>
<li><p>样式</p>
</li>
</ul>
<h4 id="2-使用第三方库-popper-js"><a href="#2-使用第三方库-popper-js" class="headerlink" title="2.使用第三方库 popper.js"></a>2.使用第三方库 popper.js</h4><p><img src="/../images/Vue3_%E5%B0%81%E8%A3%85%E7%BB%84%E4%BB%B6%E5%BA%93%E9%A1%B9%E7%9B%AE/44.png"></p>
<h4 id="3-defineProps-和-defineEmits"><a href="#3-defineProps-和-defineEmits" class="headerlink" title="3.defineProps() 和 defineEmits()"></a>3.defineProps() 和 defineEmits()</h4><p><img src="/../images/Vue3_%E5%B0%81%E8%A3%85%E7%BB%84%E4%BB%B6%E5%BA%93%E9%A1%B9%E7%9B%AE/45.png"></p>
<h4 id="4-slot"><a href="#4-slot" class="headerlink" title="4.slot"></a>4.slot</h4><p><img src="/../images/Vue3_%E5%B0%81%E8%A3%85%E7%BB%84%E4%BB%B6%E5%BA%93%E9%A1%B9%E7%9B%AE/46.png"></p>
<p>5.watchEffect()</p>
<p><img src="/../images/Vue3_%E5%B0%81%E8%A3%85%E7%BB%84%E4%BB%B6%E5%BA%93%E9%A1%B9%E7%9B%AE/47.png"></p>
<h3 id="3-Tooltip总结"><a href="#3-Tooltip总结" class="headerlink" title="(3)Tooltip总结"></a>(3)Tooltip总结</h3><h4 id="Tooltip分析"><a href="#Tooltip分析" class="headerlink" title="Tooltip分析"></a>Tooltip分析</h4><p>基础组件</p>
<ul>
<li>触发层</li>
<li>展示层</li>
</ul>
<p>开发复杂组件的时候</p>
<ul>
<li>需求分析</li>
<li>设立开发计划</li>
</ul>
<h4 id="Tooltip开发"><a href="#Tooltip开发" class="headerlink" title="Tooltip开发"></a>Tooltip开发</h4><ul>
<li><p>使用popper,.js来完成位置的展示</p>
</li>
<li><p>动态事件的添加–使用v-on</p>
</li>
<li><p>实现外侧点击的功能</p>
</li>
<li><p>手动触发的功能</p>
<p>​       组件实例实现对应的方法</p>
</li>
<li><p>支持Popper参数</p>
<p>​       使用第三方库的时候必不可少的功能</p>
</li>
<li><p>添加延时</p>
<p>​       使用debouce来整合短时间内多次触发的回调</p>
<p>​	   debouce可以使用cancel方法来取消</p>
</li>
<li><p>添加样式</p>
<p>​	   三角箭头的实现</p>
<p>​	   正方形旋转45度，加特定的位移，再加边框</p>
</li>
</ul>
<h4 id="添加测试"><a href="#添加测试" class="headerlink" title="添加测试"></a>添加测试</h4><ul>
<li>注意定时器的影响<ul>
<li>vi.useFakeTimers()</li>
<li>vi.runAllTimers()</li>
</ul>
</li>
<li>注意点击到外侧区域的测试</li>
</ul>
<h2 id="9-Dropdown组件"><a href="#9-Dropdown组件" class="headerlink" title="9.Dropdown组件"></a>9.Dropdown组件</h2><h3 id="1-需求分析-5"><a href="#1-需求分析-5" class="headerlink" title="(1)需求分析"></a>(1)需求分析</h3><ul>
<li>根据Tooltip二次开发的组件</li>
<li>显示&#x2F;隐藏一个具体的，有多个选项的菜单</li>
<li>菜单中有各种选项，用户可以自定义<ul>
<li>​	使用语义化结构</li>
<li>​	使用javascript数据结构</li>
</ul>
</li>
</ul>
<h4 id="展示方案-1"><a href="#展示方案-1" class="headerlink" title="展示方案"></a>展示方案</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;Dropdown</span><br><span class="line"> :menu-options=&quot;options&quot;</span><br><span class="line">&gt;</span><br><span class="line">	&lt;Button size=&quot;large&quot;&gt;The Dropdown&lt;/Button&gt;</span><br><span class="line">&lt;/Dropdown&gt;</span><br></pre></td></tr></table></figure>

<h4 id="属性-1"><a href="#属性-1" class="headerlink" title="属性"></a>属性</h4><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">DropdownProps</span> <span class="keyword">extends</span> <span class="title class_">TooltipProps</span>&#123;</span><br><span class="line">	<span class="attr">menuOptions</span>:<span class="title class_">Menuoption</span>[]</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">MenuOption</span> &#123;</span><br><span class="line"><span class="comment">//VNode这个是难点</span></span><br><span class="line"><span class="comment">//选项内容</span></span><br><span class="line"><span class="attr">label</span>:<span class="built_in">string</span> | <span class="title class_">VNode</span>;</span><br><span class="line"><span class="comment">//唯一标识</span></span><br><span class="line"><span class="attr">key</span>:<span class="built_in">string</span> | <span class="built_in">number</span>;</span><br><span class="line"><span class="comment">//该选项是否禁用</span></span><br><span class="line">disabled?:<span class="built_in">boolean</span>;</span><br><span class="line"><span class="comment">//是否需要划分线</span></span><br><span class="line">divided?:<span class="built_in">boolean</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="事件-1"><a href="#事件-1" class="headerlink" title="事件"></a>事件</h4><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">DropdownEmits</span></span><br><span class="line">(e:&#x27;visible-change&#x27;,value:<span class="built_in">boolean</span>):<span class="built_in">void</span>;</span><br><span class="line">(e:&#x27;select&#x27;,value:key):<span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="实例-1"><a href="#实例-1" class="headerlink" title="实例"></a>实例</h4><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">DropdownInstance</span> &#123;</span><br><span class="line"><span class="attr">show</span>:<span class="function">()=&gt;</span><span class="built_in">void</span>;</span><br><span class="line"><span class="attr">hide</span>:<span class="function">()=&gt;</span><span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="2-代码编写-4"><a href="#2-代码编写-4" class="headerlink" title="(2)代码编写"></a>(2)代码编写</h3><h4 id="1-Render-Function"><a href="#1-Render-Function" class="headerlink" title="1.Render Function"></a>1.Render Function</h4><p>这个简单组件的主要作用是接收一个虚拟节点（vNode）作为属性，并将其渲染到页面上</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; defineComponent &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">RenderVnode</span> = <span class="title function_">defineComponent</span>(&#123;</span><br><span class="line">  <span class="attr">props</span>: &#123;</span><br><span class="line">    <span class="attr">vNode</span>: &#123;</span><br><span class="line">      <span class="attr">type</span>: [<span class="title class_">String</span>, <span class="title class_">Object</span>],</span><br><span class="line">      <span class="attr">required</span>: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">setup</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function">() =&gt;</span> props.<span class="property">vNode</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">RenderVnode</span></span><br></pre></td></tr></table></figure>



<h4 id="2-Fragment"><a href="#2-Fragment" class="headerlink" title="2.Fragment"></a>2.Fragment</h4><p>Fragment是一种特殊的组件，用于在不添加额外节点的情况下包装多个子元素。它可以让你将一组子元素进行分组，而不会在最终渲染结果中添加额外的DOM节点。</p>
<h3 id="3-Dropdown总结"><a href="#3-Dropdown总结" class="headerlink" title="(3)Dropdown总结"></a>(3)Dropdown总结</h3><p>Naive UI就是用JSX编写的</p>
<ul>
<li>使用通用组件 Tooltip 进行二次开发</li>
<li>在vue单文件组件template中渲染Vnode的方法</li>
<li><strong>使用 jsx 编写组件</strong></li>
</ul>
<p><strong>vue 文件 和 jsx 的对应关系</strong></p>
<p>文档：<a target="_blank" rel="noopener" href="https://cn.vueis.org/guide/extras/render-function">https://cn.vueis.org/guide/extras/render-function</a></p>
<p>vue 使用一些特殊的自定义指令，并且会做模板编译的优化</p>
<ul>
<li>​	v-if</li>
<li>​	v-for</li>
<li>​	v-on</li>
</ul>
<p>jsx 是 <strong>h 函数的语法糖</strong>，<strong>使用花括号</strong>并且<strong>可以写 javascript 表达式</strong></p>
<ul>
<li><p>{ isDisabled ?” : “}</p>
</li>
<li><p>{items.map(item &#x3D;&gt;<li>{item}</li>)}</p>
</li>
<li><p>onClick &#x3D; {() &#x3D;&gt; { itemClick(item)}}</p>
</li>
<li><p><strong>属性</strong></p>
<ul>
<li>vue: setup语法支持 defineProps 泛型</li>
<li>jsx：不支持泛型，要使用 props 属性</li>
</ul>
</li>
<li><p><strong>事件</strong></p>
<ul>
<li>vue: setup 语法支持 defineEmits 泛型</li>
<li>jsx： 不支持泛型，要使用 emits 属性</li>
</ul>
</li>
<li><p><strong>渲染slots</strong></p>
<ul>
<li>vue使用<ul>
<li>默认 <slot></slot></li>
<li>具名 <slot name="footer"></slot></li>
</ul>
</li>
<li>jsx使用<ul>
<li>默认:{slots.default()}</li>
<li>具名:{slots.footer()}</li>
</ul>
</li>
</ul>
<p>																						</p>
</li>
<li><p><strong>传递slots</strong></p>
<ul>
<li><p>vue</p>
<ul>
<li><p><MyComponent>Hello</MyComponent></p>
</li>
<li><pre><code class="vue">&lt;MyComponent&gt;

&lt;template #footer&gt;Footer&lt;/template&gt;

&lt;/MyComponent&gt;
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- jsx</span><br><span class="line"></span><br><span class="line">  - &lt;MyComponent&gt;&#123;()=&gt;&#x27;hello&#x27;&#125;&lt;/MyComponent&gt;</span><br><span class="line"></span><br><span class="line">  - ```vue</span><br><span class="line">    &lt;MyComponent&gt;&#123;&#123;</span><br><span class="line">    default:()=&gt; &#x27;default slot&#x27;,</span><br><span class="line">    footer:()=&gt; &lt;div&gt;footer&lt;/div&gt;,</span><br><span class="line">    &#125;&#125;&lt;/MyComponent&gt;</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>expose</strong></p>
<ul>
<li>vue使用defineExpose导出实例</li>
<li>jsx使用expose函数导出实例</li>
</ul>
</li>
</ul>
<h2 id="10-Message组件"><a href="#10-Message组件" class="headerlink" title="10.Message组件"></a>10.Message组件</h2><h3 id="1-需求分析-6"><a href="#1-需求分析-6" class="headerlink" title="(1)需求分析"></a>(1)需求分析</h3><h4 id="功能分析-1"><a href="#功能分析-1" class="headerlink" title="功能分析"></a>功能分析</h4><ul>
<li>在特定的行为的时候，弹出一个对应的提示(支持普通文本以及VNode)</li>
<li>提示在一定时间后可以消失</li>
<li>可以手动关闭</li>
<li>可以弹出多个提示</li>
<li>有多种类型( default,primary,danger…)</li>
</ul>
<h4 id="难点"><a href="#难点" class="headerlink" title="难点"></a>难点</h4><p>1.使用函数式的方式来创建组件</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">createMessage</span>(<span class="string">&#x27;hello world&#x27;</span>,props)</span><br><span class="line"><span class="comment">//?怎么将一个组件 函数式的渲染到一个节点上呢?</span></span><br><span class="line"><span class="comment">//或许可以采用 createApp&gt;</span></span><br></pre></td></tr></table></figure>

<p>2.可以弹出多个提示，并且旧提示可以根据新提示向下移动位置</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//创建多个实例，应该没有问题，但怎么调整位置是个难题，看起来我们需要动态调整组件的属性</span></span><br><span class="line"><span class="keyword">const</span> component1 = <span class="title function_">createApp</span>(<span class="title class_">Message</span>)</span><br><span class="line"><span class="keyword">const</span> component2 = <span class="title function_">createApp</span>(<span class="title class_">Message</span>)</span><br><span class="line"><span class="comment">//component2 能感知到 component1 的位置，然后动态的进行调整</span></span><br></pre></td></tr></table></figure>



<h4 id="属性分析"><a href="#属性分析" class="headerlink" title="属性分析"></a>属性分析</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">MessageProps</span>&#123;</span><br><span class="line">	<span class="attr">message</span>: <span class="built_in">string</span> | <span class="title class_">VNode</span>;</span><br><span class="line">	<span class="attr">duration</span>: <span class="built_in">number</span>;</span><br><span class="line">	<span class="attr">showClose</span>: boolen;</span><br><span class="line">	<span class="attr">type</span>: <span class="string">&#x27;primary&#x27;</span> | ....</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="事件以及实例"><a href="#事件以及实例" class="headerlink" title="事件以及实例"></a>事件以及实例</h4><p>由于是由函数的方式创建组件，这里暂且无法明确对应的事件以及实例</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> instance = <span class="title function_">createMessage</span>(<span class="string">&#x27;hello world&#x27;</span>,props)</span><br><span class="line">instance.<span class="title function_">close</span>()</span><br></pre></td></tr></table></figure>



<h3 id="2-代码编写-5"><a href="#2-代码编写-5" class="headerlink" title="(2)代码编写"></a>(2)代码编写</h3><h4 id="1-将组件Render到DOM节点上"><a href="#1-将组件Render到DOM节点上" class="headerlink" title="1.将组件Render到DOM节点上"></a>1.将组件Render到DOM节点上</h4><p><strong>使用 createApp 的弊端</strong></p>
<p> 这个方法太重了，它其实返回的是一个应用的实例，而我们需要轻量级的解决方案</p>
<p><strong>隆重推出render函数</strong></p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//一个vue内部神奇的函数，文档中都没有特别的记录</span></span><br><span class="line"><span class="comment">//它负责将一个 vnode 渲染到  </span></span><br><span class="line"><span class="comment">//它是一个很轻量级的解决方案</span></span><br><span class="line"><span class="keyword">import</span> &#123; render &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">render</span>(vNode,<span class="variable constant_">DOM</span>节点) <span class="comment">//返回的是void</span></span><br></pre></td></tr></table></figure>

<p>在本案例的使用:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//`h()` 函数用于创建 vnodes</span></span><br><span class="line"><span class="keyword">const</span> vnode = <span class="title function_">h</span>(<span class="title class_">MessageConstructor</span>, newProps)</span><br><span class="line"><span class="comment">//渲染vnode 到 dom 节点上</span></span><br><span class="line"><span class="title function_">render</span>(vnode, container)</span><br><span class="line"><span class="comment">//非空断言操作符 appendChild只能element，但这个类型可能为null，所以使用非空断言</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(container.<span class="property">firstElementChild</span>!)</span><br></pre></td></tr></table></figure>

<h4 id="2-v-show-隐藏节点后清除节点-该节点已经挂载实例"><a href="#2-v-show-隐藏节点后清除节点-该节点已经挂载实例" class="headerlink" title="2.v-show 隐藏节点后清除节点(该节点已经挂载实例)"></a>2.v-show 隐藏节点后清除节点(该节点已经挂载实例)</h4><p>清除节点</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//渲染null 到 dom 节点上 </span></span><br><span class="line"><span class="title function_">render</span>(<span class="literal">null</span>, container)</span><br><span class="line"><span class="comment">//扩展新属性onDestory</span></span><br><span class="line">  <span class="keyword">const</span> newProps = &#123;</span><br><span class="line">    ...props,</span><br><span class="line">    id,</span><br><span class="line">    <span class="attr">zIndex</span>: <span class="title function_">nextZIndex</span>(),</span><br><span class="line">    <span class="attr">onDestory</span>: destory</span><br><span class="line">  &#125;</span><br><span class="line"><span class="comment">//`h()` 函数用于创建 vnodes</span></span><br><span class="line"> <span class="keyword">const</span> vnode = <span class="title function_">h</span>(<span class="title class_">MessageConstructor</span>, newProps)	</span><br></pre></td></tr></table></figure>

<h4 id="3-通过使用一个数组来实现获取同一个组件不同实例的内容"><a href="#3-通过使用一个数组来实现获取同一个组件不同实例的内容" class="headerlink" title="3.通过使用一个数组来实现获取同一个组件不同实例的内容"></a>3.通过使用一个数组来实现获取同一个组件不同实例的内容</h4><p>这样可以为下一步动态定位多个实例做准备</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">types.<span class="property">ts</span></span><br><span class="line"><span class="comment">//Message数组</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">MessageContext</span> &#123;</span><br><span class="line">  <span class="comment">//唯一标识message</span></span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">vnode</span>: <span class="title class_">VNode</span>;</span><br><span class="line">  <span class="attr">vm</span>: <span class="title class_">ComponentInternalInstance</span>;</span><br><span class="line">  <span class="attr">props</span>: <span class="title class_">MessageProps</span>;</span><br><span class="line">  <span class="attr">destory</span>: <span class="function">() =&gt;</span> <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Omit作用</span></span><br><span class="line"><span class="comment">//要操作的类型MessageProps，要忽略的对应的属性&#x27;onDestory&#x27; | &#x27;id&#x27; | &#x27;zIndex&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">CreateMessageProps</span> = <span class="title class_">Omit</span>&lt;<span class="title class_">MessageProps</span>, <span class="string">&#x27;onDestory&#x27;</span> | <span class="string">&#x27;id&#x27;</span> | <span class="string">&#x27;zIndex&#x27;</span>&gt;</span><br><span class="line">  </span><br><span class="line">method.<span class="property">ts</span>:    </span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">CreateMessageProps</span>, <span class="title class_">MessageContext</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./types&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//初始id为1</span></span><br><span class="line"><span class="keyword">let</span> seed = <span class="number">1</span></span><br><span class="line"><span class="comment">//初始为空Messaage数组</span></span><br><span class="line"><span class="keyword">const</span> <span class="attr">instances</span>: <span class="title class_">MessageContext</span>[] = <span class="title function_">shallowReactive</span>([])</span><br><span class="line"><span class="comment">//创建Message组件函数</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">createMessage</span> = (<span class="params">props: CreateMessageProps</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; nextZIndex &#125; = <span class="title function_">useZIndex</span>()</span><br><span class="line">  <span class="comment">//id + 1 操作，用来表示不同的message</span></span><br><span class="line">  <span class="keyword">const</span> id = <span class="string">`message_<span class="subst">$&#123;seed++&#125;</span>`</span></span><br><span class="line">  <span class="comment">//创建dom节点</span></span><br><span class="line">  <span class="keyword">const</span> container = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>)</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  <span class="comment">//清除节点</span></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">destory</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="comment">//删除数组中的instance实例</span></span><br><span class="line">    <span class="comment">//通过id找对应的instance实例</span></span><br><span class="line">    <span class="keyword">const</span> idx = instances.<span class="title function_">findIndex</span>(<span class="function"><span class="params">instance</span> =&gt;</span> instance.<span class="property">id</span> === id)</span><br><span class="line">    <span class="comment">//没找到就返回</span></span><br><span class="line">    <span class="keyword">if</span> (idx === -<span class="number">1</span>) <span class="keyword">return</span></span><br><span class="line">    <span class="comment">//找到就删除</span></span><br><span class="line">    instances.<span class="title function_">splice</span>(idx, <span class="number">1</span>)</span><br><span class="line">    <span class="comment">//渲染null 到 dom 容器节点上 </span></span><br><span class="line">    <span class="title function_">render</span>(<span class="literal">null</span>, container)</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  <span class="comment">//拿到最后一项instance实例</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">getLastInstance</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> instances.<span class="title function_">at</span>(-<span class="number">1</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="4-旧提示可以根据新提示向下移动位置"><a href="#4-旧提示可以根据新提示向下移动位置" class="headerlink" title="4.旧提示可以根据新提示向下移动位置"></a>4.旧提示可以根据新提示向下移动位置</h4><p>通过获取实例ref&#x3D;”messageRef”   计算高度量的偏移再返回样式给实例:style&#x3D;”cssStyle”并且暴露出去  bottomOffset ，更新时要等dom挂载后更新所以要用到await 和 nexttick</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;div</span><br><span class="line">  class=&quot;vk-message&quot;</span><br><span class="line">  v-show=&quot;visible&quot;</span><br><span class="line">  :class=&quot;&#123;</span><br><span class="line">    [`vk-message--$&#123;type&#125;`]: type,</span><br><span class="line">    &#x27;is-close&#x27;: showClose</span><br><span class="line">  &#125;&quot;</span><br><span class="line">  role=&quot;alert&quot;</span><br><span class="line">  ref=&quot;messageRef&quot; </span><br><span class="line">  :style=&quot;cssStyle&quot;</span><br><span class="line">  @mouseenter=&quot;clearTimer&quot;</span><br><span class="line">  @mouseleave=&quot;startTimer&quot;</span><br><span class="line">&gt; </span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> props = <span class="title function_">withDefaults</span>(defineProps&lt;<span class="title class_">MessageProps</span>&gt;(), &#123;</span><br><span class="line">  <span class="attr">type</span>: <span class="string">&#x27;info&#x27;</span>,</span><br><span class="line">  <span class="attr">duration</span>: <span class="number">3000</span>,</span><br><span class="line">  <span class="comment">//偏移值默认为20px</span></span><br><span class="line">  <span class="attr">offset</span>: <span class="number">20</span>,</span><br><span class="line">  <span class="attr">transitionName</span>: <span class="string">&#x27;fade-up&#x27;</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//获取message组件的实例</span></span><br><span class="line"><span class="keyword">const</span> messageRef = ref&lt;<span class="title class_">HTMLDivElement</span>&gt;()</span><br><span class="line"><span class="comment">// 计算偏移高度</span></span><br><span class="line"><span class="comment">// 这个 div 的高度</span></span><br><span class="line"><span class="keyword">const</span> height = <span class="title function_">ref</span>(<span class="number">0</span>)</span><br><span class="line"><span class="comment">// 上一个实例的最下面的坐标数字，第一个是 0</span></span><br><span class="line"><span class="keyword">const</span> lastOffset = <span class="title function_">computed</span>(<span class="function">() =&gt;</span> <span class="title function_">getLastBottomOffset</span>(props.<span class="property">id</span>))</span><br><span class="line"><span class="comment">// 这个元素应该使用的 top</span></span><br><span class="line"><span class="keyword">const</span> topOffset = <span class="title function_">computed</span>(<span class="function">() =&gt;</span> props.<span class="property">offset</span> + lastOffset.<span class="property">value</span>)</span><br><span class="line"><span class="comment">// 这个元素为下一个元素预留的 offset，也就是它最低端 bottom 的 值</span></span><br><span class="line"><span class="keyword">const</span> bottomOffset = <span class="title function_">computed</span>(<span class="function">() =&gt;</span> height.<span class="property">value</span> + topOffset.<span class="property">value</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> cssStyle = <span class="title function_">computed</span>(<span class="function">() =&gt;</span> (&#123;</span><br><span class="line">  <span class="attr">top</span>: topOffset.<span class="property">value</span> + <span class="string">&#x27;px&#x27;</span>,</span><br><span class="line">  <span class="attr">zIndex</span>: props.<span class="property">zIndex</span></span><br><span class="line">&#125;))</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">updateHeight</span>(<span class="params"></span>) &#123;</span><br><span class="line">  height.<span class="property">value</span> = messageRef.<span class="property">value</span>!.<span class="title function_">getBoundingClientRect</span>().<span class="property">height</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">defineExpose</span>(&#123;</span><br><span class="line">  bottomOffset,</span><br><span class="line">  visible</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="5-怎么在组件外部获取暴露出去的bottomOffset"><a href="#5-怎么在组件外部获取暴露出去的bottomOffset" class="headerlink" title="5.怎么在组件外部获取暴露出去的bottomOffset"></a>5.怎么在组件外部获取暴露出去的bottomOffset</h4><p>​	通过Vnode的component属性上的expose属性就能拿到对应的属性</p>
<h4 id="6-通过VNode拿到组件实例"><a href="#6-通过VNode拿到组件实例" class="headerlink" title="6.通过VNode拿到组件实例"></a>6.通过VNode拿到组件实例</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> component = vNode.<span class="property">component</span></span><br><span class="line"><span class="comment">//它是一个特殊类型，称之为ComponentInternalInstance</span></span><br><span class="line"><span class="comment">//它代表组件的内部类型</span></span><br><span class="line"><span class="comment">//在组件内部也可以使用一个特殊的函数获取这个实例</span></span><br><span class="line"><span class="keyword">const</span> instance = <span class="title function_">getCurrentInstance</span>()</span><br></pre></td></tr></table></figure>



<h4 id="7-shallowReavtive"><a href="#7-shallowReavtive" class="headerlink" title="7.shallowReavtive"></a>7.shallowReavtive</h4><p>文档地址：<a target="_blank" rel="noopener" href="https://cn.vuejs..org/api/reactivity-advanced.html#shallowreactive">https://cn.vuejs..org/api/reactivity-advanced.html#shallowreactive</a></p>
<ul>
<li>和<code>reactive()</code>不同，这里没有深层级的转换：一个浅层响应式对象里只有根级别的属性是响应式的。属性的值会被原样存储和暴露。</li>
<li>假如是数组的话，创建一个浅层响应式的空数组，这意味着数组的元素不会被递归地转换成响应式对象。当我们对数组进行一些增删改操作时，Vue会自动检测到这些变化，并更新对应的视图。</li>
<li>性能优化</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="attr">instances</span>: <span class="title class_">MessageContext</span>[] = <span class="title function_">shallowReactive</span>([])</span><br></pre></td></tr></table></figure>



<h4 id="8-手动调用删除"><a href="#8-手动调用删除" class="headerlink" title="8.手动调用删除"></a>8.手动调用删除</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 手动调用删除，其实就是手动的调整组件中 visible 的值</span></span><br><span class="line"><span class="comment">// visible 是通过 expose 传出来的</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">manualDestroy</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> instance = instances.<span class="title function_">find</span>(<span class="function"><span class="params">instance</span> =&gt;</span> instance.<span class="property">id</span> === id)</span><br><span class="line">  <span class="keyword">if</span> (instance) &#123;</span><br><span class="line">    instance.<span class="property">vm</span>.<span class="property">exposed</span>!.<span class="property">visible</span>.<span class="property">value</span> = <span class="literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="9-添加zIndex"><a href="#9-添加zIndex" class="headerlink" title="9.添加zIndex"></a>9.添加zIndex</h4><p>使用hooks实现</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//useZindex.ts：</span></span><br><span class="line"><span class="keyword">import</span> &#123; computed, ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> zIndex = <span class="title function_">ref</span>(<span class="number">0</span>)</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">useZIndex</span> = (<span class="params">initialValue = <span class="number">2000</span></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> initialZIndex = <span class="title function_">ref</span>(initialValue)</span><br><span class="line">  <span class="keyword">const</span> currentZIndex = <span class="title function_">computed</span>(<span class="function">() =&gt;</span> zIndex.<span class="property">value</span> + initialZIndex.<span class="property">value</span>)</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">nextZIndex</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    zIndex.<span class="property">value</span> ++</span><br><span class="line">    <span class="keyword">return</span> currentZIndex.<span class="property">value</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    currentZIndex,</span><br><span class="line">    nextZIndex,</span><br><span class="line">    initialZIndex</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> useZIndex</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//method.ts：</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> useZIndex <span class="keyword">from</span> <span class="string">&#x27;../../hooks/useZIndex&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123; nextZIndex &#125; = <span class="title function_">useZIndex</span>()</span><br><span class="line"> </span><br><span class="line"><span class="attr">zIndex</span>: <span class="title function_">nextZIndex</span>(),</span><br></pre></td></tr></table></figure>



<h4 id="10-添加键盘关闭（按esc可以关闭message"><a href="#10-添加键盘关闭（按esc可以关闭message" class="headerlink" title="10.添加键盘关闭（按esc可以关闭message)"></a>10.添加键盘关闭（按esc可以关闭message)</h4><p>使用hooks实现</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//useEventListener.ts:</span></span><br><span class="line"><span class="keyword">import</span> &#123;  onMounted, onBeforeUnmount, isRef, watch, unref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> type &#123; <span class="title class_">Ref</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">useEventListener</span>(<span class="params"></span></span><br><span class="line"><span class="params">  target: Ref&lt;EventTarget | <span class="literal">null</span>&gt; | EventTarget,</span></span><br><span class="line"><span class="params">  event: string,</span></span><br><span class="line"><span class="params">  handler: (e: Event) =&gt; any</span></span><br><span class="line"><span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="title function_">isRef</span>(target)) &#123;</span><br><span class="line">    <span class="title function_">watch</span>(target, <span class="function">(<span class="params">value, oldValue</span>) =&gt;</span> &#123;</span><br><span class="line">      oldValue?.<span class="title function_">removeEventListener</span>(event, handler)</span><br><span class="line">      value?.<span class="title function_">addEventListener</span>(event, handler)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_">onMounted</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      target.<span class="title function_">addEventListener</span>(event, handler)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">onBeforeUnmount</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">unref</span>(target)?.<span class="title function_">removeEventListener</span>(event, handler)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Message.vue：</span></span><br><span class="line"><span class="keyword">import</span> useEventListener <span class="keyword">from</span> <span class="string">&#x27;../../hooks/useEventListener&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">keydown</span>(<span class="params">e: Event</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> event = e <span class="keyword">as</span> <span class="title class_">KeyboardEvent</span></span><br><span class="line">  <span class="keyword">if</span> (event.<span class="property">code</span> === <span class="string">&#x27;Escape&#x27;</span>) &#123;</span><br><span class="line">    visible.<span class="property">value</span> = <span class="literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">useEventListener</span>(<span class="variable language_">document</span>, <span class="string">&#x27;keydown&#x27;</span>, keydown)</span><br></pre></td></tr></table></figure>



<h4 id="11-hover到Message上面的时候不会自动关闭"><a href="#11-hover到Message上面的时候不会自动关闭" class="headerlink" title="11.hover到Message上面的时候不会自动关闭"></a>11.hover到Message上面的时候不会自动关闭</h4><p>基础的组件绑定事件操作实现</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">//Message.vue：</span><br><span class="line">&lt;div</span><br><span class="line">  class=&quot;vk-message&quot;</span><br><span class="line">  v-show=&quot;visible&quot;</span><br><span class="line">  :class=&quot;&#123;</span><br><span class="line">    [`vk-message--$&#123;type&#125;`]: type,</span><br><span class="line">    &#x27;is-close&#x27;: showClose</span><br><span class="line">  &#125;&quot;</span><br><span class="line">  role=&quot;alert&quot;</span><br><span class="line">  ref=&quot;messageRef&quot; </span><br><span class="line">  :style=&quot;cssStyle&quot;</span><br><span class="line">  @mouseenter=&quot;clearTimer&quot;</span><br><span class="line">  @mouseleave=&quot;startTimer&quot;</span><br><span class="line">&gt;  &lt;/div&gt;</span><br><span class="line">    </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Message.vue：</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">startTimer</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (props.<span class="property">duration</span> === <span class="number">0</span>) <span class="keyword">return</span></span><br><span class="line">  timer = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    visible.<span class="property">value</span> = <span class="literal">false</span></span><br><span class="line">  &#125;, props.<span class="property">duration</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">clearTimer</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="built_in">clearTimeout</span>(timer)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="12-添加动画以及样式"><a href="#12-添加动画以及样式" class="headerlink" title="12.添加动画以及样式"></a>12.添加动画以及样式</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="title class_">Transition</span> </span><br><span class="line">  :name=<span class="string">&quot;transitionName&quot;</span></span><br><span class="line">  @after-leave=<span class="string">&quot;destroyComponent&quot;</span></span><br><span class="line">  @enter=<span class="string">&quot;updateHeight&quot;</span></span><br><span class="line">&gt;</span><br><span class="line">&lt;/<span class="title class_">Transition</span>&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> props = <span class="title function_">withDefaults</span>(defineProps&lt;<span class="title class_">MessageProps</span>&gt;(), &#123;</span><br><span class="line">  <span class="attr">type</span>: <span class="string">&#x27;info&#x27;</span>,</span><br><span class="line">  <span class="attr">duration</span>: <span class="number">3000</span>,</span><br><span class="line">  <span class="comment">//偏移值默认为20px</span></span><br><span class="line">  <span class="attr">offset</span>: <span class="number">20</span>,</span><br><span class="line">  <span class="attr">transitionName</span>: <span class="string">&#x27;fade-up&#x27;</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">destroyComponent</span> () &#123;</span><br><span class="line">  props.<span class="title function_">onDestory</span>()</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">updateHeight</span>(<span class="params"></span>) &#123;</span><br><span class="line">  height.<span class="property">value</span> = messageRef.<span class="property">value</span>!.<span class="title function_">getBoundingClientRect</span>().<span class="property">height</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="attr">transition</span>: top <span class="title function_">var</span>(--vk-transition-duration), opacity <span class="title function_">var</span>(--vk-transition-duration), transform <span class="title function_">var</span>(--vk-transition-duration);</span><br><span class="line">  .<span class="property">vk</span>-message__content &#123;</span><br><span class="line">    <span class="attr">color</span>: <span class="title function_">var</span>(--vk-message-text-color);</span><br><span class="line">    overflow-<span class="attr">wrap</span>: anywhere;</span><br><span class="line">  &#125;</span><br><span class="line">  &amp;.<span class="property">is</span>-close .<span class="property">vk</span>-message__content &#123;</span><br><span class="line">    padding-<span class="attr">right</span>: 30px;</span><br><span class="line">  &#125;</span><br><span class="line">  .<span class="property">vk</span>-message__close &#123;</span><br><span class="line">    <span class="attr">display</span>: flex;</span><br><span class="line">    align-<span class="attr">items</span>: center;</span><br><span class="line">  &#125;</span><br><span class="line">  .<span class="property">vk</span>-message__close svg &#123;</span><br><span class="line">    <span class="attr">cursor</span>: pointer;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">@each $val <span class="keyword">in</span> info,success,warning,danger &#123; </span><br><span class="line">  .<span class="property">vk</span>-message--$(val) &#123;</span><br><span class="line">    --vk-message-bg-<span class="attr">color</span>: <span class="title function_">var</span>(--vk-color-$(val)-light-<span class="number">9</span>);</span><br><span class="line">    --vk-message-border-<span class="attr">color</span>: <span class="title function_">var</span>(--vk-color-$(val)-light-<span class="number">8</span>);</span><br><span class="line">    --vk-message-text-<span class="attr">color</span>: <span class="title function_">var</span>(--vk-color-$(val));</span><br><span class="line">    .<span class="property">vk</span>-message__close &#123;</span><br><span class="line">      --vk-icon-<span class="attr">color</span>: <span class="title function_">var</span>(--vk-color-$(val));</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">.<span class="property">vk</span>-message.<span class="property">fade</span>-up-enter-<span class="keyword">from</span>,</span><br><span class="line">.<span class="property">vk</span>-message.<span class="property">fade</span>-up-leave-to &#123;</span><br><span class="line">  <span class="attr">opacity</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attr">transform</span>: <span class="title function_">translate</span>(-<span class="number">50</span>%, -<span class="number">100</span>%);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>









<h3 id="3-Message总结"><a href="#3-Message总结" class="headerlink" title="(3)Message总结"></a>(3)Message总结</h3><h4 id="使用函数式的方式创建组件"><a href="#使用函数式的方式创建组件" class="headerlink" title="使用函数式的方式创建组件"></a>使用函数式的方式创建组件</h4><p>1.使用render函数挂载在特定节点</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> container =  <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> vnode = <span class="title function_">h</span>(<span class="title class_">MessageConstructor</span>,props)</span><br><span class="line"><span class="title function_">render</span>(vnode,container)</span><br><span class="line"><span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendchild</span>(container.<span class="property">firstElementchild</span>!)</span><br></pre></td></tr></table></figure>

<p>2.销毁组件实例</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">render</span>(<span class="literal">null</span>,container)</span><br></pre></td></tr></table></figure>

<p>3.组件动态构造并且传入属性</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> newProps = &#123;</span><br><span class="line">...props,</span><br><span class="line"><span class="attr">onDestory</span>:destory</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> vnode = <span class="title function_">h</span>(<span class="title class_">MessageConstructor</span>,newProps)</span><br></pre></td></tr></table></figure>

<p>4.使用一个数组保存组件实例等信息，并且添加对应的函数对数组进行处理</p>
<p>5.计算偏移量</p>
<p>6.在函数中获取这个偏移量</p>
<ul>
<li>vnode.component-Componentinternallnstance组件内部实例</li>
<li>在组件内可以使用getCurrentlnstance()获取</li>
<li>在函数中使用vnode.component.exposed!.bottomOffset.value获得</li>
</ul>
<p>7.将instances 数组改为响应式：使用shallowReactive([])</p>
<p>8.添加两个通用钩子函数</p>
<ul>
<li>useZIndex()</li>
<li>useEventListener()</li>
</ul>
<p>9.添加有趣的动画</p>
<p>​	使用transformY以及fade作出一个fade-up的效果</p>
<p>10.测试-函数式创建组件的测试</p>
<p>​	使用rAF()等待动画执行完毕</p>
<h2 id="11-更好的展示工具VitePress-使用工具生成文档"><a href="#11-更好的展示工具VitePress-使用工具生成文档" class="headerlink" title="11.更好的展示工具VitePress-使用工具生成文档"></a>11.更好的展示工具VitePress-使用工具生成文档</h2><h4 id="1-创建放在-docs文件夹下"><a href="#1-创建放在-docs文件夹下" class="headerlink" title="1.创建放在.&#x2F;docs文件夹下"></a>1.创建放在.&#x2F;docs文件夹下</h4><h4 id="2-在-gitignore添加-vitepress-dist静态文件和-vitepress-cache缓存文件"><a href="#2-在-gitignore添加-vitepress-dist静态文件和-vitepress-cache缓存文件" class="headerlink" title="2.在.gitignore添加.vitepress&#x2F;dist静态文件和.&#x2F;vitepress&#x2F;cache缓存文件"></a>2.在.gitignore添加.vitepress&#x2F;dist静态文件和.&#x2F;vitepress&#x2F;cache缓存文件</h4><h4 id="3-文件夹结构"><a href="#3-文件夹结构" class="headerlink" title="3.文件夹结构"></a>3.文件夹结构</h4><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">docs</span><br><span class="line"><span class="code">	-.vitepress</span></span><br><span class="line"><span class="code">		--config.ts</span></span><br><span class="line"><span class="code">	-api-examples.md</span></span><br><span class="line"><span class="code">	-markdown-examples.md</span></span><br><span class="line"><span class="code">package.json</span></span><br></pre></td></tr></table></figure>

<h4 id="3-npm-run-doc-dev"><a href="#3-npm-run-doc-dev" class="headerlink" title="3.npm run doc:dev"></a>3.npm run doc:dev</h4><h4 id="4-Markdown-Extension-Examples"><a href="#4-Markdown-Extension-Examples" class="headerlink" title="4.Markdown Extension Examples"></a>4.Markdown Extension Examples</h4><p>​	Syntax Highlighting<br>​	Custom Containers</p>
<h4 id="5-路由系统"><a href="#5-路由系统" class="headerlink" title="5.路由系统"></a>5.路由系统</h4><p>index.md  –&gt;  &#x2F;index.html(accessible as &#x2F;)</p>
<h4 id="6-两个关于路径的概念"><a href="#6-两个关于路径的概念" class="headerlink" title="6.两个关于路径的概念"></a>6.两个关于路径的概念</h4><p>Project Root：项目路径，会在这个路径下寻找.vitepress文件夹，默认是当前的工作路径<br>Source Directory：Markdown文件存放的文件夹，默认和Project Root相同，在这个文件夹下，会处理所有的Md文件，并且生成对应的路由，可以使用VitePress中配置文件中的srcDir进行修改</p>
<h4 id="7-在md文件中写vue组件写法，完全不冲突，支持"><a href="#7-在md文件中写vue组件写法，完全不冲突，支持" class="headerlink" title="7.在md文件中写vue组件写法，完全不冲突，支持"></a>7.在md文件中写vue组件写法，完全不冲突，支持</h4><p><img src="/../images/Vue3_%E5%B0%81%E8%A3%85%E7%BB%84%E4%BB%B6%E5%BA%93%E9%A1%B9%E7%9B%AE/49.png"></p>
<h4 id="8-preview-demo实现组件和代码显示"><a href="#8-preview-demo实现组件和代码显示" class="headerlink" title="8.preview-demo实现组件和代码显示"></a>8.preview-demo实现组件和代码显示</h4><p><img src="/../images/Vue3_%E5%B0%81%E8%A3%85%E7%BB%84%E4%BB%B6%E5%BA%93%E9%A1%B9%E7%9B%AE/48.png"></p>
<h4 id="9-自定义主题颜色"><a href="#9-自定义主题颜色" class="headerlink" title="9.自定义主题颜色"></a>9.自定义主题颜色</h4><p>在custom里对vitepress的样式进行重载</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-pseudo">:root</span> &#123;</span><br><span class="line">  <span class="attr">--vp-c-brand</span>: <span class="built_in">var</span>(--vk-color-primary);</span><br><span class="line">  <span class="attr">--vp-c-brand-light</span>: <span class="built_in">var</span>(--vk-color-primary-light-<span class="number">3</span>);</span><br><span class="line">  <span class="attr">--vp-c-brand-lighter</span>: <span class="built_in">var</span>(--vk-color-primary-light-<span class="number">5</span>);</span><br><span class="line">  <span class="attr">--vp-c-brand-dark</span>: <span class="built_in">var</span>(--vk-color-primary-dark-<span class="number">2</span>);</span><br><span class="line">  <span class="attr">--vp-c-brand-darker</span>: <span class="number">#265F99</span>;</span><br><span class="line"></span><br><span class="line">  <span class="attr">--component-preview-bg</span>: <span class="built_in">var</span>(--vp-code-block-bg);</span><br><span class="line">  <span class="attr">--component-preview-soft</span>: <span class="built_in">var</span>(--vp-code-block-bg-light);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">var</span>(--vp-c-text-<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">h1</span>, <span class="selector-tag">h2</span>, <span class="selector-tag">h3</span>, <span class="selector-tag">h4</span>, <span class="selector-tag">h5</span>, <span class="selector-tag">h6</span>, <span class="selector-tag">p</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">var</span>(--vp-c-text-<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="10-为生产环境打包并且部署"><a href="#10-为生产环境打包并且部署" class="headerlink" title="10.为生产环境打包并且部署"></a>10.为生产环境打包并且部署</h4><p>文档：<a target="_blank" rel="noopener" href="https://vitepress.dev/guide/deploy">https://vitepress.dev/guide/deploy</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 打包</span></span><br><span class="line">npm run docs:build</span><br><span class="line"><span class="comment"># 打包生成的文件位于：</span></span><br><span class="line"><span class="comment"># docs/.vitepress/dist</span></span><br><span class="line"><span class="comment"># 本地测试</span></span><br><span class="line"><span class="comment"># 本地启动一个静态文件服务器用于 docs/.vitepress/dist</span></span><br><span class="line"><span class="comment"># 可以测试一下最终站点是否OK</span></span><br><span class="line">npm run docs:preview</span><br><span class="line"><span class="comment"># 部署</span></span><br><span class="line"><span class="comment"># 拷贝dist文件中的文件到远程服务器</span></span><br><span class="line"><span class="comment"># 或者使用第三方服务 Github Pages/Gitee Pages 等等</span></span><br></pre></td></tr></table></figure>







<h2 id="12-Input组件"><a href="#12-Input组件" class="headerlink" title="12.Input组件"></a>12.Input组件</h2><h3 id="1-需求分析-7"><a href="#1-需求分析-7" class="headerlink" title="(1) 需求分析"></a>(1) 需求分析</h3><ul>
<li>支持Input&#x2F;Textarea</li>
<li>支持不同大小</li>
<li>支持 v-model</li>
<li>支持一键清空（有值的时候显示一个按钮，点击清空）</li>
<li>支持切换是否密码显示（有值的时候显示一个按钮，点击切换密码可见&#x2F;不可见）</li>
<li>支持自定义前缀&#x2F;后缀slot（(prefix&#x2F;suffix),一般用于图标</li>
<li>支持复合型输入框自定义前置或者后置(prepend&#x2F;append),一般用于说明和按钮</li>
<li>一些原生属性的支持</li>
</ul>
<h4 id="属性-2"><a href="#属性-2" class="headerlink" title="属性"></a>属性</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">interface <span class="title class_">InputProps</span> &#123;</span><br><span class="line">type?:<span class="string">&#x27;text&#x27;</span>|<span class="string">&#x27;textarea&#x27;</span>|<span class="string">&#x27;password&#x27;</span>;</span><br><span class="line">size?:<span class="string">&#x27;large&#x27;</span>|<span class="string">&#x27;small&#x27;</span>;</span><br><span class="line">clearable?:boolean;</span><br><span class="line">showPassword?:boolean;</span><br><span class="line">disabled?:boolean;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="事件-2"><a href="#事件-2" class="headerlink" title="事件"></a>事件</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">interface <span class="title class_">InputEmits</span> &#123;</span><br><span class="line">(<span class="attr">e</span>:<span class="string">&#x27;change&#x27;</span>,<span class="attr">value</span>:string):<span class="keyword">void</span>;</span><br><span class="line">(<span class="attr">e</span>:<span class="string">&#x27;inputl&#x27;</span>,<span class="attr">value</span>:string):<span class="keyword">void</span>;</span><br><span class="line">(<span class="attr">e</span>:<span class="string">&#x27;focus&#x27;</span>):<span class="keyword">void</span>;</span><br><span class="line">(<span class="attr">e</span>:<span class="string">&#x27;blur&#x27;</span>):<span class="keyword">void</span>;</span><br><span class="line">(<span class="attr">e</span>:<span class="string">&#x27;clear&#x27;</span>):<span class="keyword">void</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Slots"><a href="#Slots" class="headerlink" title="Slots"></a>Slots</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">prepend,append,prefix,suffix</span><br></pre></td></tr></table></figure>



<h4 id="Expose"><a href="#Expose" class="headerlink" title="Expose"></a>Expose</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> interface <span class="title class_">InputInstance</span> &#123;</span><br><span class="line"><span class="attr">ref</span>:<span class="title class_">HTMLInputElement</span> | <span class="title class_">HTMLTextAreaElement</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="2-代码编写-6"><a href="#2-代码编写-6" class="headerlink" title="(2) 代码编写"></a>(2) 代码编写</h3><h4 id="1-编写测试用例来验证静态结构是否正确"><a href="#1-编写测试用例来验证静态结构是否正确" class="headerlink" title="1.编写测试用例来验证静态结构是否正确"></a>1.编写测试用例来验证静态结构是否正确</h4><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">describe</span>(<span class="string">&#x27;Input&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&#x27;基本展示&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 针对动态 class，查看 classes 是否正确</span></span><br><span class="line">    <span class="comment">// 针对 v-if 是否渲染正确的标签以及内容</span></span><br><span class="line">    <span class="comment">// 针对 slots，是否渲染对应的 slots 内容</span></span><br><span class="line">    <span class="keyword">const</span> wrapper = <span class="title function_">mount</span>(<span class="title class_">Input</span>, &#123;</span><br><span class="line">      <span class="attr">props</span>: &#123;</span><br><span class="line">        <span class="attr">size</span>: <span class="string">&#x27;small&#x27;</span>,</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&#x27;text&#x27;</span>,</span><br><span class="line">        <span class="attr">modelValue</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">slots</span>: &#123;</span><br><span class="line">        <span class="attr">prepend</span>: <span class="string">&#x27;prepend&#x27;</span>,</span><br><span class="line">        <span class="attr">prefix</span>: <span class="string">&#x27;prefix&#x27;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(wrapper.<span class="title function_">html</span>())</span><br><span class="line">    <span class="comment">// classes</span></span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">classes</span>()).<span class="title function_">toContain</span>(<span class="string">&#x27;vk-input--small&#x27;</span>)</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">classes</span>()).<span class="title function_">toContain</span>(<span class="string">&#x27;is-prepend&#x27;</span>)</span><br><span class="line">    <span class="comment">// should render input</span></span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">find</span>(<span class="string">&#x27;input&#x27;</span>).<span class="title function_">exists</span>()).<span class="title function_">toBeTruthy</span>()</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">get</span>(<span class="string">&#x27;input&#x27;</span>).<span class="title function_">attributes</span>(<span class="string">&#x27;type&#x27;</span>)).<span class="title function_">toBe</span>(<span class="string">&#x27;text&#x27;</span>)</span><br><span class="line">    <span class="comment">// slots</span></span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">find</span>(<span class="string">&#x27;.vk-input__prepend&#x27;</span>).<span class="title function_">exists</span>()).<span class="title function_">toBeTruthy</span>()</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">get</span>(<span class="string">&#x27;.vk-input__prepend&#x27;</span>).<span class="title function_">text</span>()).<span class="title function_">toBe</span>(<span class="string">&#x27;prepend&#x27;</span>)</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">find</span>(<span class="string">&#x27;.vk-input__prefix&#x27;</span>).<span class="title function_">exists</span>()).<span class="title function_">toBeTruthy</span>()</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">get</span>(<span class="string">&#x27;.vk-input__prefix&#x27;</span>).<span class="title function_">text</span>()).<span class="title function_">toBe</span>(<span class="string">&#x27;prefix&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// textarea</span></span><br><span class="line">    <span class="keyword">const</span> wrapper2 = <span class="title function_">mount</span>(<span class="title class_">Input</span>, &#123;</span><br><span class="line">      <span class="attr">props</span>: &#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&#x27;textarea&#x27;</span>,</span><br><span class="line">        <span class="attr">modelValue</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="title function_">expect</span>(wrapper2.<span class="title function_">find</span>(<span class="string">&#x27;textarea&#x27;</span>).<span class="title function_">exists</span>()).<span class="title function_">toBeTruthy</span>()</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>



<h4 id="2-TDD的开发方式"><a href="#2-TDD的开发方式" class="headerlink" title="2.TDD的开发方式"></a>2.TDD的开发方式</h4><p>TDD(Test-Driven Development,测试驱动开发)是一种软件开发方法，它强调在编写代码之前先编写测<br>试用例，然后通过不断地编写和运行测试用例来驱动代码的开发。</p>
<ul>
<li>1.编写测试用例</li>
<li>2.运行测试用例</li>
<li>3.编写代码：根据测试用例的要求，编写代码，实现功能。</li>
<li>4.运行测试用例</li>
<li>5.重构代码（可选）</li>
<li>6.重复上述步骤</li>
</ul>
<h4 id="3-支持-v-model-的测试用例和实现"><a href="#3-支持-v-model-的测试用例和实现" class="headerlink" title="3.支持 v-model 的测试用例和实现"></a>3.支持 v-model 的测试用例和实现</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">it</span>(<span class="string">&#x27;支持 v-model&#x27;</span>, <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">   <span class="keyword">const</span> <span class="attr">wrapper</span>:<span class="title class_">VueWrapper</span> = <span class="title function_">mount</span>(<span class="title class_">Input</span>, &#123;</span><br><span class="line">     <span class="attr">props</span>: &#123;</span><br><span class="line">       <span class="attr">modelValue</span>: <span class="string">&#x27;test&#x27;</span>,</span><br><span class="line">       <span class="string">&#x27;onUpdate:modelValue&#x27;</span>: <span class="function">(<span class="params">e: any</span>) =&gt;</span> wrapper.<span class="title function_">setProps</span>(&#123; <span class="attr">modelValue</span>: e &#125;),</span><br><span class="line">       <span class="attr">type</span>: <span class="string">&#x27;text&#x27;</span></span><br><span class="line">     &#125;</span><br><span class="line">   &#125;)</span><br><span class="line">   <span class="comment">// 初始值</span></span><br><span class="line">   <span class="keyword">const</span> input = wrapper.<span class="title function_">get</span>(<span class="string">&#x27;input&#x27;</span>)</span><br><span class="line">   <span class="title function_">expect</span>(input.<span class="property">element</span>.<span class="property">value</span>).<span class="title function_">toBe</span>(<span class="string">&#x27;test&#x27;</span>)</span><br><span class="line">   <span class="comment">// 更新值</span></span><br><span class="line">   <span class="comment">// 注意 setValue 是组合事件会触发 input 以及 change</span></span><br><span class="line">   <span class="keyword">await</span> input.<span class="title function_">setValue</span>(<span class="string">&#x27;update&#x27;</span>)</span><br><span class="line">   <span class="comment">//TypeScript 可能无法正确地推断出返回的对象的类型</span></span><br><span class="line">   <span class="comment">//手动指定返回对象的类型</span></span><br><span class="line">   <span class="title function_">expect</span>((wrapper.<span class="title function_">props</span>() <span class="keyword">as</span> &#123; <span class="attr">modelValue</span>:string &#125;).<span class="property">modelValue</span>).<span class="title function_">toBe</span>(<span class="string">&#x27;update&#x27;</span>)</span><br><span class="line">   <span class="title function_">expect</span>(input.<span class="property">element</span>.<span class="property">value</span>).<span class="title function_">toBe</span>(<span class="string">&#x27;update&#x27;</span>)</span><br><span class="line"></span><br><span class="line">   <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;the events&#x27;</span>, wrapper.<span class="title function_">emitted</span>())</span><br><span class="line">   <span class="title function_">expect</span>(wrapper.<span class="title function_">emitted</span>()).<span class="title function_">toHaveProperty</span>(<span class="string">&#x27;input&#x27;</span>)</span><br><span class="line">   <span class="title function_">expect</span>(wrapper.<span class="title function_">emitted</span>()).<span class="title function_">toHaveProperty</span>(<span class="string">&#x27;change&#x27;</span>)</span><br><span class="line">   <span class="comment">// [ [ &#x27;update&#x27; ], ...更多事件 ]</span></span><br><span class="line">   <span class="keyword">const</span> inputEvent = wrapper.<span class="title function_">emitted</span>(<span class="string">&#x27;input&#x27;</span>)</span><br><span class="line">   <span class="keyword">const</span> changeEvent = wrapper.<span class="title function_">emitted</span>(<span class="string">&#x27;change&#x27;</span>)</span><br><span class="line">   <span class="title function_">expect</span>(inputEvent![<span class="number">0</span>]).<span class="title function_">toEqual</span>([<span class="string">&#x27;update&#x27;</span>])</span><br><span class="line">   <span class="title function_">expect</span>(changeEvent![<span class="number">0</span>]).<span class="title function_">toEqual</span>([<span class="string">&#x27;update&#x27;</span>])</span><br><span class="line">   <span class="comment">// v-model 的异步更新</span></span><br><span class="line">   <span class="keyword">await</span> wrapper.<span class="title function_">setProps</span>(&#123; <span class="attr">modelValue</span>: <span class="string">&#x27;prop update&#x27;</span> &#125;)</span><br><span class="line">   <span class="title function_">expect</span>(input.<span class="property">element</span>.<span class="property">value</span>).<span class="title function_">toBe</span>(<span class="string">&#x27;prop update&#x27;</span>)</span><br><span class="line"> &#125;)</span><br></pre></td></tr></table></figure>



<ol>
<li><strong>props 和 emits 的定义</strong>：在 <code>&lt;script setup&gt;</code> 部分使用 <code>defineProps</code> 和 <code>defineEmits</code> 定义了组件的 props 和 emits，分别是 <code>InputProps</code> 和 <code>InputEmits</code>。其中 <code>InputProps</code> 定义了输入框组件可能接收的属性，而 <code>InputEmits</code> 定义了组件可能触发的事件。</li>
<li><strong>内部数据绑定</strong>：使用 <code>ref</code> 创建了一个名为 <code>innerValue</code> 的响应式引用，用于存储输入框的值。这个值会与 <code>props.modelValue</code> 进行双向绑定，从而实现了 <code>v-model</code> 的功能。</li>
<li><strong>输入框的事件处理</strong>：在输入框的 <code>@input</code> 事件中，调用了 <code>handleInput</code> 方法，将输入框的值更新到 <code>innerValue</code> 中，并触发了 <code>update:modelValue</code> 和 <code>input</code> 事件。在 <code>handleInput</code> 方法中，使用了 <code>emits</code> 函数来触发这两个事件。</li>
<li><strong>对外暴露输入框的引用</strong>：使用 <code>defineExpose</code> 将输入框的引用暴露给外部组件，这样外部组件就可以直接访问到输入框的实例，例如调用输入框的方法或属性。</li>
</ol>
<h4 id="4-支持按钮清空当前文本的测试用例和实现"><a href="#4-支持按钮清空当前文本的测试用例和实现" class="headerlink" title="4.支持按钮清空当前文本的测试用例和实现"></a>4.支持按钮清空当前文本的测试用例和实现</h4><p><strong>测试用例：</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">it</span>(<span class="string">&#x27;支持点击清空字符串&#x27;</span>, <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> wrapper = <span class="title function_">mount</span>(<span class="title class_">Input</span>, &#123;</span><br><span class="line">      <span class="attr">props</span>: &#123;</span><br><span class="line">        <span class="attr">modelValue</span>: <span class="string">&#x27;test&#x27;</span>,</span><br><span class="line">        <span class="attr">clearable</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&#x27;text&#x27;</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">global</span>: &#123;</span><br><span class="line">        <span class="attr">stubs</span>: [<span class="string">&#x27;Icon&#x27;</span>]</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">// 不出现对应的 Icon 区域</span></span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">find</span>(<span class="string">&#x27;.vk-input__clear&#x27;</span>).<span class="title function_">exists</span>()).<span class="title function_">toBeFalsy</span>()</span><br><span class="line">    <span class="keyword">const</span> input = wrapper.<span class="title function_">get</span>(<span class="string">&#x27;input&#x27;</span>)</span><br><span class="line">    <span class="keyword">await</span> input.<span class="title function_">trigger</span>(<span class="string">&#x27;focus&#x27;</span>)</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">emitted</span>()).<span class="title function_">toHaveProperty</span>(<span class="string">&#x27;focus&#x27;</span>)</span><br><span class="line">    <span class="comment">//  出现 Icon 区域</span></span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">find</span>(<span class="string">&#x27;.vk-input__clear&#x27;</span>).<span class="title function_">exists</span>()).<span class="title function_">toBeTruthy</span>()</span><br><span class="line">    <span class="comment">// 点击值变为空并且消失</span></span><br><span class="line">    <span class="keyword">await</span> wrapper.<span class="title function_">get</span>(<span class="string">&#x27;.vk-input__clear&#x27;</span>).<span class="title function_">trigger</span>(<span class="string">&#x27;click&#x27;</span>)</span><br><span class="line">    <span class="title function_">expect</span>(input.<span class="property">element</span>.<span class="property">value</span>).<span class="title function_">toBe</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="comment">// 点击值变为空并且消失，特别注意这里不仅仅会触发 clear 事件，对应的 input 以及 change 应该都会被触发，因为对应的值发生了变化</span></span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">emitted</span>()).<span class="title function_">toHaveProperty</span>(<span class="string">&#x27;clear&#x27;</span>)</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">emitted</span>()).<span class="title function_">toHaveProperty</span>(<span class="string">&#x27;input&#x27;</span>)</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">emitted</span>()).<span class="title function_">toHaveProperty</span>(<span class="string">&#x27;change&#x27;</span>)</span><br><span class="line">    <span class="keyword">const</span> inputEvent = wrapper.<span class="title function_">emitted</span>(<span class="string">&#x27;input&#x27;</span>)</span><br><span class="line">    <span class="keyword">const</span> changeEvent = wrapper.<span class="title function_">emitted</span>(<span class="string">&#x27;change&#x27;</span>)</span><br><span class="line">    <span class="title function_">expect</span>(inputEvent![<span class="number">0</span>]).<span class="title function_">toEqual</span>([<span class="string">&#x27;&#x27;</span>])</span><br><span class="line">    <span class="title function_">expect</span>(changeEvent![<span class="number">0</span>]).<span class="title function_">toEqual</span>([<span class="string">&#x27;&#x27;</span>])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">await</span> input.<span class="title function_">trigger</span>(<span class="string">&#x27;blur&#x27;</span>)</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">emitted</span>()).<span class="title function_">toHaveProperty</span>(<span class="string">&#x27;blur&#x27;</span>)</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>

<p><strong>实现：</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> showClear = <span class="title function_">computed</span>(<span class="function">() =&gt;</span> </span><br><span class="line">  props.<span class="property">clearable</span> &amp;&amp;</span><br><span class="line">  !props.<span class="property">disabled</span> &amp;&amp;</span><br><span class="line">  !!innerValue.<span class="property">value</span> &amp;&amp;</span><br><span class="line">  isFocus.<span class="property">value</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">handleFocus</span> = (<span class="params">event: FocusEvent</span>) =&gt; &#123;</span><br><span class="line">  isFocus.<span class="property">value</span> = <span class="literal">true</span></span><br><span class="line">  <span class="title function_">emits</span>(<span class="string">&#x27;focus&#x27;</span>, event)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">handleBlur</span> = (<span class="params">event: FocusEvent</span>) =&gt; &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;blur triggered&#x27;</span>)</span><br><span class="line">  isFocus.<span class="property">value</span> = <span class="literal">false</span></span><br><span class="line">  <span class="title function_">emits</span>(<span class="string">&#x27;blur&#x27;</span>, event)</span><br><span class="line">  <span class="title function_">runValidation</span>(<span class="string">&#x27;blur&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">clear</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;clear triggered&#x27;</span>)</span><br><span class="line">  innerValue.<span class="property">value</span> = <span class="string">&#x27;&#x27;</span></span><br><span class="line">  <span class="title function_">emits</span>(<span class="string">&#x27;update:modelValue&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">  <span class="title function_">emits</span>(<span class="string">&#x27;clear&#x27;</span>)</span><br><span class="line">  <span class="title function_">emits</span>(<span class="string">&#x27;input&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">  <span class="title function_">emits</span>(<span class="string">&#x27;change&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>清空按钮的显示和隐藏通过 <code>showClear</code> 计算属性进行控制，只有在输入框有值且获得焦点时才显示。点击清空按钮时，会调用 <code>clear</code> 方法，将 <code>innerValue</code> 的值设置为空字符串，并通过 <code>emits</code> 函数触发 <code>update:modelValue</code>、<code>clear</code>、<code>input</code> 和 <code>change</code> 事件，通知外部组件输入框的值发生了变化。</p>
<h4 id="5-支持密码切换的测试用例和实现"><a href="#5-支持密码切换的测试用例和实现" class="headerlink" title="5.支持密码切换的测试用例和实现"></a>5.支持密码切换的测试用例和实现</h4><p><strong>测试用例:</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">it</span>(<span class="string">&#x27;支持切换密码显示&#x27;</span>, <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> wrapper = <span class="title function_">mount</span>(<span class="title class_">Input</span>, &#123;</span><br><span class="line">      <span class="attr">props</span>: &#123;</span><br><span class="line">        <span class="attr">modelValue</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="attr">showPassword</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&#x27;text&#x27;</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">global</span>: &#123;</span><br><span class="line">        <span class="attr">stubs</span>: [<span class="string">&#x27;Icon&#x27;</span>]</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">// 不出现对应的 Icon 区域, 因为当前值为空</span></span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">find</span>(<span class="string">&#x27;.vk-input__password&#x27;</span>).<span class="title function_">exists</span>()).<span class="title function_">toBeFalsy</span>()</span><br><span class="line">    <span class="keyword">const</span> input = wrapper.<span class="title function_">get</span>(<span class="string">&#x27;input&#x27;</span>)</span><br><span class="line">    <span class="title function_">expect</span>(input.<span class="property">element</span>.<span class="property">type</span>).<span class="title function_">toBe</span>(<span class="string">&#x27;password&#x27;</span>)</span><br><span class="line">    <span class="comment">//  出现 Icon 区域，并且 Icon 为特点的图标</span></span><br><span class="line">    <span class="keyword">await</span> input.<span class="title function_">setValue</span>(<span class="string">&#x27;123&#x27;</span>)</span><br><span class="line">    <span class="keyword">const</span> eyeIcon = wrapper.<span class="title function_">find</span>(<span class="string">&#x27;.vk-input__password&#x27;</span>)</span><br><span class="line">    <span class="title function_">expect</span>(eyeIcon.<span class="title function_">exists</span>()).<span class="title function_">toBeTruthy</span>()</span><br><span class="line">    <span class="title function_">expect</span>(eyeIcon.<span class="title function_">attributes</span>(<span class="string">&#x27;icon&#x27;</span>)).<span class="title function_">toBe</span>(<span class="string">&#x27;eye-slash&#x27;</span>)</span><br><span class="line">    <span class="comment">// 点击值变会切换input 类型，并且图标的 Icon 会切换</span></span><br><span class="line">    <span class="keyword">await</span> eyeIcon.<span class="title function_">trigger</span>(<span class="string">&#x27;click&#x27;</span>)</span><br><span class="line">    <span class="title function_">expect</span>(input.<span class="property">element</span>.<span class="property">type</span>).<span class="title function_">toBe</span>(<span class="string">&#x27;text&#x27;</span>)</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">find</span>(<span class="string">&#x27;.vk-input__password&#x27;</span>).<span class="title function_">attributes</span>(<span class="string">&#x27;icon&#x27;</span>)).<span class="title function_">toBe</span>(<span class="string">&#x27;eye&#x27;</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><strong>实现：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;Icon </span><br><span class="line">         icon=&quot;eye&quot;</span><br><span class="line">         v-if=&quot;showPasswordArea &amp;&amp; passwordVisible&quot;</span><br><span class="line">         class=&quot;vk-input__password&quot;</span><br><span class="line">         @click=&quot;togglePasswordVisible&quot;</span><br><span class="line">       /&gt;</span><br><span class="line">       &lt;Icon </span><br><span class="line">         icon=&quot;eye-slash&quot;</span><br><span class="line">         v-if=&quot;showPasswordArea &amp;&amp; !passwordVisible&quot;</span><br><span class="line">         class=&quot;vk-input__password&quot;</span><br><span class="line">         @click=&quot;togglePasswordVisible&quot;</span><br><span class="line">       /&gt;</span><br></pre></td></tr></table></figure>



<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> passwordVisible = <span class="title function_">ref</span>(<span class="literal">false</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> showPasswordArea = <span class="title function_">computed</span>(<span class="function">() =&gt;</span> </span><br><span class="line">  props.<span class="property">showPassword</span> &amp;&amp;</span><br><span class="line">  !props.<span class="property">disabled</span> &amp;&amp;</span><br><span class="line">  !!innerValue.<span class="property">value</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">togglePasswordVisible</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  passwordVisible.<span class="property">value</span> = !passwordVisible.<span class="property">value</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">NOOP</span> = (<span class="params"></span>) =&gt; &#123;&#125;</span><br></pre></td></tr></table></figure>



<ol>
<li><strong>密码切换功能的展示</strong>：在模板中，通过 <code>v-if</code> 指令判断是否显示密码切换按钮。当满足条件时，分别显示“显示密码”和“隐藏密码”的图标按钮。</li>
<li><strong>点击图标触发切换密码可见性</strong>：使用 <code>@click</code> 事件监听器，当点击密码切换按钮时，调用 <code>togglePasswordVisible</code> 方法切换密码可见性。在该方法中，通过改变 <code>passwordVisible</code> 的值来控制密码是否可见。</li>
<li><strong><code>togglePasswordVisible</code> 方法</strong>：该方法用于切换密码的可见性。如果密码是可见的，则将 <code>passwordVisible</code> 的值设置为 <code>false</code>，否则设置为 <code>true</code>，以实现密码的显示和隐藏。</li>
<li><strong>使用 <code>computed</code> 计算属性控制密码切换按钮的显示</strong>：在模板中使用 <code>v-if</code> 条件渲染判断密码切换按钮是否显示。其中，<code>showPasswordArea</code> 计算属性控制密码切换按钮的显示逻辑，只有在组件启用密码显示功能、未禁用且输入框有值时才显示密码切换按钮。</li>
</ol>
<h4 id="6-支持事件"><a href="#6-支持事件" class="headerlink" title="6.支持事件"></a>6.支持事件</h4><ol>
<li><p>渲染输入框或文本域以及相关的附加元素（如前缀、后缀、清除按钮等）。</p>
</li>
<li><p>监听用户输入事件，更新输入框的值，并通过 <code>v-model</code> 传递给父组件。</p>
</li>
<li><p>监听输入框的 <code>focus</code> 和 <code>blur</code> 事件，通过 <code>emits</code> 函数触发相应的自定义事件，并执行验证逻辑。</p>
</li>
<li><p>提供清除输入框内容的功能，并通过 <code>emits</code> 函数触发相应的自定义事件。</p>
</li>
</ol>
<h4 id="7-组件添加原生事件"><a href="#7-组件添加原生事件" class="headerlink" title="7.组件添加原生事件"></a>7.组件添加原生事件</h4><p>分析出来需要添加的原生属性</p>
<ul>
<li>disabled(已经添加）</li>
<li>placeholder-当没有值设定时，出现在表单控件上的文字</li>
<li>readonly-布尔值。如果存在，其中的值将不可编辑</li>
<li>autocomplete·表单自动填充特性提示。（不是一个布尔属性！）</li>
<li>autofocus:一个布尔属性，如果存在，表示当页面加载完毕（或包含该元素的<dia1og>显示完毕）</dia1og></li>
</ul>
<h3 id="3-Input总结"><a href="#3-Input总结" class="headerlink" title="(3) Input总结"></a>(3) Input总结</h3><p>Input组件开发是一个关键的时间点。</p>
<p>接触了TDD(Test Driven Development)的开发方式。</p>
<p><strong>温故而知新的知识点：</strong></p>
<ul>
<li>v-model 测试方式</li>
<li>Vue 组件事件的测试方式</li>
<li>设置表单组件：要特别注意对于它包含的内部组件原生属性的一些支持</li>
</ul>
<p><strong>TDD开发方式的一些小问题：</strong></p>
<p>在大部分的情况下，它能很好的进行运作，但是由于 jsdom 使用的是模拟的DOM环境，会和浏览器的真实环境有一些或多或少的差别，在一些小功能上可能会出现问题。</p>
<p>对于TDD的使用，要按照自己的喜欢和完成的特性和功能进行选择，没有一个确定的答案。</p>
<h2 id="13-Switch组件"><a href="#13-Switch组件" class="headerlink" title="13.Switch组件"></a>13.Switch组件</h2><h3 id="1-需求分析-8"><a href="#1-需求分析-8" class="headerlink" title="(1) 需求分析"></a>(1) 需求分析</h3><p>Switch,并不是一个标准Form组件，而是被手机端的一种交互发扬光大的一种结构。</p>
<h4 id="不同寻常"><a href="#不同寻常" class="headerlink" title="不同寻常"></a>不同寻常</h4><p><strong>Switch的不同寻常的要点</strong></p>
<p>功能类似checkbox,所以内部有可能是一个checkbox在工作，狸猫换太子。</p>
<p>样式非常独特，是我们面对面对样式最大的一个挑战。</p>
<h4 id="属性-3"><a href="#属性-3" class="headerlink" title="属性"></a>属性</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">interface <span class="title class_">SwtichProps</span> &#123;</span><br><span class="line"><span class="attr">modelValue</span>:boolean;</span><br><span class="line">disabled?:boolean;</span><br><span class="line">activeText?:string;</span><br><span class="line">inactiveText?:string;</span><br><span class="line">name?:string;</span><br><span class="line">id?:string;</span><br><span class="line">size?:<span class="string">&#x27;small&#x27;</span>|<span class="string">&#x27;large&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//有可能可以扩展的点</span></span><br><span class="line"><span class="comment">//modelValue的类型，不仅仅是boolean,还可以支持特更多的基本类型，比如string以及number</span></span><br></pre></td></tr></table></figure>

<h4 id="事件-3"><a href="#事件-3" class="headerlink" title="事件"></a>事件</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">interface <span class="title class_">SwitchEvents</span> &#123;</span><br><span class="line">(<span class="attr">e</span>:<span class="string">&#x27;change&#x27;</span>,<span class="attr">value</span>:boolean):<span class="keyword">void</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="2-代码编写-7"><a href="#2-代码编写-7" class="headerlink" title="(2) 代码编写"></a>(2) 代码编写</h3><h4 id="1-组件样式设计"><a href="#1-组件样式设计" class="headerlink" title="1.组件样式设计"></a>1.组件样式设计</h4><p><img src="/../images/Vue3_%E5%B0%81%E8%A3%85%E7%BB%84%E4%BB%B6%E5%BA%93%E9%A1%B9%E7%9B%AE/50.png"></p>
<h4 id="2-样式编写"><a href="#2-样式编写" class="headerlink" title="2.样式编写"></a>2.样式编写</h4><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.vk-switch</span> &#123;</span><br><span class="line">  <span class="attr">--vk-switch-on-color</span>: <span class="built_in">var</span>(--vk-color-primary);</span><br><span class="line">  <span class="attr">--vk-switch-off-color</span>: <span class="built_in">var</span>(--vk-border-color);</span><br><span class="line">  <span class="attr">--vk-switch-on-border-color</span>: <span class="built_in">var</span>(--vk-color-primary);</span><br><span class="line">  <span class="attr">--vk-switch-off-border-color</span>: <span class="built_in">var</span>(--vk-border-color);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.vk-switch</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: inline-flex;</span><br><span class="line">  <span class="attribute">align-items</span>: center;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">14px</span>;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">32px</span>;</span><br><span class="line">  <span class="selector-class">.vk-swtich__input</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">    &amp;<span class="selector-pseudo">:focus</span>-visible &#123;</span><br><span class="line">      &amp; ~ <span class="selector-class">.vk-switch__core</span> &#123;</span><br><span class="line">        <span class="attribute">outline</span>: <span class="number">2px</span> solid <span class="built_in">var</span>(--vk-switch-on-color);</span><br><span class="line">        <span class="attribute">outline-offset</span>: <span class="number">1px</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  &amp;<span class="selector-class">.is-disabled</span> &#123;</span><br><span class="line">    <span class="attribute">opacity</span>: .<span class="number">6</span>;</span><br><span class="line">    <span class="selector-class">.vk-switch__core</span> &#123;</span><br><span class="line">      <span class="attribute">cursor</span>: not-allowed;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  &amp;<span class="selector-class">.is-checked</span> &#123;</span><br><span class="line">    <span class="selector-class">.vk-switch__core</span> &#123;</span><br><span class="line">      <span class="attribute">border-color</span>:<span class="built_in">var</span>(--vk-switch-on-border-color);</span><br><span class="line">      <span class="attribute">background-color</span>: <span class="built_in">var</span>(--vk-switch-on-color);</span><br><span class="line">      <span class="selector-class">.vk-switch__core-action</span> &#123;</span><br><span class="line">        <span class="attribute">left</span>: <span class="built_in">calc</span>(<span class="number">100%</span> - <span class="number">17px</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="selector-class">.vk-switch__core-inner</span> &#123;</span><br><span class="line">        <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">18px</span> <span class="number">0</span> <span class="number">4px</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.vk-switch--large</span> &#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">14px</span>;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">24px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">40px</span>;</span><br><span class="line">  <span class="selector-class">.vk-switch__core</span> &#123;</span><br><span class="line">    <span class="attribute">min-width</span>: <span class="number">50px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">24px</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">12px</span>;</span><br><span class="line">    <span class="selector-class">.vk-switch__core-action</span> &#123;</span><br><span class="line">      <span class="attribute">width</span>: <span class="number">20px</span>;</span><br><span class="line">      <span class="attribute">height</span>: <span class="number">20px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  &amp;<span class="selector-class">.is-checked</span> &#123;</span><br><span class="line">    <span class="selector-class">.vk-switch__core</span> <span class="selector-class">.vk-switch__core-action</span> &#123;</span><br><span class="line">      <span class="attribute">left</span>: <span class="built_in">calc</span>(<span class="number">100%</span> - <span class="number">21px</span>);</span><br><span class="line">      <span class="attribute">color</span>: <span class="built_in">var</span>(--vk-switch-on-color);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.vk-switch--small</span> &#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">12px</span>;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">16px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">24px</span>;</span><br><span class="line">  <span class="selector-class">.vk-switch__core</span> &#123;</span><br><span class="line">    <span class="attribute">min-width</span>: <span class="number">30px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">16px</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">8px</span>;</span><br><span class="line">    <span class="selector-class">.vk-switch__core-action</span> &#123;</span><br><span class="line">      <span class="attribute">width</span>: <span class="number">12px</span>;</span><br><span class="line">      <span class="attribute">height</span>: <span class="number">12px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  &amp;<span class="selector-class">.is-checked</span> &#123;</span><br><span class="line">    <span class="selector-class">.vk-switch__core</span> <span class="selector-class">.vk-switch-core-action</span> &#123;</span><br><span class="line">      <span class="attribute">left</span>: <span class="built_in">calc</span>(<span class="number">100%</span> - <span class="number">13px</span>);</span><br><span class="line">      <span class="attribute">color</span>: <span class="built_in">var</span>(--vk-switch-on-color);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.vk-switch__core</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: inline-flex;</span><br><span class="line">  <span class="attribute">align-items</span>: center;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">min-width</span>: <span class="number">40px</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="built_in">var</span>(--vk-switch-off-border-color);</span><br><span class="line">  <span class="attribute">outline</span>: none;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">var</span>(--vk-switch-off-color);</span><br><span class="line">  <span class="attribute">cursor</span>: pointer;</span><br><span class="line">  <span class="attribute">transition</span>: border-color <span class="built_in">var</span>(--vk-transition-duration),background-color <span class="built_in">var</span>(--vk-transition-duration);</span><br><span class="line">  <span class="selector-class">.vk-switch__core-action</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">1px</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="built_in">var</span>(--vk-border-radius-circle);</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">16px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">16px</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="built_in">var</span>(--vk-color-white);</span><br><span class="line">    <span class="attribute">transition</span>: all <span class="built_in">var</span>(--vk-transition-duration);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.vk-switch__core-inner</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">transition</span>: all <span class="built_in">var</span>(--vk-transition-duration);</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">16px</span>;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">justify-content</span>: center;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">4px</span> <span class="number">0</span> <span class="number">18px</span>;</span><br><span class="line">    <span class="selector-class">.vk-switch__core-inner-text</span> &#123;</span><br><span class="line">      <span class="attribute">font-size</span>: <span class="number">12px</span>;</span><br><span class="line">      <span class="attribute">color</span>: <span class="built_in">var</span>(--vk-color-white);</span><br><span class="line">      user-select: none;</span><br><span class="line">      <span class="attribute">overflow</span>: hidden;</span><br><span class="line">      <span class="attribute">text-overflow</span>: ellipsis;</span><br><span class="line">      <span class="attribute">white-space</span>: nowrap;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3-支持v-model"><a href="#3-支持v-model" class="headerlink" title="3.支持v-model"></a>3.支持v-model</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">switchValue</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (props.<span class="property">disabled</span>) <span class="keyword">return</span></span><br><span class="line">  <span class="keyword">const</span> newValue = checked.<span class="property">value</span> ? props.<span class="property">inactiveValue</span> : props.<span class="property">activeValue</span></span><br><span class="line">  innerValue.<span class="property">value</span> = newValue</span><br><span class="line">  <span class="title function_">emits</span>(<span class="string">&#x27;update:modelValue&#x27;</span>, newValue)</span><br><span class="line">  <span class="title function_">emits</span>(<span class="string">&#x27;change&#x27;</span>, newValue)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="4-支持自定义value类型"><a href="#4-支持自定义value类型" class="headerlink" title="4.支持自定义value类型"></a>4.支持自定义value类型</h4><p>通过以下步骤实现:</p>
<ol>
<li><strong>props 的定义</strong>：在 <code>props</code> 中定义了 <code>activeValue</code> 和 <code>inactiveValue</code>，它们分别表示开关的激活状态和非激活状态下的值。这使得开关可以接受任意类型的值作为其状态。</li>
<li><strong>computed 的使用</strong>：通过计算属性 <code>checked</code> 来确定当前开关是否处于激活状态。在这个计算属性中，使用了 <code>innerValue</code> 和 <code>activeValue</code> 来判断当前值是否等于激活状态的值。</li>
<li><strong>switchValue 函数的实现</strong>：在 <code>switchValue</code> 函数中，根据当前开关的状态，通过判断 <code>checked</code> 的值来确定下一个状态应该是什么值。这个逻辑不再仅限于布尔类型的切换，而是根据 <code>activeValue</code> 和 <code>inactiveValue</code> 的定义来切换值。</li>
<li><strong>事件的触发</strong>：在 <code>switchValue</code> 函数中，除了触发 <code>update:modelValue</code> 和 <code>change</code> 事件外，还将下一个值作为参数传递给这些事件。这样做可以保证外部的 <code>v-model</code> 在更新时能够得到正确的值。</li>
</ol>
<h4 id="5-支持文字描述"><a href="#5-支持文字描述" class="headerlink" title="5.支持文字描述"></a>5.支持文字描述</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 如果activeText或inactiveText存在，则显示对应的开关文字 --&gt;</span><br><span class="line">&lt;span v-if=&quot;activeText || inactiveText&quot; class=&quot;vk-switch__core-inner-text&quot;&gt;</span><br><span class="line">  &#123;&#123;checked ? activeText : inactiveText&#125;&#125;</span><br><span class="line">&lt;/span&gt;</span><br></pre></td></tr></table></figure>



<h4 id="6-支持无障碍"><a href="#6-支持无障碍" class="headerlink" title="6.支持无障碍"></a>6.支持无障碍</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;input </span><br><span class="line">  class=&quot;vk-switch__input&quot;</span><br><span class="line">  type=&quot;checkbox&quot;</span><br><span class="line">  role=&quot;switch&quot;</span><br><span class="line">  ref=&quot;input&quot;</span><br><span class="line">  :name=&quot;name&quot;</span><br><span class="line">  :disabled=&quot;disabled&quot;</span><br><span class="line">  :aria-checked=&quot;checked&quot;</span><br><span class="line">  @keydown.enter=&quot;switchValue&quot;</span><br><span class="line">/&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ol>
<li><strong>提供键盘操作支持</strong>：在 <code>&lt;input&gt;</code> 元素上监听键盘事件，例如 <code>keydown.enter</code>，以便用户可以通过键盘切换开关状态。</li>
<li><strong>确保焦点可见性</strong>：在用户与开关交互时，确保开关的焦点是可见的，并且具有适当的焦点样式。这可以通过 CSS 或者 JavaScript 来实现。</li>
</ol>
<h3 id="3-Switch-总结"><a href="#3-Switch-总结" class="headerlink" title="(3) Switch 总结"></a>(3) Switch 总结</h3><p>Switch组件，分析出了和它很相似的应该是checkbox,所以它是个内部包裹着checkbox,用DOM模拟对应的外貌的组件。<br>新的知识点：</p>
<ul>
<li>学习写复制CSS样式的方式</li>
<li>表单组件设计要特别注意和原生表单元素的配合，实现比较完美的可访问性。</li>
</ul>
<h2 id="14-Select-组件"><a href="#14-Select-组件" class="headerlink" title="14.Select 组件"></a>14.Select 组件</h2><h3 id="1-需求分析-9"><a href="#1-需求分析-9" class="headerlink" title="(1) 需求分析"></a>(1) 需求分析</h3><p>类似原生的Select,不过有着更强大的功能。</p>
<p><strong>最基本功能：</strong></p>
<ul>
<li>​	点击展开下拉选项菜单</li>
<li>​	点击菜单中的某一项，下拉菜单关闭</li>
<li>​	Select获取选中状态，并且填充对应的选项。</li>
</ul>
<p><strong>组件本质：</strong>进阶版本的Dropdown,Input组件和Tooltip组件的组合</p>
<p><strong>高级功能：</strong></p>
<ul>
<li>可清空选项：当Hovr的时候，在组件右侧显示一个可清空的按钮，点击以后清空选中的值。</li>
<li>自定义模版：可以自定义，下拉菜单的选项的格式。</li>
<li>可筛选选项:	Input允许输入，输入后可以根据输入字符自动过滤下拉菜单的选项。</li>
<li>支持远程搜索（难点）：类似自动联想，可以根据输入的字符发送请求，渲染返回的内容作为选项列表</li>
<li>扩展支持：比如键盘移动</li>
</ul>
<h4 id="结构分析"><a href="#结构分析" class="headerlink" title="结构分析"></a>结构分析</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="title class_">Select</span></span><br><span class="line">placeholder=<span class="string">&quot;select&quot;</span></span><br><span class="line">:options=<span class="string">&quot;options&quot;</span></span><br><span class="line">v-model=<span class="string">&quot;selectvalue&quot;</span></span><br><span class="line">/&gt;</span><br><span class="line"><span class="keyword">const</span> options2 = [</span><br><span class="line"><span class="attr">label</span>:<span class="string">&#x27;hello&#x27;</span>,<span class="attr">value</span>:<span class="number">1</span> &#125;</span><br><span class="line"><span class="attr">label</span>:<span class="string">&#x27;xyz&#x27;</span>,<span class="attr">value</span>:<span class="number">2</span> &#125;</span><br><span class="line"><span class="attr">label</span>:<span class="string">&#x27;testing&#x27;</span>,<span class="attr">value</span>:<span class="number">3</span> )</span><br><span class="line"><span class="attr">label</span>:<span class="string">&#x27;check&#x27;</span>,<span class="attr">value</span>:<span class="number">4</span>&#125;</span><br><span class="line">]</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h4 id="属性-4"><a href="#属性-4" class="headerlink" title="属性"></a>属性</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">interface <span class="title class_">SelectProps</span> &#123;</span><br><span class="line"><span class="comment">//v-model</span></span><br><span class="line"><span class="attr">modelValue</span>:string;</span><br><span class="line"><span class="comment">//选项</span></span><br><span class="line"><span class="attr">options</span>:<span class="title class_">Selectoption</span>;</span><br><span class="line"><span class="comment">//一些基本表单属性</span></span><br><span class="line"><span class="attr">placeholder</span>:string;</span><br><span class="line"><span class="attr">disabled</span>:boolean;</span><br><span class="line"><span class="comment">//可清空</span></span><br><span class="line"><span class="attr">clearable</span>:boolean;</span><br><span class="line"><span class="comment">//自定义菜单</span></span><br><span class="line"><span class="attr">renderLabel</span>:<span class="function">(<span class="params">option:SelectOption</span>)=&gt;</span><span class="title class_">VNode</span>;</span><br><span class="line"><span class="comment">//可筛选</span></span><br><span class="line"><span class="attr">filterable</span>:boolean;</span><br><span class="line"><span class="comment">//远程搜索</span></span><br><span class="line"><span class="attr">remoteMethod</span>:<span class="function">(<span class="params">value:any</span>) =&gt;</span> <span class="title class_">Promise</span>&lt;<span class="title class_">SelectOption</span>[]&gt;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="comment">//选项属性</span></span><br><span class="line"><span class="keyword">export</span> interface <span class="title class_">Selectoption</span> &#123;</span><br><span class="line"><span class="attr">label</span>:string;</span><br><span class="line"><span class="attr">value</span>:string | number;</span><br><span class="line">disabled?:boolean;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="事件-4"><a href="#事件-4" class="headerlink" title="事件"></a>事件</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">interface <span class="title class_">SelectEmits</span>&#123;</span><br><span class="line">(<span class="attr">e</span>:<span class="string">&#x27;change&#x27;</span>,<span class="attr">value</span>:string):<span class="keyword">void</span>;</span><br><span class="line">(<span class="attr">e</span>:<span class="string">&#x27;update:modelvalue&#x27;</span>,<span class="attr">value</span>:string):<span class="keyword">void</span>;</span><br><span class="line">(<span class="attr">e</span>:<span class="string">&#x27;clear&#x27;</span>):<span class="keyword">void</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="2-代码编写-8"><a href="#2-代码编写-8" class="headerlink" title="(2) 代码编写"></a>(2) 代码编写</h3><h4 id="1-基本结构"><a href="#1-基本结构" class="headerlink" title="1.基本结构"></a>1.基本结构</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">&lt;div</span><br><span class="line">  class=&quot;vk-select&quot;</span><br><span class="line">  :class=&quot;&#123;&#x27;is-disabled&#x27;: disabled &#125;&quot;</span><br><span class="line">  @click=&quot;toggleDropdown&quot;</span><br><span class="line">  @mouseenter=&quot;states.mouseHover = true&quot;</span><br><span class="line">  @mouseleave=&quot;states.mouseHover = false&quot;</span><br><span class="line">&gt;</span><br><span class="line">  &lt;Tooltip</span><br><span class="line">    placement=&quot;bottom-start&quot;</span><br><span class="line">    ref=&quot;tooltipRef&quot;</span><br><span class="line">    :popperOptions=&quot;popperOptions&quot;</span><br><span class="line">    @click-outside=&quot;controlDropdown(false)&quot;</span><br><span class="line">    manual</span><br><span class="line">  &gt;</span><br><span class="line">    &lt;Input </span><br><span class="line">      v-model=&quot;states.inputValue&quot;</span><br><span class="line">      :disabled=&quot;disabled&quot;</span><br><span class="line">      :placeholder=&quot;filteredPlaceholder&quot;</span><br><span class="line">      ref=&quot;inputRef&quot;</span><br><span class="line">      :readonly=&quot;!filterable || !isDropdownShow&quot;</span><br><span class="line">      @input=&quot;debouceOnFilter&quot;</span><br><span class="line">      @keydown=&quot;handleKeydown&quot;</span><br><span class="line">    &gt;</span><br><span class="line">      &lt;template #suffix&gt;</span><br><span class="line">        &lt;Icon </span><br><span class="line">          icon=&quot;circle-xmark&quot;</span><br><span class="line">          v-if=&quot;showClearIcon&quot;</span><br><span class="line">          class=&quot;vk-input__clear&quot;</span><br><span class="line">          @mousedown.prevent=&quot;NOOP&quot;</span><br><span class="line">          @click.stop=&quot;onClear&quot;  </span><br><span class="line">        /&gt;</span><br><span class="line"></span><br><span class="line">        &lt;Icon</span><br><span class="line">          v-else</span><br><span class="line">          icon=&quot;angle-down&quot; </span><br><span class="line">          class=&quot;header-angle&quot; </span><br><span class="line">          :class=&quot;&#123; &#x27;is-active&#x27;: isDropdownShow &#125;&quot;</span><br><span class="line">        /&gt;</span><br><span class="line">      &lt;/template&gt;</span><br><span class="line">    &lt;/Input&gt;</span><br><span class="line">    &lt;template #content&gt;</span><br><span class="line">      &lt;div class=&quot;vk-select__loading&quot; v-if=&quot;states.loading&quot;&gt;&lt;Icon icon=&quot;spinner&quot; spin/&gt;&lt;/div&gt;</span><br><span class="line">      &lt;div class=&quot;vk-select__nodata&quot; v-else-if=&quot;filterable &amp;&amp; filteredOptions.length === 0&quot;&gt;no matching data&lt;/div&gt;</span><br><span class="line">      &lt;ul class=&quot;vk-select__menu&quot; v-else&gt;</span><br><span class="line">        &lt;template v-for=&quot;(item, index) in filteredOptions&quot; :key=&quot;index&quot;&gt;</span><br><span class="line">          &lt;li </span><br><span class="line">            class=&quot;vk-select__menu-item&quot;</span><br><span class="line">            :class=&quot;&#123;</span><br><span class="line">              &#x27;is-disabled&#x27;: item.disabled, </span><br><span class="line">              &#x27;is-selected&#x27;: states.selectedOption?.value === item.value ,</span><br><span class="line">              &#x27;is-highlighted&#x27;: states.highlightIndex === index</span><br><span class="line">            &#125;&quot;</span><br><span class="line">            :id=&quot;`select-item-$&#123;item.value&#125;`&quot;</span><br><span class="line">            @click.stop=&quot;itemSelect(item)&quot;</span><br><span class="line">          &gt;</span><br><span class="line">            &lt;RenderVnode :vNode=&quot;renderLabel ? renderLabel(item) : item.label&quot;/&gt;</span><br><span class="line">          &lt;/li&gt;</span><br><span class="line">        &lt;/template&gt;</span><br><span class="line">      &lt;/ul&gt;</span><br><span class="line">    &lt;/template&gt;</span><br><span class="line">  &lt;/Tooltip&gt;</span><br><span class="line">&lt;/div&gt;  </span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<h4 id="2-选中选项功能"><a href="#2-选中选项功能" class="headerlink" title="2.选中选项功能"></a>2.选中选项功能</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">findOption</span> = (<span class="params">value: string</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> option = props.<span class="property">options</span>.<span class="title function_">find</span>(<span class="function"><span class="params">option</span> =&gt;</span> option.<span class="property">value</span> === value)</span><br><span class="line">  <span class="keyword">return</span> option ? option : <span class="literal">null</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> initialOption = <span class="title function_">findOption</span>(props.<span class="property">modelValue</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">itemSelect</span> = (<span class="params">e: SelectOption</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (e.<span class="property">disabled</span>) <span class="keyword">return</span></span><br><span class="line">  states.<span class="property">inputValue</span> = e.<span class="property">label</span></span><br><span class="line">  states.<span class="property">selectedOption</span> = e</span><br><span class="line">  <span class="title function_">emits</span>(<span class="string">&#x27;change&#x27;</span>, e.<span class="property">value</span>)</span><br><span class="line">  <span class="title function_">emits</span>(<span class="string">&#x27;update:modelValue&#x27;</span>, e.<span class="property">value</span>)</span><br><span class="line">  <span class="title function_">controlDropdown</span>(<span class="literal">false</span>)</span><br><span class="line">  inputRef.<span class="property">value</span>.<span class="property">ref</span>.<span class="title function_">focus</span>()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="3-初步样式编写"><a href="#3-初步样式编写" class="headerlink" title="3.初步样式编写"></a>3.初步样式编写</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="attr">popperOptions</span>: any = &#123;</span><br><span class="line">  <span class="attr">modifiers</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;offset&#x27;</span>,</span><br><span class="line">      <span class="attr">options</span>: &#123;</span><br><span class="line">        <span class="attr">offset</span>: [<span class="number">0</span>, <span class="number">9</span>],</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&quot;sameWidth&quot;</span>,</span><br><span class="line">      <span class="attr">enabled</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">fn</span>: <span class="function">(<span class="params">&#123; state &#125;: &#123; state: any &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">          state.<span class="property">styles</span>.<span class="property">popper</span>.<span class="property">width</span> = <span class="string">`<span class="subst">$&#123;state.rects.reference.width&#125;</span>px`</span>;</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">phase</span>: <span class="string">&quot;beforeWrite&quot;</span>,</span><br><span class="line">      <span class="attr">requires</span>: [<span class="string">&quot;computeStyles&quot;</span>],</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.vk-select</span> &#123;</span><br><span class="line">  <span class="attr">--vk-select-item-hover-bg-color</span>: <span class="built_in">var</span>(--vk-fill-color-light);</span><br><span class="line">  <span class="attr">--vk-select-item-font-size</span>: <span class="built_in">var</span>(--vk-font-size-base);</span><br><span class="line">  <span class="attr">--vk-select-item-font-color</span>: <span class="built_in">var</span>(--vk-text-color-regular);</span><br><span class="line">  <span class="attr">--vk-select-item-selected-font-color</span>: <span class="built_in">var</span>(--vk-color-primary);</span><br><span class="line">  <span class="attr">--vk-select-item-disabled-font-color</span>: <span class="built_in">var</span>(--vk-text-color-placeholder);</span><br><span class="line">  <span class="attr">--vk-select-input-focus-border-color</span>: <span class="built_in">var</span>(--vk-color-primary);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.vk-select</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: inline-block;</span><br><span class="line">  <span class="attribute">vertical-align</span>: middle;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">32px</span>;</span><br><span class="line">  <span class="selector-class">.vk-tooltip</span> <span class="selector-class">.vk-tooltip__popper</span> &#123;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.vk-input</span><span class="selector-class">.is-focus</span> <span class="selector-class">.vk-input__wrapper</span> &#123;</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1px</span> <span class="built_in">var</span>(--vk-select-input-focus-border-color) inset<span class="meta">!important</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.vk-input</span> &#123;</span><br><span class="line">    <span class="selector-class">.header-angle</span> &#123;</span><br><span class="line">      <span class="attribute">transition</span>: transform <span class="built_in">var</span>(--vk-transition-duration);</span><br><span class="line">      &amp;<span class="selector-class">.is-active</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">180deg</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.vk-input__inner</span> &#123;</span><br><span class="line">    <span class="attribute">cursor</span>: pointer;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.vk-select__nodata</span>, <span class="selector-class">.vk-select__loading</span> &#123;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">10px</span> <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">text-align</span>: center;</span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">var</span>(--vk-text-color-secondary);</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="built_in">var</span>(--vk-select-font-size);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.vk-select__menu</span> &#123;</span><br><span class="line">    <span class="attribute">list-style</span>: none;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">6px</span> <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.vk-select__menu-item</span> &#123; </span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="built_in">var</span>(--vk-select-item-font-size);</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">32px</span> <span class="number">0</span> <span class="number">20px</span>;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">white-space</span>: nowrap;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">text-overflow</span>: ellipsis;</span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">var</span>(--vk-select-item-font-color);</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">34px</span>;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">34px</span>;</span><br><span class="line">    <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">    <span class="attribute">cursor</span>: pointer;</span><br><span class="line">    &amp;<span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">      <span class="attribute">background-color</span>: <span class="built_in">var</span>(--vk-select-item-hover-bg-color);</span><br><span class="line">    &#125;</span><br><span class="line">    &amp;<span class="selector-class">.is-selected</span> &#123;</span><br><span class="line">      <span class="attribute">color</span>: <span class="built_in">var</span>(--vk-select-item-selected-font-color);</span><br><span class="line">      <span class="attribute">font-weight</span>: <span class="number">700</span>;    </span><br><span class="line">    &#125;</span><br><span class="line">    &amp;<span class="selector-class">.is-highlighted</span> &#123;</span><br><span class="line">      <span class="attribute">background-color</span>: <span class="built_in">var</span>(--vk-select-item-hover-bg-color);</span><br><span class="line">    &#125;</span><br><span class="line">    &amp;<span class="selector-class">.is-disabled</span> &#123;</span><br><span class="line">      <span class="attribute">color</span>: <span class="built_in">var</span>(--vk-select-item-disabled-font-color);</span><br><span class="line">      <span class="attribute">cursor</span>: not-allowed;</span><br><span class="line">      &amp;<span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">        <span class="attribute">background-color</span>: transparent;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="4-添加箭头图标"><a href="#4-添加箭头图标" class="headerlink" title="4.添加箭头图标"></a>4.添加箭头图标</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;template #suffix&gt;</span><br><span class="line">        &lt;Icon</span><br><span class="line">          v-else</span><br><span class="line">          icon=&quot;angle-down&quot; </span><br><span class="line">          class=&quot;header-angle&quot; </span><br><span class="line">          :class=&quot;&#123; &#x27;is-active&#x27;: isDropdownShow &#125;&quot;</span><br><span class="line">        /&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.vk-input</span> &#123;</span><br><span class="line">  <span class="selector-class">.header-angle</span> &#123;</span><br><span class="line">    <span class="attribute">transition</span>: transform <span class="built_in">var</span>(--vk-transition-duration);</span><br><span class="line">    &amp;<span class="selector-class">.is-active</span> &#123;</span><br><span class="line">      <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">180deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="5-支持清空"><a href="#5-支持清空" class="headerlink" title="5.支持清空"></a>5.支持清空</h4><p>可清空选项：当Hover的时候，在组件右侧显示一个可清空的按钮，点击以后清空选中的值</p>
<p>两种思路:</p>
<ul>
<li>完全复用input组件的clear功能</li>
<li>不复用，重新写</li>
</ul>
<p>这里选择第二个思路</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//模板</span></span><br><span class="line">        &lt;<span class="title class_">Icon</span> </span><br><span class="line">          icon=<span class="string">&quot;circle-xmark&quot;</span></span><br><span class="line">          v-<span class="keyword">if</span>=<span class="string">&quot;showClearIcon&quot;</span></span><br><span class="line">          <span class="keyword">class</span>=<span class="string">&quot;vk-input__clear&quot;</span></span><br><span class="line">          @mousedown.<span class="property">prevent</span>=<span class="string">&quot;NOOP&quot;</span></span><br><span class="line">          @click.<span class="property">stop</span>=<span class="string">&quot;onClear&quot;</span>  </span><br><span class="line">        /&gt;</span><br><span class="line"></span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">Icon</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">v-else</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">icon</span>=<span class="string">&quot;angle-down&quot;</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">class</span>=<span class="string">&quot;header-angle&quot;</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">:class</span>=<span class="string">&quot;&#123; &#x27;is-active&#x27;: isDropdownShow &#125;&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        /&gt;</span></span></span><br><span class="line"></span><br><span class="line">             </span><br><span class="line"><span class="comment">//实现</span></span><br><span class="line">              </span><br><span class="line"><span class="keyword">const</span> showClearIcon = <span class="title function_">computed</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// * hover 上去</span></span><br><span class="line">  <span class="comment">// * props.clearable 为 true</span></span><br><span class="line">  <span class="comment">// 必须要有选择过选项</span></span><br><span class="line">  <span class="comment">// Input 的值不能为空</span></span><br><span class="line">  <span class="keyword">return</span> props.<span class="property">clearable</span> </span><br><span class="line">    &amp;&amp; states.<span class="property">mouseHover</span></span><br><span class="line">    &amp;&amp; states.<span class="property">selectedOption</span></span><br><span class="line">    &amp;&amp; states.<span class="property">inputValue</span>.<span class="title function_">trim</span>() !== <span class="string">&#x27;&#x27;</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">onClear</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  states.<span class="property">selectedOption</span> = <span class="literal">null</span></span><br><span class="line">  states.<span class="property">inputValue</span> = <span class="string">&#x27;&#x27;</span></span><br><span class="line">  <span class="title function_">emits</span>(<span class="string">&#x27;clear&#x27;</span>)</span><br><span class="line">  <span class="title function_">emits</span>(<span class="string">&#x27;change&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">  <span class="title function_">emits</span>(<span class="string">&#x27;update:modelValue&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">NOOP</span> = (<span class="params"></span>) =&gt; &#123;&#125;</span><br></pre></td></tr></table></figure>



<h4 id="6-支持自定义模板"><a href="#6-支持自定义模板" class="headerlink" title="6.支持自定义模板"></a>6.支持自定义模板</h4><p>可以自定义，下拉菜单的选项的格式。</p>
<p>■ 使用函数 (e:SelectOption) &#x3D;&gt; VNode</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">RenderLabelFunc</span> = <span class="function">(<span class="params">option: SelectOption</span>) =&gt;</span> <span class="title class_">VNode</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> interface <span class="title class_">SelectProps</span> &#123;</span><br><span class="line">  <span class="comment">// v-model</span></span><br><span class="line">  <span class="attr">modelValue</span>: string;</span><br><span class="line">  <span class="comment">// 选项</span></span><br><span class="line">  options?: <span class="title class_">SelectOption</span>[];</span><br><span class="line">  <span class="comment">// 一些基本表单属性</span></span><br><span class="line">  <span class="attr">placeholder</span>: string;</span><br><span class="line">  <span class="attr">disabled</span>: boolean;</span><br><span class="line">  clearable?: boolean;</span><br><span class="line">  <span class="comment">//自定义模板属性renderLabel 对应函数 RenderLabelFunc</span></span><br><span class="line">  renderLabel?: <span class="title class_">RenderLabelFunc</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>使用之前定义过的renderVnode组件配合renderLabel 实现</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;RenderVnode :vNode=&quot;renderLabel ? renderLabel(item) : item.label&quot;/&gt;</span><br></pre></td></tr></table></figure>



<h4 id="7-支持筛选"><a href="#7-支持筛选" class="headerlink" title="7.支持筛选"></a>7.支持筛选</h4><p>Input允许输入，输入后可以根据输入字符自动过滤下拉菜单的选项。</p>
<p>属性：添加两个属性</p>
<ul>
<li>1.开启filter功能</li>
<li>2.自定义filter的处理方式 – 如果有自定义就用自定义，没有就用默认的数组上的filter</li>
</ul>
<p>思路：</p>
<ul>
<li>1.在本地存储一个可变的响应式对象</li>
<li>2.在input的时候重新计算，渲染新的值</li>
</ul>
<p>优化</p>
<ul>
<li><p>1.再次选择需要清空Input</p>
</li>
<li><p>2.再次选择改善placeholder的显示，显示当前选中的值</p>
</li>
</ul>
<p><strong>属性添加</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">CustomFilterFunc</span> = <span class="function">(<span class="params">value: <span class="built_in">string</span></span>) =&gt;</span> <span class="title class_">SelectOption</span>[];</span><br></pre></td></tr></table></figure>

<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">SelectProps</span> &#123;</span><br><span class="line">  <span class="comment">// v-model</span></span><br><span class="line">  <span class="attr">modelValue</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="comment">// 选项</span></span><br><span class="line">  options?: <span class="title class_">SelectOption</span>[];</span><br><span class="line">  <span class="comment">// 一些基本表单属性</span></span><br><span class="line">  <span class="attr">placeholder</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">disabled</span>: <span class="built_in">boolean</span>;</span><br><span class="line">  clearable?: <span class="built_in">boolean</span>;</span><br><span class="line">  renderLabel?: <span class="title class_">RenderLabelFunc</span>;</span><br><span class="line">  <span class="comment">//筛选功能属性 和 对应的函数</span></span><br><span class="line">  filterable?: <span class="built_in">boolean</span>;</span><br><span class="line">  filterMethod?: <span class="title class_">CustomFilterFunc</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p><strong>基本实现</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> filteredOptions = <span class="title function_">ref</span>(props.<span class="property">options</span>)</span><br><span class="line"><span class="title function_">watch</span>(<span class="function">() =&gt;</span> props.<span class="property">options</span>, <span class="function">(<span class="params">newOptions</span>) =&gt;</span> &#123;</span><br><span class="line">  filteredOptions.<span class="property">value</span> = newOptions</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">//当传入的属性是外部传来时，要watch属性变化</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//生成新的选项</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">generateFilterOptions</span> = <span class="keyword">async</span> (<span class="params">searchValue: string</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (!props.<span class="property">filterable</span>) <span class="keyword">return</span></span><br><span class="line">  <span class="keyword">if</span> (props.<span class="property">filterMethod</span> &amp;&amp; <span class="title function_">isFunction</span>(props.<span class="property">filterMethod</span>)) &#123;</span><br><span class="line">    filteredOptions.<span class="property">value</span> = props.<span class="title function_">filterMethod</span>(searchValue)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    filteredOptions.<span class="property">value</span> = props.<span class="property">options</span>.<span class="title function_">filter</span>(<span class="function"><span class="params">option</span> =&gt;</span> option.<span class="property">label</span>.<span class="title function_">includes</span>(searchValue))</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//包装函数 generateFilterOptions</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">onFilter</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="title function_">generateFilterOptions</span>(states.<span class="property">inputValue</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>筛选优化</strong></p>
<p>清空Input优化:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">controlDropdown</span> = (<span class="params">show: boolean</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (show) &#123;</span><br><span class="line">    <span class="comment">// filter 模式</span></span><br><span class="line">    <span class="comment">// 优化清空input</span></span><br><span class="line">    <span class="comment">// 之前选择过对应的值</span></span><br><span class="line">    <span class="keyword">if</span> (props.<span class="property">filterable</span> &amp;&amp; states.<span class="property">selectedOption</span>) &#123;</span><br><span class="line">      states.<span class="property">inputValue</span> = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 进行一次默认选项的生成</span></span><br><span class="line">    <span class="keyword">if</span> (props.<span class="property">filterable</span>) &#123;</span><br><span class="line">      <span class="title function_">generateFilterOptions</span>(states.<span class="property">inputValue</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    tooltipRef.<span class="property">value</span>.<span class="title function_">show</span>()</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    tooltipRef.<span class="property">value</span>.<span class="title function_">hide</span>()</span><br><span class="line">    <span class="comment">// placeholder优化 blur的部分</span></span><br><span class="line">    <span class="comment">// blur 时候将之前的值回灌到 input 中</span></span><br><span class="line">    <span class="keyword">if</span> (props.<span class="property">filterable</span>) &#123;</span><br><span class="line">      states.<span class="property">inputValue</span> = states.<span class="property">selectedOption</span> ? states.<span class="property">selectedOption</span>.<span class="property">label</span> : <span class="string">&#x27;&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    states.<span class="property">highlightIndex</span> = -<span class="number">1</span></span><br><span class="line">  &#125;</span><br><span class="line">  isDropdownShow.<span class="property">value</span> = show</span><br><span class="line">  <span class="title function_">emits</span>(<span class="string">&#x27;visible-change&#x27;</span>, show)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>placeholder优化:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> filteredPlaceholder = <span class="title function_">computed</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> (props.<span class="property">filterable</span> &amp;&amp; states.<span class="property">selectedOption</span> &amp;&amp; isDropdownShow.<span class="property">value</span>) </span><br><span class="line">  ? states.<span class="property">selectedOption</span>.<span class="property">label</span> : props.<span class="property">placeholder</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<h4 id="8-支持远程搜索"><a href="#8-支持远程搜索" class="headerlink" title="8.支持远程搜索"></a>8.支持远程搜索</h4><p>类似自动联想，可以根据输入的字符发送请求，渲染返回的内容作为选项列表，</p>
<p><strong>需求</strong>：</p>
<ul>
<li>每输入一个值，就发送特定请求，返回对应的选项</li>
<li>显示状态（正在读取&#x2F;没有数据等提示）</li>
</ul>
<p><strong>属性：</strong></p>
<ul>
<li>开启remote功能</li>
<li>自定义remote处理方式(value:string)&#x3D;&gt;Promise&lt;SelectOption[]&gt;</li>
</ul>
<p><strong>思路：</strong></p>
<ul>
<li>在Input输入的过程中，根据用户传入的remote处理方式，发起请求并且渲染结果</li>
</ul>
<p><strong>属性添加</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">CustomFilterRemoteFunc</span> = <span class="function">(<span class="params">value: <span class="built_in">string</span></span>) =&gt;</span> <span class="title class_">Promise</span>&lt;<span class="title class_">SelectOption</span>[]&gt;;</span><br></pre></td></tr></table></figure>

<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">SelectProps</span> &#123;</span><br><span class="line">  <span class="comment">// v-model</span></span><br><span class="line">  <span class="attr">modelValue</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="comment">// 选项</span></span><br><span class="line">  options?: <span class="title class_">SelectOption</span>[];</span><br><span class="line">  <span class="comment">// 一些基本表单属性</span></span><br><span class="line">  <span class="attr">placeholder</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">disabled</span>: <span class="built_in">boolean</span>;</span><br><span class="line">  clearable?: <span class="built_in">boolean</span>;</span><br><span class="line">  renderLabel?: <span class="title class_">RenderLabelFunc</span>;</span><br><span class="line">  filterable?: <span class="built_in">boolean</span>;</span><br><span class="line">  filterMethod?: <span class="title class_">CustomFilterFunc</span>;</span><br><span class="line">  <span class="comment">// 远程搜索功能属性 和 对应的函数</span></span><br><span class="line">  remote?: <span class="built_in">boolean</span>;</span><br><span class="line">  remoteMethod?: <span class="title class_">CustomFilterRemoteFunc</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>当设置一个数组的默认初始值的时候，要使用下面的方式(知识点)</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> props = <span class="title function_">withDefaults</span>(defineProps&lt;<span class="title class_">SelectProps</span>&gt;(), &#123;</span><br><span class="line">  <span class="attr">options</span>: <span class="function">() =&gt;</span> []</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 如果props中没有filterable属性，直接返回</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">generateFilterOptions</span> = <span class="keyword">async</span> (<span class="params">searchValue: string</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (!props.<span class="property">filterable</span>) <span class="keyword">return</span></span><br><span class="line">  <span class="comment">// 如果props中有filterMethod属性，并且是函数，则调用filterMethod方法</span></span><br><span class="line">  <span class="keyword">if</span> (props.<span class="property">filterMethod</span> &amp;&amp; <span class="title function_">isFunction</span>(props.<span class="property">filterMethod</span>)) &#123;</span><br><span class="line">    filteredOptions.<span class="property">value</span> = props.<span class="title function_">filterMethod</span>(searchValue)</span><br><span class="line">  <span class="comment">// 如果props中有remote属性，并且是函数，则调用remoteMethod方法</span></span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (props.<span class="property">remote</span> &amp;&amp; props.<span class="property">remoteMethod</span> &amp;&amp; <span class="title function_">isFunction</span>(props.<span class="property">remoteMethod</span>)) &#123;</span><br><span class="line">    <span class="comment">//表示正在进行对应的加载</span></span><br><span class="line">    states.<span class="property">loading</span> = <span class="literal">true</span></span><br><span class="line">     <span class="comment">//处理异步</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="comment">// 调用remoteMethod方法，并将结果赋值给filteredOptions.value</span></span><br><span class="line">      filteredOptions.<span class="property">value</span> = <span class="keyword">await</span> props.<span class="title function_">remoteMethod</span>(searchValue)</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">error</span>(e)</span><br><span class="line">     <span class="comment">//清空，代表有问题</span></span><br><span class="line">      filteredOptions.<span class="property">value</span> = []</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">      <span class="comment">//加载属性消失</span></span><br><span class="line">      states.<span class="property">loading</span> = <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">     <span class="comment">//如果请求成功，则将结果赋值给 filteredOptions，加载状态设置为 false。</span></span><br><span class="line">	 <span class="comment">//如果请求失败，则打印错误信息，将 filteredOptions 设置为空数组，加载状态设置为 false。</span></span><br><span class="line">  <span class="comment">// 否则，调用options的filter方法，将searchValue包含在label中的option过滤出来</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    filteredOptions.<span class="property">value</span> = props.<span class="property">options</span>.<span class="title function_">filter</span>(<span class="function"><span class="params">option</span> =&gt;</span> option.<span class="property">label</span>.<span class="title function_">includes</span>(searchValue))</span><br><span class="line">  &#125;</span><br><span class="line">  states.<span class="property">highlightIndex</span> = -<span class="number">1</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h4 id="9-远程请求添加防抖部分"><a href="#9-远程请求添加防抖部分" class="headerlink" title="9.远程请求添加防抖部分"></a>9.远程请求添加防抖部分</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;Input </span><br><span class="line">  v-model=&quot;states.inputValue&quot;</span><br><span class="line">  :disabled=&quot;disabled&quot;</span><br><span class="line">  :placeholder=&quot;filteredPlaceholder&quot;</span><br><span class="line">  ref=&quot;inputRef&quot;</span><br><span class="line">  :readonly=&quot;!filterable || !isDropdownShow&quot;</span><br><span class="line">  @input=&quot;debouceOnFilter&quot;</span><br><span class="line">  @keydown=&quot;handleKeydown&quot;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>

<p>debouce实现:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> debouceOnFilter = <span class="title function_">debounce</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">onFilter</span>()</span><br><span class="line">&#125;, timeout.<span class="property">value</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> timeout = <span class="title function_">computed</span>(<span class="function">() =&gt;</span> props.<span class="property">remote</span> ? <span class="number">300</span> : <span class="number">0</span>)</span><br></pre></td></tr></table></figure>



<h4 id="10-支持键盘操作"><a href="#10-支持键盘操作" class="headerlink" title="10.支持键盘操作"></a>10.支持键盘操作</h4><p><strong>需求：</strong></p>
<ul>
<li>在input focus的状态下，按下Enter打开下拉菜单&#x2F;再次按下关闭菜单</li>
<li>按ESC关闭菜单</li>
<li>按上下键移动菜单选项，高亮显示当前移动到的选项</li>
<li>按下Enter,选中特定的选项</li>
</ul>
<p><strong>思路：</strong></p>
<ul>
<li>在document上绑定onKeyDown事件</li>
<li>在Input的onKeyDown事件上绑定特殊的键盘操作事件完成任务</li>
<li><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/API/Element/keydown_event">https://developer.mozilla.org/zh-CN/docs/Web/API/Element/keydown_event</a></li>
<li>使用哪个属性监控按下了哪个键</li>
<li><a target="_blank" rel="noopener" href="https://developer..mozilla.org/zh-CN/docs/Web/APl/KeyboardEvent/keycode">https://developer..mozilla.org/zh-CN/docs/Web/APl/KeyboardEvent/keycode</a>    原来经常使用的keyCode已经要被弃用</li>
</ul>
<p>绑定事件:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"> &lt;Input </span><br><span class="line">      v-model=&quot;states.inputValue&quot;</span><br><span class="line">      :disabled=&quot;disabled&quot;</span><br><span class="line">      :placeholder=&quot;filteredPlaceholder&quot;</span><br><span class="line">      ref=&quot;inputRef&quot;</span><br><span class="line">      :readonly=&quot;!filterable || !isDropdownShow&quot;</span><br><span class="line">      @input=&quot;debouceOnFilter&quot;</span><br><span class="line">      @keydown=&quot;handleKeydown&quot;</span><br><span class="line">    &gt;</span><br><span class="line">&lt;/Input&gt;</span><br></pre></td></tr></table></figure>

<p>对应的事件处理:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">handleKeydown</span> = (<span class="params">e: KeyboardEvent</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">switch</span> (e.<span class="property">key</span>) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;Enter&#x27;</span>:</span><br><span class="line">      <span class="keyword">if</span> (!isDropdownShow.<span class="property">value</span>) &#123;</span><br><span class="line">        <span class="comment">//打开菜单</span></span><br><span class="line">        <span class="title function_">controlDropdown</span>(<span class="literal">true</span>)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">//高光移动到非默认值并且值存在</span></span><br><span class="line">        <span class="keyword">if</span> (states.<span class="property">highlightIndex</span> &gt; -<span class="number">1</span> &amp;&amp; filteredOptions.<span class="property">value</span>[states.<span class="property">highlightIndex</span>]) &#123;</span><br><span class="line">          <span class="title function_">itemSelect</span>(filteredOptions.<span class="property">value</span>[states.<span class="property">highlightIndex</span>])</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="comment">//关闭菜单</span></span><br><span class="line">          <span class="title function_">controlDropdown</span>(<span class="literal">false</span>)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;Escape&#x27;</span>:</span><br><span class="line">      <span class="keyword">if</span> (isDropdownShow.<span class="property">value</span>) &#123;</span><br><span class="line">        <span class="title function_">controlDropdown</span>(<span class="literal">false</span>)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;ArrowUp&#x27;</span>:</span><br><span class="line">      e.<span class="title function_">preventDefault</span>()</span><br><span class="line">      <span class="comment">//初始值states.highlightIndex = -1</span></span><br><span class="line">      <span class="comment">//判断菜单有值</span></span><br><span class="line">      <span class="keyword">if</span> (filteredOptions.<span class="property">value</span>.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">//高亮到最后一项 和 循环操作对应states.highlightIndex===0</span></span><br><span class="line">        <span class="keyword">if</span> (states.<span class="property">highlightIndex</span> === -<span class="number">1</span> || states.<span class="property">highlightIndex</span> === <span class="number">0</span>) &#123;</span><br><span class="line">          states.<span class="property">highlightIndex</span> = filteredOptions.<span class="property">value</span>.<span class="property">length</span> - <span class="number">1</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="comment">// 向上移动</span></span><br><span class="line">          states.<span class="property">highlightIndex</span>--</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;ArrowDown&#x27;</span>:</span><br><span class="line">      <span class="comment">//阻止默认行为 页面的滚动条移动</span></span><br><span class="line">      e.<span class="title function_">preventDefault</span>()</span><br><span class="line">      <span class="comment">// states.highlightIndex = -1</span></span><br><span class="line">      <span class="comment">//判断菜单有值</span></span><br><span class="line">      <span class="keyword">if</span> (filteredOptions.<span class="property">value</span>.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">          <span class="comment">//高亮到最后一项 和 循环操作对应states.highlightIndex===0</span></span><br><span class="line">        <span class="keyword">if</span> (states.<span class="property">highlightIndex</span> === -<span class="number">1</span> || states.<span class="property">highlightIndex</span> === (filteredOptions.<span class="property">value</span>.<span class="property">length</span> - <span class="number">1</span>)) &#123;</span><br><span class="line">          states.<span class="property">highlightIndex</span> = <span class="number">0</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="comment">// 向下移动</span></span><br><span class="line">          states.<span class="property">highlightIndex</span>++</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">break</span></span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>完善部分：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">SelectStates</span> &#123;</span><br><span class="line">  <span class="attr">inputValue</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">selectedOption</span>: <span class="literal">null</span> | <span class="title class_">SelectOption</span>;</span><br><span class="line">  <span class="attr">mouseHover</span>: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="attr">loading</span>: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="comment">//高亮属性</span></span><br><span class="line">  <span class="attr">highlightIndex</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="3-Select-总结"><a href="#3-Select-总结" class="headerlink" title="(3) Select 总结"></a>(3) Select 总结</h3><ul>
<li>进阶版本的Dropdown,Input组件Tooltip组件的组合。</li>
<li>善于使用已经有的基础组件来进行排列组合，二次开发需要的组件。</li>
<li>对于复杂需求，可以使用手动控制下拉菜单的显示与隐藏。</li>
<li>当遇到列表渲染的时候，应该条件反射一样的想到两种方式。</li>
</ul>
<p>​			语义化，也就是子组件，结构更清楚，渲染复杂的结构比较方便。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;Select&gt;</span><br><span class="line">&lt;Item&gt;First&lt;/Item&gt;</span><br><span class="line">&lt;Item&gt;2&lt;/Item&gt;</span><br><span class="line">&lt;Item disabled&gt;Disabled&lt;/Item&gt;</span><br><span class="line">&lt;/Select&gt;</span><br></pre></td></tr></table></figure>

<p>​			使用数组，更加方便快捷，实现起来也比较容易，操作数组也更方便。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;Select items=&#123;items)&gt;&lt;/Select&gt;</span><br></pre></td></tr></table></figure>



<ul>
<li>遇到自定义模版这样的需求，想到使用自定义函数来渲染。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> type <span class="title class_">RenderLabelFunc</span> =<span class="function">(<span class="params">option:Selectoption</span>)=&gt;</span><span class="title class_">VNode</span>;</span><br></pre></td></tr></table></figure>

<p>​			使用RenderVNode这样的中间组件来渲染负责VNode或者直接使用jsx也完全可以</p>
<ul>
<li>遇到用户筛选这种需求，不管是同步还是异步，也要想到自定义函数</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> type <span class="title class_">CustomFilterFunc</span> = <span class="function">(<span class="params">value:string</span>)=&gt;</span><span class="title class_">Selectoption</span>[]</span><br><span class="line"><span class="keyword">export</span> type <span class="title class_">CustomFilterRemoteFunc</span>  =  <span class="function">(<span class="params">value:string</span>)=&gt;</span><span class="title class_">Promise</span>&lt;<span class="title class_">Selectoption</span>[]&gt;;</span><br></pre></td></tr></table></figure>



<ul>
<li><p>对于在短时间内会被触发多次的回调，一定要注意是否需要函数截流</p>
</li>
<li><p>使用KeyDown来监控键盘是否被按下，使用e.key而不是e.keyCode来监控哪个按键被按下</p>
</li>
<li><p>当你将props的值，作为初始值传入给一个响应式对象的时候，一定要watch原始值的修改，然后更新本地的响应式对象。</p>
</li>
</ul>
<h2 id="15-Form-组件"><a href="#15-Form-组件" class="headerlink" title="15.Form 组件"></a>15.Form 组件</h2><h3 id="1-需求分析-10"><a href="#1-需求分析-10" class="headerlink" title="(1) 需求分析"></a>(1) 需求分析</h3><ul>
<li><p><strong>自定义UI</strong></p>
<ul>
<li><p>整体可自定义</p>
</li>
<li><p>用户可以自定义渲染多种类型的表单元素- Input,Switch,Select等</p>
</li>
<li><p>用户可以自定义提交区域的内容（按钮样式，排列等等）</p>
</li>
</ul>
</li>
<li><p><strong>验证时机</strong></p>
<ul>
<li><p>表单元素默认Blur的时候验证，可以自定义</p>
</li>
<li><p>整个表单在点击提交提交按钮的时候全部验证</p>
</li>
</ul>
</li>
<li><p><strong>验证规则</strong></p>
<ul>
<li>每个Input可以配置多条规则（不能为空，需要是字符串，最多是多少等等）</li>
<li>可以自定义规则（比如重复密码框输入的要和密码输入的一样）</li>
</ul>
</li>
</ul>
<h4 id="组件结构设计："><a href="#组件结构设计：" class="headerlink" title="组件结构设计："></a><strong>组件结构设计：</strong></h4><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> formobj = &#123;</span><br><span class="line"><span class="string">&#x27;name&#x27;</span>:&#123;<span class="attr">key</span>:<span class="string">&#x27;name&#x27;</span>,<span class="attr">value</span>:<span class="string">&#x27;&#x27;</span>,<span class="attr">rules</span>:[],<span class="attr">component</span>:<span class="title class_">Input</span> &#125;,</span><br><span class="line"><span class="string">&#x27;password&#x27;</span>:&#123;<span class="attr">key</span>:<span class="string">&#x27;name&#x27;</span>,<span class="attr">value</span>:<span class="string">&#x27;&#x27;</span>,<span class="attr">rules</span>:[],<span class="attr">component</span>:<span class="title class_">Select</span> &#125;,</span><br><span class="line">&#125;</span><br><span class="line">&lt;<span class="title class_">Form</span> :items=<span class="string">&quot;formobj&quot;</span>&gt;&lt;/<span class="title class_">Form</span>&gt;</span><br></pre></td></tr></table></figure>

<p><strong>这种设计的带来的问题:</strong></p>
<p>不语义化，使用起来，看起来都很别扭，个性化很困难。</p>
<p>没办法自定义布局。</p>
<p><strong>应该有的结构</strong></p>
<p>第一步，静态外观：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;Form&gt;</span><br><span class="line">	&lt;Item label=&#x27;用户名&#x27;name=&#x27;name&#x27;&gt;</span><br><span class="line">	&lt;Input /&gt;</span><br><span class="line">	&lt;/Item&gt;</span><br><span class="line">	&lt;Item label=&#x27;密码&#x27;name=&#x27;password&#x27;&gt;</span><br><span class="line">	&lt;Input type=&quot;password&quot;/&gt;</span><br><span class="line">		&lt;/Item&gt;</span><br><span class="line">	&lt;Button type=&quot;submit&quot;&gt;登陆&lt;/Button&gt;</span><br><span class="line">&lt;/Form&gt;</span><br></pre></td></tr></table></figure>




<p>第二步：属性：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> model = <span class="title function_">reactive</span>(&#123;</span><br><span class="line">	<span class="attr">name</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">	<span class="attr">password</span>:<span class="string">&#x27;&#x27;</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">const</span> rules = &#123;</span><br><span class="line">	<span class="attr">name</span>:[&#123;<span class="attr">type</span>:<span class="string">&#x27;email&#x27;</span>,<span class="attr">required</span>:<span class="literal">true</span>,<span class="attr">trigger</span>:<span class="string">&#x27;blur&#x27;</span>&#125;],</span><br><span class="line">	<span class="attr">password</span>:[&#123;<span class="attr">type</span>:<span class="string">&#x27;string&#x27;</span>,<span class="attr">required</span>:<span class="literal">true</span>,<span class="attr">trigger</span>:<span class="string">&#x27;blur&#x27;</span>),&#123;<span class="attr">min</span>:<span class="number">3</span>,<span class="attr">max</span>:<span class="number">5</span>,<span class="attr">message</span>:<span class="string">&#x27;Length should be 3 to 5&#x27;</span>,<span class="attr">trigger</span>:<span class="string">&#x27;blur&#x27;</span>&#125;],</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>



<p>第三步结合：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;Form :model =&quot;model&quot; :rules=&quot;rules&quot;&gt;</span><br><span class="line">	&lt;Item label=&#x27;用户名&#x27; name=&#x27;name&#x27;&gt;</span><br><span class="line">	&lt;Input v-model=&quot;model.name&quot;/&gt;</span><br><span class="line">	&lt;/Item&gt;</span><br><span class="line">	&lt;Item label=&#x27;密码&#x27; name=&#x27;password&#x27; rules=&#123;[&#123; type:&#x27;string&#x27;,required:true,min:3,max:8&#125;]&#125;&gt;</span><br><span class="line">	&lt;Input type=&quot;password&quot; v-model=&quot;model.password&quot;/&gt;</span><br><span class="line">	&lt;/Item&gt;</span><br><span class="line">	&lt;Button type=&quot;submit&quot;&gt;登陆&lt;/Button&gt;</span><br><span class="line">&lt;/Form&gt;</span><br></pre></td></tr></table></figure>



<p>第四步，想想怎样完成验证：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">FormInstance</span>&#123;</span><br><span class="line">	<span class="attr">validate</span>: <span class="function">()=&gt;</span><span class="built_in">void</span>;</span><br><span class="line">	<span class="attr">resetFields</span>: <span class="function">()=&gt;</span><span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h4 id="开发步骤：从静到动"><a href="#开发步骤：从静到动" class="headerlink" title="开发步骤：从静到动"></a>开发步骤：从静到动</h4><ul>
<li>根据结构，实现基础布局。</li>
<li>添加初始化数据，以及数据更新的功能。</li>
<li>添加验证功能。</li>
<li>后续的一些需求。</li>
</ul>
<h3 id="2-代码编写-9"><a href="#2-代码编写-9" class="headerlink" title="(2) 代码编写"></a>(2) 代码编写</h3><h4 id="0-流程图"><a href="#0-流程图" class="headerlink" title="0.流程图"></a><strong>0.流程图</strong></h4><p><img src="/../images/Vue3_%E5%B0%81%E8%A3%85%E7%BB%84%E4%BB%B6%E5%BA%93%E9%A1%B9%E7%9B%AE/52.png"></p>
<p><img src="/../images/Vue3_%E5%B0%81%E8%A3%85%E7%BB%84%E4%BB%B6%E5%BA%93%E9%A1%B9%E7%9B%AE/53.png"></p>
<h4 id="1-基础结构"><a href="#1-基础结构" class="headerlink" title="1.基础结构"></a>1.基础结构</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">&lt;div&gt;</span><br><span class="line">&lt;Form&gt;</span><br><span class="line">	&lt;FormItem label=&quot;the email&quot;&gt;</span><br><span class="line">	&lt;Input/&gt;</span><br><span class="line">	&lt;/FormItem&gt;</span><br><span class="line">	&lt;FormItem label=&quot;the password&quot;&gt;</span><br><span class="line">	  &lt;template #label=&quot;&#123;label&#125;&quot;</span><br><span class="line">  		&lt;Button&gt;&#123;&#123;label&#125;&#125;&lt;/Button&gt;</span><br><span class="line">      &lt;/template&gt;</span><br><span class="line">	&lt;Input type=&quot;password&quot; /&gt;</span><br><span class="line">	&lt;/FormItem&gt;</span><br><span class="line">	&lt;div&gt;</span><br><span class="line">		&lt;Button type=&quot;primary&quot;&gt;Submit&lt;/Button&gt;</span><br><span class="line">		&lt;Button &gt;Reset&lt;/Button&gt;</span><br><span class="line">	&lt;/div&gt;</span><br><span class="line">&lt;/Form&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>使用了作用域插槽实现数据传递</strong>:</p>
<p><img src="/../images/Vue3_%E5%B0%81%E8%A3%85%E7%BB%84%E4%BB%B6%E5%BA%93%E9%A1%B9%E7%9B%AE/51.png"></p>
<h4 id="2-添加数据和规则"><a href="#2-添加数据和规则" class="headerlink" title="2.添加数据和规则"></a>2.添加数据和规则</h4><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">FormItemProps</span> &#123;</span><br><span class="line">  <span class="attr">label</span>: <span class="built_in">string</span>;</span><br><span class="line">  prop?: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">FormProps</span> &#123;</span><br><span class="line">  <span class="attr">model</span>: <span class="title class_">Record</span>&lt;<span class="built_in">string</span>, <span class="built_in">any</span>&gt;;</span><br><span class="line">  <span class="attr">rules</span>: <span class="title class_">FormRules</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3-获取数据和规则"><a href="#3-获取数据和规则" class="headerlink" title="3.获取数据和规则"></a>3.获取数据和规则</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> innerValue = <span class="title function_">computed</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> model = formContext?.<span class="property">model</span></span><br><span class="line">  <span class="keyword">if</span> (model &amp;&amp; props.<span class="property">prop</span> &amp;&amp; !<span class="title function_">isNil</span>(model[props.<span class="property">prop</span>])) &#123;</span><br><span class="line">    <span class="keyword">return</span> model[props.<span class="property">prop</span>]</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">const</span> itemRules = <span class="title function_">computed</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> rules = formContext?.<span class="property">rules</span></span><br><span class="line">  <span class="keyword">if</span> (rules &amp;&amp; props.<span class="property">prop</span> &amp;&amp; rules[props.<span class="property">prop</span>]) &#123;</span><br><span class="line">    <span class="keyword">return</span> rules[props.<span class="property">prop</span>]</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> []</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">getTriggeredRules</span> = (<span class="params">trigger?: string</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> rules = itemRules.<span class="property">value</span></span><br><span class="line">  <span class="keyword">if</span> (rules) &#123;</span><br><span class="line">    <span class="keyword">return</span> rules.<span class="title function_">filter</span>(<span class="function"><span class="params">rule</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (!rule.<span class="property">trigger</span> || !trigger) <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">      <span class="keyword">return</span> rule.<span class="property">trigger</span> &amp;&amp; rule.<span class="property">trigger</span> === trigger</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> []</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="4-学习使用-async-val（第三方库）"><a href="#4-学习使用-async-val（第三方库）" class="headerlink" title="4.学习使用 async-val（第三方库）"></a>4.学习使用 async-val（第三方库）</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Schema</span> <span class="keyword">from</span> <span class="string">&#x27;async-validator&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> descriptor = &#123;</span><br><span class="line">    <span class="attr">name</span>:&#123;</span><br><span class="line">      <span class="attr">type</span>:<span class="string">&#x27;string&#x27;</span>,</span><br><span class="line">	 <span class="attr">required</span>:<span class="literal">true</span>,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> validator = <span class="keyword">new</span> <span class="title class_">Schema</span>(descriptor)</span><br><span class="line"></span><br><span class="line"><span class="comment">//两种验证方式，第一种是回调</span></span><br><span class="line">validator.<span class="title function_">validate</span>(&#123;<span class="attr">name</span>:<span class="string">&#x27;muji&#x27;</span>&#125;,<span class="function">(<span class="params">errors,fields</span>)=&gt;</span>&#123;</span><br><span class="line"><span class="keyword">if</span> (errors)&#123;</span><br><span class="line"><span class="comment">//errors的具体信息，fields是具体字段</span></span><br><span class="line">	<span class="keyword">return</span> <span class="title function_">handleErrors</span>(errors,fields);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//validation passed</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//第二种是Promise类型（强推）</span></span><br><span class="line">validator.<span class="title function_">validate</span>(&#123;<span class="attr">name</span>:<span class="string">&#x27;muji&#x27;</span>,<span class="attr">age</span>:<span class="number">16</span> &#125;).<span class="title function_">then</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">	<span class="comment">//validation passed or without error message</span></span><br><span class="line">&#125;).<span class="title function_">catch</span>(<span class="function">(<span class="params">&#123;errors,fie1ds&#125;</span>)=&gt;</span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="title function_">handleErrors</span>(errors,fields);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h4 id="5-FormItem完成验证"><a href="#5-FormItem完成验证" class="headerlink" title="5.FormItem完成验证"></a>5.FormItem完成验证</h4><h5 id="验证的基本要素"><a href="#验证的基本要素" class="headerlink" title="验证的基本要素"></a><strong>验证的基本要素</strong></h5><ul>
<li>value数据</li>
<li>rules规则</li>
<li>在合适的时机，触发对应的验证</li>
</ul>
<h5 id="设计验证的流程"><a href="#设计验证的流程" class="headerlink" title="设计验证的流程"></a><strong>设计验证的流程</strong></h5><p>验证的类型</p>
<ul>
<li>表单整体验证</li>
<li>单个表单元素验证</li>
</ul>
<p><strong>结论:不难发现整体验证就是循环调用单个验证汇总获得的结果</strong></p>
<h5 id="单个验证的实现方式"><a href="#单个验证的实现方式" class="headerlink" title="单个验证的实现方式"></a>单个验证的实现方式</h5><p>​	要在Formltem中实现</p>
<p>​	基本要素，从父组件Form获取值(value)和规则(rules)</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">validate</span> = <span class="keyword">async</span> (<span class="params">trigger?: string</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> modelName = props.<span class="property">prop</span></span><br><span class="line">  <span class="keyword">const</span> triggeredRules = <span class="title function_">getTriggeredRules</span>(trigger)</span><br><span class="line">  <span class="keyword">if</span> (triggeredRules.<span class="property">length</span> === <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (modelName) &#123;</span><br><span class="line">    <span class="keyword">const</span> validator = <span class="keyword">new</span> <span class="title class_">Schema</span>(&#123;</span><br><span class="line">      [modelName]: triggeredRules</span><br><span class="line">    &#125;)</span><br><span class="line">    validateStatus.<span class="property">loading</span> = <span class="literal">true</span></span><br><span class="line">    <span class="keyword">return</span> validator.<span class="title function_">validate</span>(&#123; [modelName]: innerValue.<span class="property">value</span> &#125;)</span><br><span class="line">      .<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        validateStatus.<span class="property">state</span> = <span class="string">&#x27;success&#x27;</span></span><br><span class="line">      &#125;)</span><br><span class="line">      .<span class="title function_">catch</span>(<span class="function">(<span class="params">e: FormValidateFailure</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123; errors &#125; = e</span><br><span class="line">        validateStatus.<span class="property">state</span> = <span class="string">&#x27;error&#x27;</span></span><br><span class="line">        validateStatus.<span class="property">errorMsg</span> = (errors &amp;&amp; errors.<span class="property">length</span> &gt; <span class="number">0</span>) ? errors[<span class="number">0</span>].<span class="property">message</span> || <span class="string">&#x27;&#x27;</span> : <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(e.<span class="property">errors</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(e)</span><br><span class="line">      &#125;)</span><br><span class="line">      .<span class="title function_">finally</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        validateStatus.<span class="property">loading</span> = <span class="literal">false</span></span><br><span class="line">      &#125;)</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>



<h4 id="6-自动触发验证"><a href="#6-自动触发验证" class="headerlink" title="6.自动触发验证"></a>6.自动触发验证</h4><h5 id="验证的场景"><a href="#验证的场景" class="headerlink" title="验证的场景"></a>验证的场景</h5><ul>
<li>单个ltem的验证</li>
<li>整个Form的验证</li>
</ul>
<p><strong>流程</strong></p>
<p>规则(rules)+值(value)）,在特殊的时机（比如onBlur）,调用特殊的逻辑去验证最终的结果。</p>
<p><strong>难点，后面注意</strong></p>
<p>就是怎样在特殊的事件下，完成验证，从设计上来看，Formltem中的表单相关的组件，并没有显式绑定任<br>何的事件。</p>
<h5 id="使用第三方库async-validator实现特殊验证"><a href="#使用第三方库async-validator实现特殊验证" class="headerlink" title="使用第三方库async-validator实现特殊验证"></a>使用第三方库async-validator实现特殊验证</h5><p><img src="/../images/Vue3_%E5%B0%81%E8%A3%85%E7%BB%84%E4%BB%B6%E5%BA%93%E9%A1%B9%E7%9B%AE/55.png"></p>
<p><strong>使用了promise的api</strong></p>
<p><img src="/../images/Vue3_%E5%B0%81%E8%A3%85%E7%BB%84%E4%BB%B6%E5%BA%93%E9%A1%B9%E7%9B%AE/54.png"></p>
<h4 id="7-添加Trigger条件"><a href="#7-添加Trigger条件" class="headerlink" title="7.添加Trigger条件"></a>7.添加Trigger条件</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//子组件传入trigger</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">getTriggeredRules</span> = (<span class="params">trigger?: string</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> rules = itemRules.<span class="property">value</span></span><br><span class="line">  <span class="keyword">if</span> (rules) &#123;</span><br><span class="line">    <span class="keyword">return</span> rules.<span class="title function_">filter</span>(<span class="function"><span class="params">rule</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (!rule.<span class="property">trigger</span> || !trigger) <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">      <span class="keyword">return</span> rule.<span class="property">trigger</span> &amp;&amp; rule.<span class="property">trigger</span> === trigger</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> []</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="8-父子组件通信"><a href="#8-父子组件通信" class="headerlink" title="8.父子组件通信"></a>8.父子组件通信</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//provide和inject实现</span></span><br><span class="line"><span class="title function_">provide</span>(formContextKey, &#123;</span><br><span class="line">  ...props,</span><br><span class="line">  addField,</span><br><span class="line">  removeField</span><br><span class="line">&#125;)</span><br><span class="line"><span class="title function_">provide</span>(formItemContextKey, context)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> formContext = <span class="title function_">inject</span>(formContextKey)</span><br></pre></td></tr></table></figure>



<h4 id="9-完成表单整个验证功能"><a href="#9-完成表单整个验证功能" class="headerlink" title="9.完成表单整个验证功能"></a>9.完成表单整个验证功能</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="attr">fields</span>: <span class="title class_">FormItemContext</span>[] = []</span><br><span class="line"><span class="keyword">const</span> <span class="attr">addField</span>: <span class="title class_">FormContext</span>[<span class="string">&#x27;addField&#x27;</span>] = <span class="function">(<span class="params">field</span>) =&gt;</span> &#123;</span><br><span class="line">  fields.<span class="title function_">push</span>(field)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="attr">removeField</span>: <span class="title class_">FormContext</span>[<span class="string">&#x27;removeField&#x27;</span>] = <span class="function">(<span class="params">field</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (field.<span class="property">prop</span>) &#123;</span><br><span class="line">    fields.<span class="title function_">splice</span>(fields.<span class="title function_">indexOf</span>(field), <span class="number">1</span>)</span><br><span class="line">  &#125; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">validate</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">let</span> <span class="attr">validationErrors</span>:<span class="title class_">ValidateFieldsError</span> = &#123;&#125;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;fields&#x27;</span>, fields)</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> field <span class="keyword">of</span> fields) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">await</span> field.<span class="title function_">validate</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    &#125; <span class="keyword">catch</span>(e) &#123;</span><br><span class="line">      <span class="keyword">const</span> error = e <span class="keyword">as</span> <span class="title class_">FormValidateFailure</span></span><br><span class="line">      validationErrors = &#123;</span><br><span class="line">        ...validationErrors,</span><br><span class="line">        ...error.<span class="property">fields</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (<span class="title class_">Object</span>.<span class="title function_">keys</span>(validationErrors).<span class="property">length</span> === <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(validationErrors)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="10-添加重置状态功能"><a href="#10-添加重置状态功能" class="headerlink" title="10.添加重置状态功能"></a>10.添加重置状态功能</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">//form.vue</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">resetFields</span> = (<span class="params">keys: string[] = []</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> filterArr = keys.<span class="property">length</span> &gt; <span class="number">0</span> ? fields.<span class="title function_">filter</span>(<span class="function"><span class="params">field</span> =&gt;</span> keys.<span class="title function_">includes</span>(field.<span class="property">prop</span>)) : fields</span><br><span class="line">  filterArr.<span class="title function_">forEach</span>(<span class="function"><span class="params">field</span> =&gt;</span> field.<span class="title function_">resetField</span>())</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">clearValidate</span> = (<span class="params">keys: string[] = []</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> filterArr = keys.<span class="property">length</span> &gt; <span class="number">0</span> ? fields.<span class="title function_">filter</span>(<span class="function"><span class="params">field</span> =&gt;</span> keys.<span class="title function_">includes</span>(field.<span class="property">prop</span>)) : fields</span><br><span class="line">  filterArr.<span class="title function_">forEach</span>(<span class="function"><span class="params">field</span> =&gt;</span> field.<span class="title function_">clearValidate</span>())  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//formitem.vue</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">clearValidate</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  validateStatus.<span class="property">state</span> = <span class="string">&#x27;init&#x27;</span></span><br><span class="line">  validateStatus.<span class="property">errorMsg</span> = <span class="string">&#x27;&#x27;</span></span><br><span class="line">  validateStatus.<span class="property">loading</span> = <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">resetField</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="title function_">clearValidate</span>()</span><br><span class="line">  <span class="keyword">const</span> model = formContext?.<span class="property">model</span></span><br><span class="line">  <span class="keyword">if</span> (model &amp;&amp; props.<span class="property">prop</span> &amp;&amp; !<span class="title function_">isNil</span>(model[props.<span class="property">prop</span>])) &#123; </span><br><span class="line">    model[props.<span class="property">prop</span>] = initialValue</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="11-添加样式"><a href="#11-添加样式" class="headerlink" title="11.添加样式"></a>11.添加样式</h4><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.vk-form</span> &#123;</span><br><span class="line">  <span class="attr">--vk-form-label-font-size</span>: <span class="built_in">var</span>(--vk-font-size-base);</span><br><span class="line">  <span class="attr">--vk-form-content-font-size</span>: <span class="built_in">var</span>(--vk-font-size-base);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.vk-form-item</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">margin-bottom</span>: <span class="number">18px</span>;</span><br><span class="line">  <span class="selector-class">.vk-form-item__label</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">150px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">32px</span>;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">32px</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">12px</span> <span class="number">0</span> <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">    <span class="attribute">display</span>: inline-flex;</span><br><span class="line">    <span class="attribute">justify-content</span>: flex-end;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="built_in">var</span>(--vk-form-label-font-size);</span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">var</span>(--vk-text-color-regular);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.vk-form-item__content</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">flex-wrap</span>: wrap;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">    <span class="attribute">flex</span>: <span class="number">1</span>;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">32px</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="built_in">var</span>(--vk-form-content-font-size);</span><br><span class="line">    <span class="attribute">min-width</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.vk-form-item__error-msg</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">padding-top</span>: <span class="number">2px</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">var</span>(--vk-color-danger);</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">12px</span>;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.vk-form-item</span><span class="selector-class">.is-error</span> <span class="selector-class">.vk-input__wrapper</span> &#123;</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1px</span> <span class="built_in">var</span>(--vk-color-danger) inset;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.vk-form-item</span><span class="selector-class">.is-success</span> <span class="selector-class">.vk-input__wrapper</span> &#123;</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1px</span> <span class="built_in">var</span>(--vk-color-success) inset;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.vk-form-item</span><span class="selector-class">.is-required</span> &gt; <span class="selector-class">.vk-form-item__label</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&quot;*&quot;</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">var</span>(--vk-color-danger);</span><br><span class="line">  <span class="attribute">margin-right</span>: <span class="number">4px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h4 id="12-优化整合"><a href="#12-优化整合" class="headerlink" title="12.优化整合"></a>12.优化整合</h4><h5 id="解决promise错误"><a href="#解决promise错误" class="headerlink" title="解决promise错误"></a>解决promise错误</h5><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">validate</span>: <span class="function">(<span class="params">trigger?: <span class="built_in">string</span></span>) =&gt;</span> <span class="title class_">Promise</span>&lt;<span class="built_in">any</span>&gt;;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">runValidation</span> = (<span class="params">trigger?: string</span>) =&gt; &#123;</span><br><span class="line">  formItemContext?.<span class="title function_">validate</span>(trigger).<span class="title function_">catch</span>(<span class="function">(<span class="params">e</span>) =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(e.<span class="property">errors</span>))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="3-Form总结"><a href="#3-Form总结" class="headerlink" title="(3) Form总结"></a>(3) Form总结</h3><h4 id="父子组件数据传递的常用方式"><a href="#父子组件数据传递的常用方式" class="headerlink" title="父子组件数据传递的常用方式"></a>父子组件数据传递的常用方式</h4><ul>
<li><p>最常用：属性&#x2F;事件</p>
</li>
<li><p>provide&#x2F;inject (透传，适用于父组件到子组件)</p>
<ul>
<li><p>FormContext,Form &#x3D;&gt; Formltem</p>
</li>
<li><p>FormltemContext,Formltem  &#x3D;&gt; Input</p>
</li>
</ul>
</li>
<li><p>Scoped slot (给slot传递数据)</p>
<ul>
<li>Formltem  &#x3D;&gt;  #template</li>
</ul>
</li>
<li><p>在父组件创建数据结构，在子组件填充数据（适用于子组件到父组件）</p>
<ul>
<li><p>Form &#x3D;&gt; FormltemContext[]</p>
</li>
<li><p>Formltem  &#x3D;&gt; onMounted的时候插入数据 - addField</p>
</li>
<li><p>Formltem  &#x3D;&gt;  onUnmounted的时候删除数据 - removeField</p>
</li>
<li><p>在Form当中调用Formltem的具体属性和方法</p>
</li>
<li><p>小思考：可以使用pub&#x2F;sub模型，这样只需要提供一个 emitter 对象就可以了。</p>
</li>
</ul>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> emitter <span class="title function_">mitt</span>()</span><br><span class="line">emitter.<span class="title function_">on</span>(<span class="string">&#x27;addField&#x27;</span>,<span class="function">()=&gt;</span>&#123;&#125;)</span><br><span class="line">emitter.<span class="title function_">on</span>(<span class="string">&#x27;removeField&#x27;</span>,<span class="function">()=&gt;</span>&#123;&#125;)</span><br><span class="line"></span><br><span class="line"><span class="title function_">provide</span>(key,&#123;emitter&#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//FormItem</span></span><br><span class="line"></span><br><span class="line">emitter <span class="title function_">inject</span>(formContextKey)</span><br><span class="line"></span><br><span class="line">emitter.<span class="title function_">emit</span>(<span class="string">&#x27;addField&#x27;</span>,formItemContext)</span><br></pre></td></tr></table></figure>



<h4 id="一些小的Tip"><a href="#一些小的Tip" class="headerlink" title="一些小的Tip"></a><strong>一些小的Tip</strong></h4><ul>
<li>注意defineExpose,一个好的组件应该尽可能的给用户提供实例中有用的信息供他们进行自定义。</li>
<li>对于有可能出现的异步操作，尽可能提供Promise</li>
</ul>
<h2 id="16-组件库打包与发布"><a href="#16-组件库打包与发布" class="headerlink" title="16.组件库打包与发布"></a>16.组件库打包与发布</h2><h3 id="任务"><a href="#任务" class="headerlink" title="任务"></a>任务</h3><ul>
<li><p>了解Javascript模块化发展的历史</p>
<ul>
<li>全局变量</li>
<li>common.js AMD</li>
<li>ES6 modules</li>
</ul>
</li>
<li><p>Bunder的功能和作用</p>
<ul>
<li>Vite(Rollup+ESBuild)在dev和build的过程为什么这么不同</li>
<li>Webpack</li>
</ul>
</li>
<li><p>学习使用Vite(Rollup)实现代码打包</p>
<ul>
<li>代码入口文件</li>
<li>配置文件</li>
<li>生成多种文件类型</li>
<li>生成样式文件</li>
<li>typescript 定义文件 d.ts</li>
</ul>
</li>
<li><p>发布到NPM</p>
<ul>
<li>本地测试</li>
<li>注册以及发布到NPM</li>
<li>NPM钩子</li>
</ul>
</li>
</ul>
<h3 id="模块化"><a href="#模块化" class="headerlink" title="模块化"></a>模块化</h3><h4 id="模块化是什么"><a href="#模块化是什么" class="headerlink" title="模块化是什么"></a>模块化是什么</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> package <span class="keyword">import</span> <span class="keyword">function</span></span><br></pre></td></tr></table></figure>

<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h4 id="模块化的优点"><a href="#模块化的优点" class="headerlink" title="模块化的优点"></a>模块化的优点</h4><ul>
<li>可维护性</li>
<li>可复用性</li>
</ul>
<h4 id="ES6之前没有模块的年代"><a href="#ES6之前没有模块的年代" class="headerlink" title="ES6之前没有模块的年代"></a>ES6之前没有模块的年代</h4><h5 id="backbone-js"><a href="#backbone-js" class="headerlink" title="backbone.js"></a>backbone.js</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//使用backbone.js的方法</span></span><br><span class="line">&lt;script src=<span class="string">&quot;spec/support/jquery.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;spec/support/underscore.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;spec/support/backbone.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;backbone.localStorage.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;todos.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>



<h5 id="全局变量-命名空间-namespace"><a href="#全局变量-命名空间-namespace" class="headerlink" title="全局变量+命名空间(namespace)"></a>全局变量+命名空间(namespace)</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// IIFE  自执行函数，创建一个封闭的作用域，赋值给一个全局变量</span></span><br><span class="line"><span class="keyword">var</span> namescollection = (<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">	<span class="comment">//private members</span></span><br><span class="line">  	<span class="keyword">var</span> objects =  [];</span><br><span class="line">  	</span><br><span class="line">	<span class="comment">//Public Method</span></span><br><span class="line">	<span class="keyword">function</span> <span class="title function_">addobject</span>(<span class="params">object</span>)&#123;</span><br><span class="line">	objects.<span class="title function_">push</span>(object);</span><br><span class="line">	<span class="title function_">printMessage</span>(object);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//Private Method</span></span><br><span class="line">	<span class="keyword">function</span> <span class="title function_">printMessage</span>(<span class="params">object</span>)&#123;</span><br><span class="line">		<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Object successfully added:&quot;</span>,object);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//public members,exposed with return statement</span></span><br><span class="line">	<span class="keyword">return</span> &#123;</span><br><span class="line">		<span class="attr">addName</span>:addobject,</span><br><span class="line">	&#125;;</span><br><span class="line">&#125;)();</span><br><span class="line">namesCollection.<span class="title function_">addNwame</span>(<span class="string">&#x27;viking&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><strong>缺点</strong></p>
<ul>
<li>依赖全局变量，污染全局作用域，不安全</li>
<li>依赖约定命名空间来避免冲突，可靠性不高</li>
<li>需要手动管理依赖并控制执行顺序，容易出错</li>
<li>需要在最终上线前手动合并所有用到的模块</li>
</ul>
<h5 id="AMD-Asynchronous-module-definition"><a href="#AMD-Asynchronous-module-definition" class="headerlink" title="AMD - (Asynchronous module definition)"></a>AMD - (Asynchronous module definition)</h5><ul>
<li>采用异步方式加载模块</li>
<li>仅仅需要在全局环境定义require与define,不需要其他的全局变量</li>
<li>通过文件路径或模块自己声明的模块名定位模块</li>
<li>提供了打包工具自动分析依赖并合并</li>
<li>配合特定的AMD加载器使用，RequireJS</li>
<li>同时还诞生了很多类似的模块标准CMD</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">define</span>(<span class="keyword">function</span>(<span class="params"><span class="built_in">require</span></span>)&#123;</span><br><span class="line"><span class="comment">//通过相对路径获取依赖模块</span></span><br><span class="line">  <span class="keyword">const</span> bar = <span class="built_in">require</span>(<span class="string">&#x27;./bar&#x27;</span>)</span><br><span class="line"><span class="comment">//模块产出</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params"></span>)&#123;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<h5 id="ES6"><a href="#ES6" class="headerlink" title="ES6"></a>ES6</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//通过相对路径获取依赖模块</span></span><br><span class="line"><span class="keyword">import</span> bar <span class="keyword">from</span> <span class="string">&#x27;./bar&#x27;</span></span><br><span class="line"><span class="comment">//模块产出</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> (<span class="params"></span>)&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>引入和暴露的方式更加多样</li>
<li>支持复杂的静态分析</li>
</ul>
<h3 id="Bundler"><a href="#Bundler" class="headerlink" title="Bundler"></a>Bundler</h3><h4 id="诞生原因"><a href="#诞生原因" class="headerlink" title="诞生原因"></a>诞生原因</h4><p>使用import  export这种同步加载的方式在大多数浏览器中无法使用。</p>
<h4 id="是什么"><a href="#是什么" class="headerlink" title="是什么"></a>是什么</h4><ul>
<li>打包工具</li>
<li>将浏览器不支持的模块进行编译，转换，合并最后生成的代码可以在浏览器端良好的运行的工具。</li>
</ul>
<h4 id="Webpack"><a href="#Webpack" class="headerlink" title="Webpack"></a>Webpack</h4><p>对于web应用来说：一般采用单 Javascript 文件入口</p>
<h4 id="Rollup"><a href="#Rollup" class="headerlink" title="Rollup"></a>Rollup</h4><p>后起之秀的打包工具</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx rollup main.js --file dist/bundle.js --format iife</span><br></pre></td></tr></table></figure>







<h3 id="Vite的工作原理"><a href="#Vite的工作原理" class="headerlink" title="Vite的工作原理"></a>Vite的工作原理</h3><h4 id="解决的问题"><a href="#解决的问题" class="headerlink" title="解决的问题"></a>解决的问题</h4><p>​	大型应用使用webpack等传统bundler会遇到性能瓶颈：非常慢。Vite就使用浏览器发展中的新特性来解<br>决这个问题。</p>
<h4 id="Vite开发环境-—esbuild"><a href="#Vite开发环境-—esbuild" class="headerlink" title="Vite开发环境 —esbuild"></a>Vite开发环境 —esbuild</h4><p>Vite以原生ESM方式提供源码，这实际上是让浏览器接管了打包程序的部分工作。</p>
<p>处理方式</p>
<ul>
<li>依赖<ul>
<li>使用esbuild进行预构件，esbuild由go编写，比基于Node.js的工具要快10-100倍。<ul>
<li>处理CommonJS以及UMD类型文件的兼容性，转换为ESM以及ESM的导入形式。</li>
<li>提高性能，将多个模块合并成单个模块。因为原生ESM格式下，一个文件就是一次请求。</li>
<li>缓存，将预构建的依赖项缓存到node_modules&#x2F;.vite中。</li>
</ul>
</li>
</ul>
</li>
<li>源码<ul>
<li>包含一些非Javascript标准格式的文件，比如JSX&#x2F;CSS&#x2F;Vue等等，时常会被编辑。</li>
</ul>
</li>
</ul>
<p>esbuild速度对比</p>
<p><img src="/../images/Vue3_%E5%B0%81%E8%A3%85%E7%BB%84%E4%BB%B6%E5%BA%93%E9%A1%B9%E7%9B%AE/58.png"></p>
<h4 id="Vite生产环境-—Rollup"><a href="#Vite生产环境-—Rollup" class="headerlink" title="Vite生产环境 —Rollup"></a>Vite生产环境 —Rollup</h4><p>并没有使用es modules的格式，而是使用Rollup的形式构建。</p>
<p><strong>为什么？</strong><br>在生产环境中使用未打包的ESM仍然效率低下。Vite附带了一套已经内置的构建优化以及构件命令，可以做<br>到开箱即用。</p>
<p><strong>为什么使用Rollup,而没有选用上面说的ESBuild?</strong></p>
<p>Vite目前的插件API与使用<code>esbuild</code>作为打包器并不兼容。尽管<code>esbuild</code>速度更快，但Vite采用了<br>Rollup灵活的插件API和基础建设。</p>
<h4 id="Webpack打包流程"><a href="#Webpack打包流程" class="headerlink" title="Webpack打包流程"></a>Webpack打包流程</h4><p><img src="/../images/Vue3_%E5%B0%81%E8%A3%85%E7%BB%84%E4%BB%B6%E5%BA%93%E9%A1%B9%E7%9B%AE/56.png"></p>
<h4 id="ESM-打包流程"><a href="#ESM-打包流程" class="headerlink" title="ESM 打包流程"></a>ESM 打包流程</h4><p><img src="/../images/Vue3_%E5%B0%81%E8%A3%85%E7%BB%84%E4%BB%B6%E5%BA%93%E9%A1%B9%E7%9B%AE/57.png"></p>
<h3 id="打包什么类型的模块"><a href="#打包什么类型的模块" class="headerlink" title="打包什么类型的模块"></a>打包什么类型的模块</h3><p>结论</p>
<ul>
<li>首要格式 - ES modules,并且提供支持 typescript 的 type 文件。</li>
<li>备选方案 - UMD</li>
</ul>
<h3 id="Vue3的插件系统"><a href="#Vue3的插件系统" class="headerlink" title="Vue3的插件系统"></a>Vue3的插件系统</h3><h4 id="应用"><a href="#应用" class="headerlink" title="应用"></a>应用</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">ElementPlus</span> <span class="keyword">from</span> <span class="string">&#x27;element-plus&#x27;</span></span><br><span class="line"><span class="keyword">const</span> app =  <span class="title function_">createApp</span>(<span class="title class_">App</span>)</span><br><span class="line">app.<span class="title function_">use</span>(<span class="title class_">ElementPlus</span>)</span><br></pre></td></tr></table></figure>

<p>一段代码给<code>vue</code>应用实例添加全局功能。它的格式是一个 <code>object</code> 暴露出一个<code>install()</code>方法，或者一个<code>function</code></p>
<h4 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> myPlugin = &#123;</span><br><span class="line">	<span class="title function_">install</span>(<span class="params">app,options</span>)&#123;</span><br><span class="line">	<span class="comment">//配置此应用</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h4 id="功能"><a href="#功能" class="headerlink" title="功能"></a>功能</h4><p>插件没有严格的限制，一般有以下几种功能</p>
<ul>
<li>通过<code>app.component()</code>和<code>app.directive()</code>注册一到多个全局组件或自定义指令。</li>
<li>通过<code>app.provide()</code>使一个资源可被注入进整个应用。</li>
<li>向<code>app.config.globalProperties</code>中添加一些全局实例属性或方法</li>
</ul>
<h4 id="一个插件配置的例子"><a href="#一个插件配置的例子" class="headerlink" title="一个插件配置的例子"></a>一个插件配置的例子</h4><p><img src="/../images/Vue3_%E5%B0%81%E8%A3%85%E7%BB%84%E4%BB%B6%E5%BA%93%E9%A1%B9%E7%9B%AE/59.png"></p>
<h4 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h4><p><img src="/../images/Vue3_%E5%B0%81%E8%A3%85%E7%BB%84%E4%BB%B6%E5%BA%93%E9%A1%B9%E7%9B%AE/60.png"></p>
<h3 id="打包组件库"><a href="#打包组件库" class="headerlink" title="打包组件库"></a>打包组件库</h3><h4 id="Vite构建生产版本"><a href="#Vite构建生产版本" class="headerlink" title="Vite构建生产版本"></a>Vite构建生产版本</h4><p>当需要将应用部署到生产环境时，只需运行<code>vite build</code>命令。默认情况下，它使用<code>&lt;root&gt;/index.html</code>作为其构建入口点，并生成能够静态部署的应用程序包。</p>
<p><strong>自定义构建</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//vite.config.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">defineConfig</span>(&#123;</span><br><span class="line">	<span class="attr">build</span>: &#123;</span><br><span class="line">		<span class="attr">rollupOptions</span>:&#123;	</span><br><span class="line">			<span class="comment">//https://rollupjs.org/configuration-options/</span></span><br><span class="line">	&#125;,</span><br><span class="line">&#125;,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<h4 id="库模式"><a href="#库模式" class="headerlink" title="库模式"></a>库模式</h4><p><img src="/../images/Vue3_%E5%B0%81%E8%A3%85%E7%BB%84%E4%BB%B6%E5%BA%93%E9%A1%B9%E7%9B%AE/62.png"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">lib</span>: &#123;</span><br><span class="line">	<span class="comment">//入口文件</span></span><br><span class="line">	<span class="attr">entry</span>:<span class="title function_">resolve</span>(dirname,lib/main.<span class="property">js</span><span class="string">&#x27;),</span></span><br><span class="line"><span class="string">	// name则是暴露的全局变量，并且在 formats 包含&#x27;</span>umd<span class="string">&#x27;或&#x27;</span>iife<span class="string">&#x27;时是必需的。</span></span><br><span class="line"><span class="string">	name:&#x27;</span><span class="title class_">VElement</span><span class="string">&#x27;,</span></span><br><span class="line"><span class="string">	//是输出的包文件名，默认 fileName 是 package.json 的 name 选项</span></span><br><span class="line"><span class="string">	fileName:&#x27;</span>v-element<span class="string">&#x27;,</span></span><br><span class="line"><span class="string">	//默认formats是[&#x27;</span>es<span class="string">&#x27;,&#x27;</span>umd<span class="string">&#x27;],</span></span><br><span class="line"><span class="string">	formats:[&#x27;</span>es<span class="string">&#x27;]</span></span><br><span class="line"><span class="string">&#125;,</span></span><br></pre></td></tr></table></figure>





<h4 id="配置组件库的rollup"><a href="#配置组件库的rollup" class="headerlink" title="配置组件库的rollup"></a>配置组件库的rollup</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">build</span>: &#123;</span><br><span class="line">    <span class="attr">lib</span>: &#123;</span><br><span class="line">      <span class="attr">entry</span>: <span class="title function_">resolve</span>(__dirname, <span class="string">&#x27;src/index.ts&#x27;</span>),</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;VElement&#x27;</span>,</span><br><span class="line">      <span class="attr">fileName</span>: <span class="string">&#x27;v-element&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">rollupOptions</span>: &#123;</span><br><span class="line">      <span class="attr">external</span>: [<span class="string">&#x27;vue&#x27;</span>, <span class="string">&#x27;@fortawesome/fontawesome-svg-core&#x27;</span>, <span class="string">&#x27;@fortawesome/free-solid-svg-icons&#x27;</span>, <span class="string">&#x27;@fortawesome/vue-fontawesome&#x27;</span>],</span><br><span class="line">      <span class="attr">output</span>: &#123;</span><br><span class="line">        <span class="attr">exports</span>: <span class="string">&#x27;named&#x27;</span>,</span><br><span class="line">        <span class="attr">globals</span>: &#123;</span><br><span class="line">          <span class="attr">vue</span>: <span class="string">&#x27;Vue&#x27;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">assetFileNames</span>: <span class="function">(<span class="params">chunkInfo</span>) =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">if</span> (chunkInfo.<span class="property">name</span> === <span class="string">&#x27;style.css&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;index.css&#x27;</span></span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">return</span> chunkInfo.<span class="property">name</span> <span class="keyword">as</span> string</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>



<h4 id="生成类型定义文件"><a href="#生成类型定义文件" class="headerlink" title="生成类型定义文件"></a>生成类型定义文件</h4><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//tsconfig.build.json</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;extends&quot;</span><span class="punctuation">:</span> <span class="string">&quot;@vue/tsconfig/tsconfig.web.json&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;include&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;src/index.ts&quot;</span><span class="punctuation">,</span> <span class="string">&quot;src/components/**/*&quot;</span><span class="punctuation">,</span> <span class="string">&quot;src/hooks/**/*&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;compilerOptions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;baseUrl&quot;</span><span class="punctuation">:</span> <span class="string">&quot;.&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;paths&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;@/*&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;./src/*&quot;</span><span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;types&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;unplugin-vue-macros/macros-global&quot;</span> <span class="comment">/* ... */</span><span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;vueCompilerOptions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;plugins&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;@vue-macros/volar/define-model&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;@vue-macros/volar/define-props&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;@vue-macros/volar/define-props-refs&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;@vue-macros/volar/short-vmodel&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;@vue-macros/volar/define-slots&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;@vue-macros/volar/export-props&quot;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;references&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;path&quot;</span><span class="punctuation">:</span> <span class="string">&quot;./tsconfig.config.json&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//vite.config.ts</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> dts <span class="keyword">from</span> <span class="string">&#x27;vite-plugin-dts&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">dts</span>(&#123;</span><br><span class="line">      <span class="attr">tsconfigPath</span>: <span class="string">&#x27;./tsconfig.build.json&#x27;</span></span><br><span class="line">   &#125;)</span><br></pre></td></tr></table></figure>







<h4 id="生成样式文件"><a href="#生成样式文件" class="headerlink" title="生成样式文件"></a>生成样式文件</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//index.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; library &#125; <span class="keyword">from</span> <span class="string">&#x27;@fortawesome/fontawesome-svg-core&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; fas &#125; <span class="keyword">from</span> <span class="string">&#x27;@fortawesome/free-solid-svg-icons&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./styles/index.css&#x27;</span></span><br><span class="line">library.<span class="title function_">add</span>(fas)</span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">rollupOptions<span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="comment">//忽略后面的文件</span></span><br><span class="line">      external<span class="punctuation">:</span> <span class="punctuation">[</span>&#x27;vue&#x27;<span class="punctuation">,</span> &#x27;@fortawesome/fontawesome-svg-core&#x27;<span class="punctuation">,</span> &#x27;@fortawesome/free-solid-svg-icons&#x27;<span class="punctuation">,</span> &#x27;@fortawesome/vue-fontawesome&#x27;<span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">      output<span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        exports<span class="punctuation">:</span> &#x27;named&#x27;<span class="punctuation">,</span></span><br><span class="line">        globals<span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">          vue<span class="punctuation">:</span> &#x27;Vue&#x27;</span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        assetFileNames<span class="punctuation">:</span> (chunkInfo) =&gt; <span class="punctuation">&#123;</span></span><br><span class="line">          if (chunkInfo.name === &#x27;style.css&#x27;) <span class="punctuation">&#123;</span></span><br><span class="line">            return &#x27;index.css&#x27;</span><br><span class="line">          <span class="punctuation">&#125;</span></span><br><span class="line">          return chunkInfo.name as string</span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>



<h4 id="发布npm"><a href="#发布npm" class="headerlink" title="发布npm"></a>发布npm</h4><h5 id="NPM简介"><a href="#NPM简介" class="headerlink" title="NPM简介"></a><strong>NPM简介</strong></h5><p>允许用户从npm服务器下载别人编写的第三方包到本地使用。<br>允许用户从npm服务器下载并安装别人编写的命令行程序到本地使用。<br>允许用户将自己编写的包或命令行程序上传到npm服务器供别人使用。</p>
<p>一些常见命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#登陆，注意现在登陆都是有两步验证的，会发一个数字到你的邮箱去</span></span><br><span class="line">npm login</span><br><span class="line"><span class="comment">#注册或者使用 web界面 https://www.npmjs.com/signup</span></span><br><span class="line">npm adduser</span><br><span class="line"><span class="comment">#查看是否登陆</span></span><br><span class="line">npm <span class="built_in">whoami</span></span><br><span class="line"><span class="comment">#特别注意，关闭淘宝代理，要不操作会失败</span></span><br><span class="line">npm config <span class="built_in">ls</span></span><br></pre></td></tr></table></figure>



<h5 id="语义化版本"><a href="#语义化版本" class="headerlink" title="语义化版本"></a>语义化版本</h5><img src="../images/Vue3_封装组件库项目/65.png" style="zoom: 80%;">



<p>版本规则：<strong>Semver标准语义化版本</strong><br><a target="_blank" rel="noopener" href="https://semver.org/lang/zh-CN/">https://semver.org/lang/zh-CN/</a><br>1.主版本号：当你做了不兼容的API修改，<br>2.次版本号：当你做了向下兼容的功能性新增，<br>3.修订号：当你做了向下兼容的问题修正。</p>
<p>package,json所有信息<br><a target="_blank" rel="noopener" href="https://docs.npmjs.com/cli/v10/configuring-npm/package-json">https://docs.npmjs.com/cli/v10/configuring-npm/package-json</a></p>
<img src="../images/Vue3_封装组件库项目/66.png" style="zoom: 80%;">





<h5 id="Pre-Post-scripts"><a href="#Pre-Post-scripts" class="headerlink" title="Pre&amp;Post scripts"></a>Pre&amp;Post scripts</h5><p>你script的名称前面加上pre或者post,那么当运行这个命令的时候，pre和post会自动在这个命令之前<br>或者之后运行。</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;precompress&quot;</span><span class="punctuation">:</span><span class="string">&quot;&#123;executes BEFORE the compress script &#125;&#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;compress&quot;</span><span class="punctuation">:</span><span class="string">&quot;&#123;run command to compress files &#125;&#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;postcompress&quot;</span><span class="punctuation">:</span><span class="string">&quot;&#123;executes AFTER compress script &#125;&#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>

<h5 id="Life-Cycle-Scripts"><a href="#Life-Cycle-Scripts" class="headerlink" title="Life Cycle Scripts"></a>Life Cycle Scripts</h5><p>prepare</p>
<ul>
<li>​	在package被packed之前运行。</li>
<li>​	在packge被published之前运行。</li>
<li>​	在npm install的时候运行。</li>
</ul>
<p>prepublish(即将废弃)</p>
<p><strong>prePublishOnly</strong></p>
<h5 id="npm-publish会触发的hooks"><a href="#npm-publish会触发的hooks" class="headerlink" title="npm publish会触发的hooks"></a>npm publish会触发的hooks</h5><p>-<br>  prepublishonly</p>
<ul>
<li>prepare</li>
<li>prepublish</li>
<li>publish</li>
<li>postpublish</li>
</ul>
<h5 id="npm命名空间"><a href="#npm命名空间" class="headerlink" title="npm命名空间"></a>npm命名空间</h5><ul>
<li>@vikingmute&#x2F;XxXx</li>
<li>前面的是命名空间名称，后面的是具体的包名。</li>
<li>命名空间通常用于避免包名冲突，并提供更好的包管理和组织，同时也可以提供更好的可读性和包的可发现性。</li>
<li>使用命名空间需要带特定参数，也就是公开，因为这个功能默认是private的并且收费的。公开就没有问题。</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm publish --access public</span><br></pre></td></tr></table></figure>



<h5 id="发布成功"><a href="#发布成功" class="headerlink" title="发布成功"></a>发布成功</h5><img src="../images/Vue3_封装组件库项目/63.png">

<img src="../images/Vue3_封装组件库项目/64.png">





<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><ul>
<li>Javascript模块化发展的历史<ul>
<li>全局变量</li>
<li>common.js &#x2F; AMD &#x2F; UMD</li>
<li>ES6 modules</li>
</ul>
</li>
<li>Bunder的功能和作用<ul>
<li>Vite (Rollup+ESBuild) 在 dev 和 build 的过程为什么这么不同</li>
<li>Webpack</li>
</ul>
</li>
<li>确定要打包生成的代码格式：ES+UMD</li>
<li>Vue3的插件系统<ul>
<li>Vue3的插件的格式</li>
<li>改造组件库的入口文件</li>
</ul>
</li>
<li>使用Vite进行打包<ul>
<li>Rollup 的概念和简单使用</li>
<li>使用Vite内置的build模式以及库模式进行打包</li>
<li>生成typescript定义文件</li>
<li>生成样式文件</li>
<li>优化生成文件，根据不同格式 ( es &#x2F; umd ) 分离打包脚本</li>
<li>优化 package.json的字段</li>
<li>使用 npm link 进行本地测试</li>
</ul>
</li>
<li>使用npm进行发布<ul>
<li>简介 npm 以及完成注册</li>
<li>使用 npm scripts 钩子函数 (prePublishOnly) 进行发布前 build</li>
<li>发布 npm 成功</li>
</ul>
</li>
</ul>
<h2 id="项目难点"><a href="#项目难点" class="headerlink" title="项目难点:"></a>项目难点:</h2><p>一、在tooltip和dropdown 选择了两种截然不同的开发方式表示菜单选项</p>
<p>1.使用语义化结构开发  –tooltip 新建一个对应组件并且使用slot来实现复杂结构</p>
<p>2.使用JavaScript数据结构开发  —dropdown  传入一个数组，也就是传入一个JavaScript Object</p>
<p>各有利弊，选择自己更擅长，更符合直觉的</p>
<p>JSX 和 渲染函数可聊</p>
<p>二、Message一大章可聊</p>
<p>三、表单作为难点一大章可聊</p>
<p>1.input组件 使用测试TDD的开发方式开发组件</p>
<p>2.form的数据传递和表单验证</p>
<p>3.Select的远程请求部分</p>
<p><strong>组件开发的方法论</strong></p>
<ul>
<li>根据需求初步确定属性&#x2F;事件&#x2F;slots&#x2F;expose  (不需要特别精确，后期随着功能开发可以持续更新)</li>
<li>组件的静态版本（不加交互，只有html结构，classes,slots)</li>
<li>将需求中有行为的功能做成开发计划列表</li>
<li>根据列表一项项完成功能</li>
<li>样式&#x2F;测试等收尾工作</li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://example.com">黑板擦</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2024/03/07/Vue3-TS%E5%B0%81%E8%A3%85%E7%BB%84%E4%BB%B6%E5%BA%93%E9%A1%B9%E7%9B%AE/">http://example.com/2024/03/07/Vue3-TS%E5%B0%81%E8%A3%85%E7%BB%84%E4%BB%B6%E5%BA%93%E9%A1%B9%E7%9B%AE/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">我在看着你</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="/./img/Snipaste_2024-04-06_01-13-21.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/03/12/express%E5%AD%A6%E4%B9%A0/" title="Express学习"><img class="cover" src="/./img/Snipaste_2024-04-06_01-13-21.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Express学习</div></div></a></div><div class="next-post pull-right"><a href="/2024/03/07/Vue3%E5%AD%A6%E4%B9%A0-%E7%BB%93%E5%90%88TS%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" title="Vue3(结合TS基础知识)"><img class="cover" src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Vue3(结合TS基础知识)</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/./img/Snipaste_2024-04-06_01-08-30.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">黑板擦</div><div class="author-info__description">别看我</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">47</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">23</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">19</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Yukino013" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:1291469690@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.</span> <span class="toc-text">1.介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E9%A1%B9%E7%9B%AE%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84"><span class="toc-number">2.</span> <span class="toc-text">2.项目文件结构</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%80%93save-dev-%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="toc-number">2.0.1.</span> <span class="toc-text">–save-dev 的作用</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-Button%E7%BB%84%E4%BB%B6"><span class="toc-number">3.</span> <span class="toc-text">3.Button组件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90"><span class="toc-number">3.1.</span> <span class="toc-text">(1)需求分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E4%BB%A3%E7%A0%81%E7%BC%96%E5%86%99"><span class="toc-number">3.2.</span> <span class="toc-text">(2)代码编写</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%AF%BC%E5%85%A5%E6%8E%A5%E5%8F%A3%E9%97%AE%E9%A2%98"><span class="toc-number">3.2.1.</span> <span class="toc-text">1.导入接口问题</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-defineProps%E2%80%93%E4%B8%BA%E7%BB%84%E4%BB%B6%E7%9A%84-props-%E6%A0%87%E6%B3%A8%E7%B1%BB%E5%9E%8B"><span class="toc-number">3.2.2.</span> <span class="toc-text">2.defineProps–为组件的 props 标注类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-withDefaults%E2%80%93%E4%B8%BA-props-%E5%A3%B0%E6%98%8E%E9%BB%98%E8%AE%A4%E5%80%BC"><span class="toc-number">3.2.3.</span> <span class="toc-text">3.withDefaults–为 props 声明默认值</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-defineExpose"><span class="toc-number">3.2.4.</span> <span class="toc-text">4.defineExpose</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-PropType"><span class="toc-number">3.2.5.</span> <span class="toc-text">5.PropType</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-defineOptions"><span class="toc-number">3.2.6.</span> <span class="toc-text">6.defineOptions</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-CSS%E6%96%B9%E6%A1%88-PostCSS"><span class="toc-number">3.2.7.</span> <span class="toc-text">7.CSS方案_PostCSS</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-CSS-Modules%E4%BD%BF%E7%94%A8"><span class="toc-number">3.2.8.</span> <span class="toc-text">8.CSS Modules使用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-%E8%89%B2%E5%BD%A9%E7%B3%BB%E7%BB%9F"><span class="toc-number">3.2.9.</span> <span class="toc-text">9.色彩系统</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Button%E6%80%BB%E7%BB%93"><span class="toc-number">3.3.</span> <span class="toc-text">(3)Button总结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-Collapse%E7%BB%84%E4%BB%B6"><span class="toc-number">4.</span> <span class="toc-text">4.Collapse组件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90-1"><span class="toc-number">4.1.</span> <span class="toc-text">(1)需求分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E4%BB%A3%E7%A0%81%E7%BC%96%E5%86%99-1"><span class="toc-number">4.2.</span> <span class="toc-text">(2)代码编写</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E7%A1%AE%E5%AE%9A%E5%B1%9E%E6%80%A7"><span class="toc-number">4.2.1.</span> <span class="toc-text">1.确定属性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E7%A1%AE%E5%AE%9A%E4%BA%8B%E4%BB%B6"><span class="toc-number">4.2.2.</span> <span class="toc-text">2.确定事件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E6%80%9D%E8%B7%AF%E5%88%86%E6%9E%90"><span class="toc-number">4.2.3.</span> <span class="toc-text">3.思路分析</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-BEM%E6%A0%B7%E5%BC%8F%E8%AF%AD%E6%B3%95"><span class="toc-number">4.2.4.</span> <span class="toc-text">4.BEM样式语法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-InjectionKey"><span class="toc-number">4.2.5.</span> <span class="toc-text">5.InjectionKey</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-Transition"><span class="toc-number">4.2.6.</span> <span class="toc-text">6.Transition</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-Record"><span class="toc-number">4.2.7.</span> <span class="toc-text">7.Record</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Collapse%E6%80%BB%E7%BB%93"><span class="toc-number">4.3.</span> <span class="toc-text">(3)Collapse总结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-Icon%E7%BB%84%E4%BB%B6"><span class="toc-number">5.</span> <span class="toc-text">5.Icon组件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90-2"><span class="toc-number">5.1.</span> <span class="toc-text">(1)需求分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E4%BB%A3%E7%A0%81%E7%BC%96%E5%86%99-2"><span class="toc-number">5.2.</span> <span class="toc-text">(2)代码编写</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-Inline-SVG-vs-Font-Icon"><span class="toc-number">5.2.1.</span> <span class="toc-text">1.Inline SVG vs Font Icon</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E7%8E%B0%E6%88%90%E7%9A%84%E5%9B%BE%E6%A0%87%E5%BA%93"><span class="toc-number">5.2.2.</span> <span class="toc-text">2.现成的图标库</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E5%AE%89%E8%A3%85svg"><span class="toc-number">5.2.3.</span> <span class="toc-text">3.安装svg</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E5%AF%BC%E5%85%A5%E7%BB%84%E4%BB%B6%E5%BA%93"><span class="toc-number">5.2.4.</span> <span class="toc-text">4.导入组件库</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-%E7%A6%81%E7%94%A8%E9%80%8F%E4%BC%A0"><span class="toc-number">5.2.5.</span> <span class="toc-text">5.禁用透传</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-%E5%AF%BC%E5%85%A5lodash-es%E7%9A%84omit%E7%94%A8%E4%BD%9C%E8%BF%87%E6%BB%A4%E5%99%A8"><span class="toc-number">5.2.6.</span> <span class="toc-text">6.导入lodash-es的omit用作过滤器</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Icon%E6%80%BB%E7%BB%93"><span class="toc-number">5.3.</span> <span class="toc-text">(3)Icon总结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-Alert%E7%BB%84%E4%BB%B6"><span class="toc-number">6.</span> <span class="toc-text">6.Alert组件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90-3"><span class="toc-number">6.1.</span> <span class="toc-text">(1)需求分析</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E7%BB%84%E4%BB%B6%E6%B5%8B%E8%AF%95"><span class="toc-number">7.</span> <span class="toc-text">7.组件测试</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E6%9C%89%E6%B5%8B%E8%AF%95"><span class="toc-number">7.1.</span> <span class="toc-text">为什么要有测试</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%87%BA%E7%8E%B0%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-number">7.1.1.</span> <span class="toc-text">出现的问题</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95%E5%9C%A8%E5%9B%BD%E5%86%85%E8%A2%AB%E4%B8%A5%E9%87%8D%E5%BF%BD%E8%A7%86"><span class="toc-number">7.1.2.</span> <span class="toc-text">测试在国内被严重忽视</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95%E7%9A%84%E4%BC%98%E7%82%B9"><span class="toc-number">7.1.3.</span> <span class="toc-text">测试的优点</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6%E5%8C%96%E7%9A%84%E6%A1%86%E6%9E%B6-Vue%EF%BC%8CReact-%E9%9D%9E%E5%B8%B8%E9%80%82%E5%90%88%E5%86%99%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95"><span class="toc-number">7.2.</span> <span class="toc-text">组件化的框架(Vue，React)非常适合写单元测试</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95%E6%A1%86%E6%9E%B6Vitest%E7%AE%80%E4%BB%8B"><span class="toc-number">7.3.</span> <span class="toc-text">测试框架Vitest简介</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9C%80%E8%A6%81%E9%80%89%E5%8F%96%E4%B8%A4%E7%A7%8D%E6%B5%8B%E8%AF%95%E5%B7%A5%E5%85%B7"><span class="toc-number">7.3.1.</span> <span class="toc-text">需要选取两种测试工具</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%9A%E7%94%A8%E6%B5%8B%E8%AF%95%E6%A1%86%E6%9E%B6"><span class="toc-number">7.3.2.</span> <span class="toc-text">通用测试框架</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Vitest%E7%9A%84%E4%BC%98%E7%82%B9"><span class="toc-number">7.3.3.</span> <span class="toc-text">Vitest的优点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95%E6%A1%86%E6%9E%B6%E7%9A%84%E5%87%A0%E5%A4%A7%E5%8A%9F%E8%83%BD"><span class="toc-number">7.3.4.</span> <span class="toc-text">测试框架的几大功能</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%89%E8%A3%85Vitest"><span class="toc-number">7.3.5.</span> <span class="toc-text">安装Vitest</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95%E6%96%B9%E6%B3%95"><span class="toc-number">7.3.6.</span> <span class="toc-text">测试方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Vitest%E7%9A%84vi%E7%94%A8%E6%B3%95"><span class="toc-number">7.3.7.</span> <span class="toc-text">Vitest的vi用法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Vitest%E7%9A%84describe%E7%94%A8%E6%B3%95"><span class="toc-number">7.3.8.</span> <span class="toc-text">Vitest的describe用法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Vitest%E7%9A%84expect%E7%94%A8%E6%B3%95"><span class="toc-number">7.3.9.</span> <span class="toc-text">Vitest的expect用法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95%E5%AE%9E%E7%94%A8%E5%B7%A5%E5%85%B7%E5%BA%93-Vue-test-utils"><span class="toc-number">7.4.</span> <span class="toc-text">单元测试实用工具库 Vue-test-utils</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Vnode%E4%BB%A5%E5%8F%8ARender-Function"><span class="toc-number">7.5.</span> <span class="toc-text">Vnode以及Render Function</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%99%9A%E6%8B%9FDOM%E7%9A%84%E4%BC%98%E7%82%B9"><span class="toc-number">7.5.1.</span> <span class="toc-text">虚拟DOM的优点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9B%E5%BB%BAVnode"><span class="toc-number">7.5.2.</span> <span class="toc-text">创建Vnode</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95%E4%BA%8B%E4%BB%B6"><span class="toc-number">7.5.3.</span> <span class="toc-text">测试事件</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Render-Pipeline"><span class="toc-number">7.6.</span> <span class="toc-text">Render Pipeline</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6%E6%B5%8B%E8%AF%95%E6%80%BB%E7%BB%93"><span class="toc-number">7.7.</span> <span class="toc-text">组件测试总结</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Vue%E6%B5%8B%E8%AF%95%E6%A1%86%E6%9E%B6-vue-test-utils"><span class="toc-number">7.7.1.</span> <span class="toc-text">Vue测试框架-vue-test-utils</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#VNode%E4%BB%A5%E5%8F%8ARender"><span class="toc-number">7.7.2.</span> <span class="toc-text">VNode以及Render</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#vitest%E9%92%A9%E5%AD%90%E5%87%BD%E6%95%B0%E5%8F%8A%E5%85%B6%E4%BB%96"><span class="toc-number">7.7.3.</span> <span class="toc-text">vitest钩子函数及其他</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%AF%E8%BF%9B%E6%AD%A5%E7%9A%84"><span class="toc-number">7.7.4.</span> <span class="toc-text">可进步的</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-Tooltip%E7%BB%84%E4%BB%B6"><span class="toc-number">8.</span> <span class="toc-text">8.Tooltip组件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90-4"><span class="toc-number">8.1.</span> <span class="toc-text">(1)需求分析</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8A%9F%E8%83%BD%E5%88%86%E6%9E%90"><span class="toc-number">8.1.1.</span> <span class="toc-text">功能分析</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B1%95%E7%A4%BA%E6%96%B9%E6%A1%88"><span class="toc-number">8.1.2.</span> <span class="toc-text">展示方案</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B1%9E%E6%80%A7"><span class="toc-number">8.1.3.</span> <span class="toc-text">属性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%8B%E4%BB%B6"><span class="toc-number">8.1.4.</span> <span class="toc-text">事件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B"><span class="toc-number">8.1.5.</span> <span class="toc-text">实例</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8A%A8%E6%80%81%E4%BA%8B%E4%BB%B6%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88"><span class="toc-number">8.1.6.</span> <span class="toc-text">动态事件的解决方案</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E4%BB%A3%E7%A0%81%E7%BC%96%E5%86%99-3"><span class="toc-number">8.2.</span> <span class="toc-text">(2)代码编写</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-Tooltip%E5%BC%80%E5%8F%91%E8%AE%A1%E5%88%92"><span class="toc-number">8.2.1.</span> <span class="toc-text">1.Tooltip开发计划</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E4%BD%BF%E7%94%A8%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93-popper-js"><span class="toc-number">8.2.2.</span> <span class="toc-text">2.使用第三方库 popper.js</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-defineProps-%E5%92%8C-defineEmits"><span class="toc-number">8.2.3.</span> <span class="toc-text">3.defineProps() 和 defineEmits()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-slot"><span class="toc-number">8.2.4.</span> <span class="toc-text">4.slot</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Tooltip%E6%80%BB%E7%BB%93"><span class="toc-number">8.3.</span> <span class="toc-text">(3)Tooltip总结</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Tooltip%E5%88%86%E6%9E%90"><span class="toc-number">8.3.1.</span> <span class="toc-text">Tooltip分析</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Tooltip%E5%BC%80%E5%8F%91"><span class="toc-number">8.3.2.</span> <span class="toc-text">Tooltip开发</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E6%B5%8B%E8%AF%95"><span class="toc-number">8.3.3.</span> <span class="toc-text">添加测试</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-Dropdown%E7%BB%84%E4%BB%B6"><span class="toc-number">9.</span> <span class="toc-text">9.Dropdown组件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90-5"><span class="toc-number">9.1.</span> <span class="toc-text">(1)需求分析</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B1%95%E7%A4%BA%E6%96%B9%E6%A1%88-1"><span class="toc-number">9.1.1.</span> <span class="toc-text">展示方案</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B1%9E%E6%80%A7-1"><span class="toc-number">9.1.2.</span> <span class="toc-text">属性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%8B%E4%BB%B6-1"><span class="toc-number">9.1.3.</span> <span class="toc-text">事件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B-1"><span class="toc-number">9.1.4.</span> <span class="toc-text">实例</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E4%BB%A3%E7%A0%81%E7%BC%96%E5%86%99-4"><span class="toc-number">9.2.</span> <span class="toc-text">(2)代码编写</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-Render-Function"><span class="toc-number">9.2.1.</span> <span class="toc-text">1.Render Function</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-Fragment"><span class="toc-number">9.2.2.</span> <span class="toc-text">2.Fragment</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Dropdown%E6%80%BB%E7%BB%93"><span class="toc-number">9.3.</span> <span class="toc-text">(3)Dropdown总结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-Message%E7%BB%84%E4%BB%B6"><span class="toc-number">10.</span> <span class="toc-text">10.Message组件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90-6"><span class="toc-number">10.1.</span> <span class="toc-text">(1)需求分析</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8A%9F%E8%83%BD%E5%88%86%E6%9E%90-1"><span class="toc-number">10.1.1.</span> <span class="toc-text">功能分析</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9A%BE%E7%82%B9"><span class="toc-number">10.1.2.</span> <span class="toc-text">难点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B1%9E%E6%80%A7%E5%88%86%E6%9E%90"><span class="toc-number">10.1.3.</span> <span class="toc-text">属性分析</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%8B%E4%BB%B6%E4%BB%A5%E5%8F%8A%E5%AE%9E%E4%BE%8B"><span class="toc-number">10.1.4.</span> <span class="toc-text">事件以及实例</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E4%BB%A3%E7%A0%81%E7%BC%96%E5%86%99-5"><span class="toc-number">10.2.</span> <span class="toc-text">(2)代码编写</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%B0%86%E7%BB%84%E4%BB%B6Render%E5%88%B0DOM%E8%8A%82%E7%82%B9%E4%B8%8A"><span class="toc-number">10.2.1.</span> <span class="toc-text">1.将组件Render到DOM节点上</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-v-show-%E9%9A%90%E8%97%8F%E8%8A%82%E7%82%B9%E5%90%8E%E6%B8%85%E9%99%A4%E8%8A%82%E7%82%B9-%E8%AF%A5%E8%8A%82%E7%82%B9%E5%B7%B2%E7%BB%8F%E6%8C%82%E8%BD%BD%E5%AE%9E%E4%BE%8B"><span class="toc-number">10.2.2.</span> <span class="toc-text">2.v-show 隐藏节点后清除节点(该节点已经挂载实例)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E9%80%9A%E8%BF%87%E4%BD%BF%E7%94%A8%E4%B8%80%E4%B8%AA%E6%95%B0%E7%BB%84%E6%9D%A5%E5%AE%9E%E7%8E%B0%E8%8E%B7%E5%8F%96%E5%90%8C%E4%B8%80%E4%B8%AA%E7%BB%84%E4%BB%B6%E4%B8%8D%E5%90%8C%E5%AE%9E%E4%BE%8B%E7%9A%84%E5%86%85%E5%AE%B9"><span class="toc-number">10.2.3.</span> <span class="toc-text">3.通过使用一个数组来实现获取同一个组件不同实例的内容</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E6%97%A7%E6%8F%90%E7%A4%BA%E5%8F%AF%E4%BB%A5%E6%A0%B9%E6%8D%AE%E6%96%B0%E6%8F%90%E7%A4%BA%E5%90%91%E4%B8%8B%E7%A7%BB%E5%8A%A8%E4%BD%8D%E7%BD%AE"><span class="toc-number">10.2.4.</span> <span class="toc-text">4.旧提示可以根据新提示向下移动位置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-%E6%80%8E%E4%B9%88%E5%9C%A8%E7%BB%84%E4%BB%B6%E5%A4%96%E9%83%A8%E8%8E%B7%E5%8F%96%E6%9A%B4%E9%9C%B2%E5%87%BA%E5%8E%BB%E7%9A%84bottomOffset"><span class="toc-number">10.2.5.</span> <span class="toc-text">5.怎么在组件外部获取暴露出去的bottomOffset</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-%E9%80%9A%E8%BF%87VNode%E6%8B%BF%E5%88%B0%E7%BB%84%E4%BB%B6%E5%AE%9E%E4%BE%8B"><span class="toc-number">10.2.6.</span> <span class="toc-text">6.通过VNode拿到组件实例</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-shallowReavtive"><span class="toc-number">10.2.7.</span> <span class="toc-text">7.shallowReavtive</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-%E6%89%8B%E5%8A%A8%E8%B0%83%E7%94%A8%E5%88%A0%E9%99%A4"><span class="toc-number">10.2.8.</span> <span class="toc-text">8.手动调用删除</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-%E6%B7%BB%E5%8A%A0zIndex"><span class="toc-number">10.2.9.</span> <span class="toc-text">9.添加zIndex</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10-%E6%B7%BB%E5%8A%A0%E9%94%AE%E7%9B%98%E5%85%B3%E9%97%AD%EF%BC%88%E6%8C%89esc%E5%8F%AF%E4%BB%A5%E5%85%B3%E9%97%ADmessage"><span class="toc-number">10.2.10.</span> <span class="toc-text">10.添加键盘关闭（按esc可以关闭message)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#11-hover%E5%88%B0Message%E4%B8%8A%E9%9D%A2%E7%9A%84%E6%97%B6%E5%80%99%E4%B8%8D%E4%BC%9A%E8%87%AA%E5%8A%A8%E5%85%B3%E9%97%AD"><span class="toc-number">10.2.11.</span> <span class="toc-text">11.hover到Message上面的时候不会自动关闭</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#12-%E6%B7%BB%E5%8A%A0%E5%8A%A8%E7%94%BB%E4%BB%A5%E5%8F%8A%E6%A0%B7%E5%BC%8F"><span class="toc-number">10.2.12.</span> <span class="toc-text">12.添加动画以及样式</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Message%E6%80%BB%E7%BB%93"><span class="toc-number">10.3.</span> <span class="toc-text">(3)Message总结</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%87%BD%E6%95%B0%E5%BC%8F%E7%9A%84%E6%96%B9%E5%BC%8F%E5%88%9B%E5%BB%BA%E7%BB%84%E4%BB%B6"><span class="toc-number">10.3.1.</span> <span class="toc-text">使用函数式的方式创建组件</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-%E6%9B%B4%E5%A5%BD%E7%9A%84%E5%B1%95%E7%A4%BA%E5%B7%A5%E5%85%B7VitePress-%E4%BD%BF%E7%94%A8%E5%B7%A5%E5%85%B7%E7%94%9F%E6%88%90%E6%96%87%E6%A1%A3"><span class="toc-number">11.</span> <span class="toc-text">11.更好的展示工具VitePress-使用工具生成文档</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%88%9B%E5%BB%BA%E6%94%BE%E5%9C%A8-docs%E6%96%87%E4%BB%B6%E5%A4%B9%E4%B8%8B"><span class="toc-number">11.0.1.</span> <span class="toc-text">1.创建放在.&#x2F;docs文件夹下</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%9C%A8-gitignore%E6%B7%BB%E5%8A%A0-vitepress-dist%E9%9D%99%E6%80%81%E6%96%87%E4%BB%B6%E5%92%8C-vitepress-cache%E7%BC%93%E5%AD%98%E6%96%87%E4%BB%B6"><span class="toc-number">11.0.2.</span> <span class="toc-text">2.在.gitignore添加.vitepress&#x2F;dist静态文件和.&#x2F;vitepress&#x2F;cache缓存文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E6%96%87%E4%BB%B6%E5%A4%B9%E7%BB%93%E6%9E%84"><span class="toc-number">11.0.3.</span> <span class="toc-text">3.文件夹结构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-npm-run-doc-dev"><span class="toc-number">11.0.4.</span> <span class="toc-text">3.npm run doc:dev</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-Markdown-Extension-Examples"><span class="toc-number">11.0.5.</span> <span class="toc-text">4.Markdown Extension Examples</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-%E8%B7%AF%E7%94%B1%E7%B3%BB%E7%BB%9F"><span class="toc-number">11.0.6.</span> <span class="toc-text">5.路由系统</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-%E4%B8%A4%E4%B8%AA%E5%85%B3%E4%BA%8E%E8%B7%AF%E5%BE%84%E7%9A%84%E6%A6%82%E5%BF%B5"><span class="toc-number">11.0.7.</span> <span class="toc-text">6.两个关于路径的概念</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-%E5%9C%A8md%E6%96%87%E4%BB%B6%E4%B8%AD%E5%86%99vue%E7%BB%84%E4%BB%B6%E5%86%99%E6%B3%95%EF%BC%8C%E5%AE%8C%E5%85%A8%E4%B8%8D%E5%86%B2%E7%AA%81%EF%BC%8C%E6%94%AF%E6%8C%81"><span class="toc-number">11.0.8.</span> <span class="toc-text">7.在md文件中写vue组件写法，完全不冲突，支持</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-preview-demo%E5%AE%9E%E7%8E%B0%E7%BB%84%E4%BB%B6%E5%92%8C%E4%BB%A3%E7%A0%81%E6%98%BE%E7%A4%BA"><span class="toc-number">11.0.9.</span> <span class="toc-text">8.preview-demo实现组件和代码显示</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-%E8%87%AA%E5%AE%9A%E4%B9%89%E4%B8%BB%E9%A2%98%E9%A2%9C%E8%89%B2"><span class="toc-number">11.0.10.</span> <span class="toc-text">9.自定义主题颜色</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10-%E4%B8%BA%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83%E6%89%93%E5%8C%85%E5%B9%B6%E4%B8%94%E9%83%A8%E7%BD%B2"><span class="toc-number">11.0.11.</span> <span class="toc-text">10.为生产环境打包并且部署</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-Input%E7%BB%84%E4%BB%B6"><span class="toc-number">12.</span> <span class="toc-text">12.Input组件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90-7"><span class="toc-number">12.1.</span> <span class="toc-text">(1) 需求分析</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B1%9E%E6%80%A7-2"><span class="toc-number">12.1.1.</span> <span class="toc-text">属性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%8B%E4%BB%B6-2"><span class="toc-number">12.1.2.</span> <span class="toc-text">事件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Slots"><span class="toc-number">12.1.3.</span> <span class="toc-text">Slots</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Expose"><span class="toc-number">12.1.4.</span> <span class="toc-text">Expose</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E4%BB%A3%E7%A0%81%E7%BC%96%E5%86%99-6"><span class="toc-number">12.2.</span> <span class="toc-text">(2) 代码编写</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E7%BC%96%E5%86%99%E6%B5%8B%E8%AF%95%E7%94%A8%E4%BE%8B%E6%9D%A5%E9%AA%8C%E8%AF%81%E9%9D%99%E6%80%81%E7%BB%93%E6%9E%84%E6%98%AF%E5%90%A6%E6%AD%A3%E7%A1%AE"><span class="toc-number">12.2.1.</span> <span class="toc-text">1.编写测试用例来验证静态结构是否正确</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-TDD%E7%9A%84%E5%BC%80%E5%8F%91%E6%96%B9%E5%BC%8F"><span class="toc-number">12.2.2.</span> <span class="toc-text">2.TDD的开发方式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E6%94%AF%E6%8C%81-v-model-%E7%9A%84%E6%B5%8B%E8%AF%95%E7%94%A8%E4%BE%8B%E5%92%8C%E5%AE%9E%E7%8E%B0"><span class="toc-number">12.2.3.</span> <span class="toc-text">3.支持 v-model 的测试用例和实现</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E6%94%AF%E6%8C%81%E6%8C%89%E9%92%AE%E6%B8%85%E7%A9%BA%E5%BD%93%E5%89%8D%E6%96%87%E6%9C%AC%E7%9A%84%E6%B5%8B%E8%AF%95%E7%94%A8%E4%BE%8B%E5%92%8C%E5%AE%9E%E7%8E%B0"><span class="toc-number">12.2.4.</span> <span class="toc-text">4.支持按钮清空当前文本的测试用例和实现</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-%E6%94%AF%E6%8C%81%E5%AF%86%E7%A0%81%E5%88%87%E6%8D%A2%E7%9A%84%E6%B5%8B%E8%AF%95%E7%94%A8%E4%BE%8B%E5%92%8C%E5%AE%9E%E7%8E%B0"><span class="toc-number">12.2.5.</span> <span class="toc-text">5.支持密码切换的测试用例和实现</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-%E6%94%AF%E6%8C%81%E4%BA%8B%E4%BB%B6"><span class="toc-number">12.2.6.</span> <span class="toc-text">6.支持事件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-%E7%BB%84%E4%BB%B6%E6%B7%BB%E5%8A%A0%E5%8E%9F%E7%94%9F%E4%BA%8B%E4%BB%B6"><span class="toc-number">12.2.7.</span> <span class="toc-text">7.组件添加原生事件</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Input%E6%80%BB%E7%BB%93"><span class="toc-number">12.3.</span> <span class="toc-text">(3) Input总结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-Switch%E7%BB%84%E4%BB%B6"><span class="toc-number">13.</span> <span class="toc-text">13.Switch组件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90-8"><span class="toc-number">13.1.</span> <span class="toc-text">(1) 需求分析</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8D%E5%90%8C%E5%AF%BB%E5%B8%B8"><span class="toc-number">13.1.1.</span> <span class="toc-text">不同寻常</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B1%9E%E6%80%A7-3"><span class="toc-number">13.1.2.</span> <span class="toc-text">属性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%8B%E4%BB%B6-3"><span class="toc-number">13.1.3.</span> <span class="toc-text">事件</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E4%BB%A3%E7%A0%81%E7%BC%96%E5%86%99-7"><span class="toc-number">13.2.</span> <span class="toc-text">(2) 代码编写</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E7%BB%84%E4%BB%B6%E6%A0%B7%E5%BC%8F%E8%AE%BE%E8%AE%A1"><span class="toc-number">13.2.1.</span> <span class="toc-text">1.组件样式设计</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E6%A0%B7%E5%BC%8F%E7%BC%96%E5%86%99"><span class="toc-number">13.2.2.</span> <span class="toc-text">2.样式编写</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E6%94%AF%E6%8C%81v-model"><span class="toc-number">13.2.3.</span> <span class="toc-text">3.支持v-model</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E6%94%AF%E6%8C%81%E8%87%AA%E5%AE%9A%E4%B9%89value%E7%B1%BB%E5%9E%8B"><span class="toc-number">13.2.4.</span> <span class="toc-text">4.支持自定义value类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-%E6%94%AF%E6%8C%81%E6%96%87%E5%AD%97%E6%8F%8F%E8%BF%B0"><span class="toc-number">13.2.5.</span> <span class="toc-text">5.支持文字描述</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-%E6%94%AF%E6%8C%81%E6%97%A0%E9%9A%9C%E7%A2%8D"><span class="toc-number">13.2.6.</span> <span class="toc-text">6.支持无障碍</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Switch-%E6%80%BB%E7%BB%93"><span class="toc-number">13.3.</span> <span class="toc-text">(3) Switch 总结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14-Select-%E7%BB%84%E4%BB%B6"><span class="toc-number">14.</span> <span class="toc-text">14.Select 组件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90-9"><span class="toc-number">14.1.</span> <span class="toc-text">(1) 需求分析</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%93%E6%9E%84%E5%88%86%E6%9E%90"><span class="toc-number">14.1.1.</span> <span class="toc-text">结构分析</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B1%9E%E6%80%A7-4"><span class="toc-number">14.1.2.</span> <span class="toc-text">属性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%8B%E4%BB%B6-4"><span class="toc-number">14.1.3.</span> <span class="toc-text">事件</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E4%BB%A3%E7%A0%81%E7%BC%96%E5%86%99-8"><span class="toc-number">14.2.</span> <span class="toc-text">(2) 代码编写</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%9F%BA%E6%9C%AC%E7%BB%93%E6%9E%84"><span class="toc-number">14.2.1.</span> <span class="toc-text">1.基本结构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E9%80%89%E4%B8%AD%E9%80%89%E9%A1%B9%E5%8A%9F%E8%83%BD"><span class="toc-number">14.2.2.</span> <span class="toc-text">2.选中选项功能</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E5%88%9D%E6%AD%A5%E6%A0%B7%E5%BC%8F%E7%BC%96%E5%86%99"><span class="toc-number">14.2.3.</span> <span class="toc-text">3.初步样式编写</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E6%B7%BB%E5%8A%A0%E7%AE%AD%E5%A4%B4%E5%9B%BE%E6%A0%87"><span class="toc-number">14.2.4.</span> <span class="toc-text">4.添加箭头图标</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-%E6%94%AF%E6%8C%81%E6%B8%85%E7%A9%BA"><span class="toc-number">14.2.5.</span> <span class="toc-text">5.支持清空</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-%E6%94%AF%E6%8C%81%E8%87%AA%E5%AE%9A%E4%B9%89%E6%A8%A1%E6%9D%BF"><span class="toc-number">14.2.6.</span> <span class="toc-text">6.支持自定义模板</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-%E6%94%AF%E6%8C%81%E7%AD%9B%E9%80%89"><span class="toc-number">14.2.7.</span> <span class="toc-text">7.支持筛选</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-%E6%94%AF%E6%8C%81%E8%BF%9C%E7%A8%8B%E6%90%9C%E7%B4%A2"><span class="toc-number">14.2.8.</span> <span class="toc-text">8.支持远程搜索</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-%E8%BF%9C%E7%A8%8B%E8%AF%B7%E6%B1%82%E6%B7%BB%E5%8A%A0%E9%98%B2%E6%8A%96%E9%83%A8%E5%88%86"><span class="toc-number">14.2.9.</span> <span class="toc-text">9.远程请求添加防抖部分</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10-%E6%94%AF%E6%8C%81%E9%94%AE%E7%9B%98%E6%93%8D%E4%BD%9C"><span class="toc-number">14.2.10.</span> <span class="toc-text">10.支持键盘操作</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Select-%E6%80%BB%E7%BB%93"><span class="toc-number">14.3.</span> <span class="toc-text">(3) Select 总结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#15-Form-%E7%BB%84%E4%BB%B6"><span class="toc-number">15.</span> <span class="toc-text">15.Form 组件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90-10"><span class="toc-number">15.1.</span> <span class="toc-text">(1) 需求分析</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6%E7%BB%93%E6%9E%84%E8%AE%BE%E8%AE%A1%EF%BC%9A"><span class="toc-number">15.1.1.</span> <span class="toc-text">组件结构设计：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BC%80%E5%8F%91%E6%AD%A5%E9%AA%A4%EF%BC%9A%E4%BB%8E%E9%9D%99%E5%88%B0%E5%8A%A8"><span class="toc-number">15.1.2.</span> <span class="toc-text">开发步骤：从静到动</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E4%BB%A3%E7%A0%81%E7%BC%96%E5%86%99-9"><span class="toc-number">15.2.</span> <span class="toc-text">(2) 代码编写</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#0-%E6%B5%81%E7%A8%8B%E5%9B%BE"><span class="toc-number">15.2.1.</span> <span class="toc-text">0.流程图</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%9F%BA%E7%A1%80%E7%BB%93%E6%9E%84"><span class="toc-number">15.2.2.</span> <span class="toc-text">1.基础结构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E6%B7%BB%E5%8A%A0%E6%95%B0%E6%8D%AE%E5%92%8C%E8%A7%84%E5%88%99"><span class="toc-number">15.2.3.</span> <span class="toc-text">2.添加数据和规则</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E8%8E%B7%E5%8F%96%E6%95%B0%E6%8D%AE%E5%92%8C%E8%A7%84%E5%88%99"><span class="toc-number">15.2.4.</span> <span class="toc-text">3.获取数据和规则</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E5%AD%A6%E4%B9%A0%E4%BD%BF%E7%94%A8-async-val%EF%BC%88%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93%EF%BC%89"><span class="toc-number">15.2.5.</span> <span class="toc-text">4.学习使用 async-val（第三方库）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-FormItem%E5%AE%8C%E6%88%90%E9%AA%8C%E8%AF%81"><span class="toc-number">15.2.6.</span> <span class="toc-text">5.FormItem完成验证</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%AA%8C%E8%AF%81%E7%9A%84%E5%9F%BA%E6%9C%AC%E8%A6%81%E7%B4%A0"><span class="toc-number">15.2.6.1.</span> <span class="toc-text">验证的基本要素</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%AE%BE%E8%AE%A1%E9%AA%8C%E8%AF%81%E7%9A%84%E6%B5%81%E7%A8%8B"><span class="toc-number">15.2.6.2.</span> <span class="toc-text">设计验证的流程</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8D%95%E4%B8%AA%E9%AA%8C%E8%AF%81%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%96%B9%E5%BC%8F"><span class="toc-number">15.2.6.3.</span> <span class="toc-text">单个验证的实现方式</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-%E8%87%AA%E5%8A%A8%E8%A7%A6%E5%8F%91%E9%AA%8C%E8%AF%81"><span class="toc-number">15.2.7.</span> <span class="toc-text">6.自动触发验证</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%AA%8C%E8%AF%81%E7%9A%84%E5%9C%BA%E6%99%AF"><span class="toc-number">15.2.7.1.</span> <span class="toc-text">验证的场景</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93async-validator%E5%AE%9E%E7%8E%B0%E7%89%B9%E6%AE%8A%E9%AA%8C%E8%AF%81"><span class="toc-number">15.2.7.2.</span> <span class="toc-text">使用第三方库async-validator实现特殊验证</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-%E6%B7%BB%E5%8A%A0Trigger%E6%9D%A1%E4%BB%B6"><span class="toc-number">15.2.8.</span> <span class="toc-text">7.添加Trigger条件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-%E7%88%B6%E5%AD%90%E7%BB%84%E4%BB%B6%E9%80%9A%E4%BF%A1"><span class="toc-number">15.2.9.</span> <span class="toc-text">8.父子组件通信</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-%E5%AE%8C%E6%88%90%E8%A1%A8%E5%8D%95%E6%95%B4%E4%B8%AA%E9%AA%8C%E8%AF%81%E5%8A%9F%E8%83%BD"><span class="toc-number">15.2.10.</span> <span class="toc-text">9.完成表单整个验证功能</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10-%E6%B7%BB%E5%8A%A0%E9%87%8D%E7%BD%AE%E7%8A%B6%E6%80%81%E5%8A%9F%E8%83%BD"><span class="toc-number">15.2.11.</span> <span class="toc-text">10.添加重置状态功能</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#11-%E6%B7%BB%E5%8A%A0%E6%A0%B7%E5%BC%8F"><span class="toc-number">15.2.12.</span> <span class="toc-text">11.添加样式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#12-%E4%BC%98%E5%8C%96%E6%95%B4%E5%90%88"><span class="toc-number">15.2.13.</span> <span class="toc-text">12.优化整合</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%A7%A3%E5%86%B3promise%E9%94%99%E8%AF%AF"><span class="toc-number">15.2.13.1.</span> <span class="toc-text">解决promise错误</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Form%E6%80%BB%E7%BB%93"><span class="toc-number">15.3.</span> <span class="toc-text">(3) Form总结</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%88%B6%E5%AD%90%E7%BB%84%E4%BB%B6%E6%95%B0%E6%8D%AE%E4%BC%A0%E9%80%92%E7%9A%84%E5%B8%B8%E7%94%A8%E6%96%B9%E5%BC%8F"><span class="toc-number">15.3.1.</span> <span class="toc-text">父子组件数据传递的常用方式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%80%E4%BA%9B%E5%B0%8F%E7%9A%84Tip"><span class="toc-number">15.3.2.</span> <span class="toc-text">一些小的Tip</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#16-%E7%BB%84%E4%BB%B6%E5%BA%93%E6%89%93%E5%8C%85%E4%B8%8E%E5%8F%91%E5%B8%83"><span class="toc-number">16.</span> <span class="toc-text">16.组件库打包与发布</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A1"><span class="toc-number">16.1.</span> <span class="toc-text">任务</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%9D%97%E5%8C%96"><span class="toc-number">16.2.</span> <span class="toc-text">模块化</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A8%A1%E5%9D%97%E5%8C%96%E6%98%AF%E4%BB%80%E4%B9%88"><span class="toc-number">16.2.1.</span> <span class="toc-text">模块化是什么</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A8%A1%E5%9D%97%E5%8C%96%E7%9A%84%E4%BC%98%E7%82%B9"><span class="toc-number">16.2.2.</span> <span class="toc-text">模块化的优点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ES6%E4%B9%8B%E5%89%8D%E6%B2%A1%E6%9C%89%E6%A8%A1%E5%9D%97%E7%9A%84%E5%B9%B4%E4%BB%A3"><span class="toc-number">16.2.3.</span> <span class="toc-text">ES6之前没有模块的年代</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#backbone-js"><span class="toc-number">16.2.3.1.</span> <span class="toc-text">backbone.js</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F-%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4-namespace"><span class="toc-number">16.2.3.2.</span> <span class="toc-text">全局变量+命名空间(namespace)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#AMD-Asynchronous-module-definition"><span class="toc-number">16.2.3.3.</span> <span class="toc-text">AMD - (Asynchronous module definition)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#ES6"><span class="toc-number">16.2.3.4.</span> <span class="toc-text">ES6</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Bundler"><span class="toc-number">16.3.</span> <span class="toc-text">Bundler</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%9E%E7%94%9F%E5%8E%9F%E5%9B%A0"><span class="toc-number">16.3.1.</span> <span class="toc-text">诞生原因</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%98%AF%E4%BB%80%E4%B9%88"><span class="toc-number">16.3.2.</span> <span class="toc-text">是什么</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Webpack"><span class="toc-number">16.3.3.</span> <span class="toc-text">Webpack</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Rollup"><span class="toc-number">16.3.4.</span> <span class="toc-text">Rollup</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Vite%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="toc-number">16.4.</span> <span class="toc-text">Vite的工作原理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A3%E5%86%B3%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-number">16.4.1.</span> <span class="toc-text">解决的问题</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Vite%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83-%E2%80%94esbuild"><span class="toc-number">16.4.2.</span> <span class="toc-text">Vite开发环境 —esbuild</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Vite%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83-%E2%80%94Rollup"><span class="toc-number">16.4.3.</span> <span class="toc-text">Vite生产环境 —Rollup</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Webpack%E6%89%93%E5%8C%85%E6%B5%81%E7%A8%8B"><span class="toc-number">16.4.4.</span> <span class="toc-text">Webpack打包流程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ESM-%E6%89%93%E5%8C%85%E6%B5%81%E7%A8%8B"><span class="toc-number">16.4.5.</span> <span class="toc-text">ESM 打包流程</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%93%E5%8C%85%E4%BB%80%E4%B9%88%E7%B1%BB%E5%9E%8B%E7%9A%84%E6%A8%A1%E5%9D%97"><span class="toc-number">16.5.</span> <span class="toc-text">打包什么类型的模块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Vue3%E7%9A%84%E6%8F%92%E4%BB%B6%E7%B3%BB%E7%BB%9F"><span class="toc-number">16.6.</span> <span class="toc-text">Vue3的插件系统</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BA%94%E7%94%A8"><span class="toc-number">16.6.1.</span> <span class="toc-text">应用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE"><span class="toc-number">16.6.2.</span> <span class="toc-text">配置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8A%9F%E8%83%BD"><span class="toc-number">16.6.3.</span> <span class="toc-text">功能</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%80%E4%B8%AA%E6%8F%92%E4%BB%B6%E9%85%8D%E7%BD%AE%E7%9A%84%E4%BE%8B%E5%AD%90"><span class="toc-number">16.6.4.</span> <span class="toc-text">一个插件配置的例子</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95"><span class="toc-number">16.6.5.</span> <span class="toc-text">使用方法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%93%E5%8C%85%E7%BB%84%E4%BB%B6%E5%BA%93"><span class="toc-number">16.7.</span> <span class="toc-text">打包组件库</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Vite%E6%9E%84%E5%BB%BA%E7%94%9F%E4%BA%A7%E7%89%88%E6%9C%AC"><span class="toc-number">16.7.1.</span> <span class="toc-text">Vite构建生产版本</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BA%93%E6%A8%A1%E5%BC%8F"><span class="toc-number">16.7.2.</span> <span class="toc-text">库模式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E7%BB%84%E4%BB%B6%E5%BA%93%E7%9A%84rollup"><span class="toc-number">16.7.3.</span> <span class="toc-text">配置组件库的rollup</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%9F%E6%88%90%E7%B1%BB%E5%9E%8B%E5%AE%9A%E4%B9%89%E6%96%87%E4%BB%B6"><span class="toc-number">16.7.4.</span> <span class="toc-text">生成类型定义文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%9F%E6%88%90%E6%A0%B7%E5%BC%8F%E6%96%87%E4%BB%B6"><span class="toc-number">16.7.5.</span> <span class="toc-text">生成样式文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%91%E5%B8%83npm"><span class="toc-number">16.7.6.</span> <span class="toc-text">发布npm</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#NPM%E7%AE%80%E4%BB%8B"><span class="toc-number">16.7.6.1.</span> <span class="toc-text">NPM简介</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%AF%AD%E4%B9%89%E5%8C%96%E7%89%88%E6%9C%AC"><span class="toc-number">16.7.6.2.</span> <span class="toc-text">语义化版本</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Pre-Post-scripts"><span class="toc-number">16.7.6.3.</span> <span class="toc-text">Pre&amp;Post scripts</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Life-Cycle-Scripts"><span class="toc-number">16.7.6.4.</span> <span class="toc-text">Life Cycle Scripts</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#npm-publish%E4%BC%9A%E8%A7%A6%E5%8F%91%E7%9A%84hooks"><span class="toc-number">16.7.6.5.</span> <span class="toc-text">npm publish会触发的hooks</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#npm%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4"><span class="toc-number">16.7.6.6.</span> <span class="toc-text">npm命名空间</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8F%91%E5%B8%83%E6%88%90%E5%8A%9F"><span class="toc-number">16.7.6.7.</span> <span class="toc-text">发布成功</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">16.8.</span> <span class="toc-text">总结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E9%9A%BE%E7%82%B9"><span class="toc-number">17.</span> <span class="toc-text">项目难点:</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/04/15/scss/" title="scss"><img src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="scss"/></a><div class="content"><a class="title" href="/2024/04/15/scss/" title="scss">scss</a><time datetime="2024-04-14T16:30:57.000Z" title="发表于 2024-04-15 00:30:57">2024-04-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/04/12/uniapp%E5%AD%A6%E4%B9%A0/" title="Uniapp学习"><img src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Uniapp学习"/></a><div class="content"><a class="title" href="/2024/04/12/uniapp%E5%AD%A6%E4%B9%A0/" title="Uniapp学习">Uniapp学习</a><time datetime="2024-04-12T13:02:56.000Z" title="发表于 2024-04-12 21:02:56">2024-04-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/04/10/%E4%BC%9A%E8%AF%9D%E6%8E%A7%E5%88%B6%E5%AD%A6%E4%B9%A0/" title="会话控制"><img src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="会话控制"/></a><div class="content"><a class="title" href="/2024/04/10/%E4%BC%9A%E8%AF%9D%E6%8E%A7%E5%88%B6%E5%AD%A6%E4%B9%A0/" title="会话控制">会话控制</a><time datetime="2024-04-10T13:40:38.000Z" title="发表于 2024-04-10 21:40:38">2024-04-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/04/10/%E6%8E%A5%E5%8F%A3%E5%AD%A6%E4%B9%A0/" title="接口"><img src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="接口"/></a><div class="content"><a class="title" href="/2024/04/10/%E6%8E%A5%E5%8F%A3%E5%AD%A6%E4%B9%A0/" title="接口">接口</a><time datetime="2024-04-09T17:21:01.000Z" title="发表于 2024-04-10 01:21:01">2024-04-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/04/08/%E8%AE%B0%E5%BD%95%E7%AC%AC%E4%B8%80%E6%AC%A1%E9%A1%B9%E7%9B%AE%E4%B8%8A%E4%BC%A0Github/" title="记录第一次项目上传Github"><img src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="记录第一次项目上传Github"/></a><div class="content"><a class="title" href="/2024/04/08/%E8%AE%B0%E5%BD%95%E7%AC%AC%E4%B8%80%E6%AC%A1%E9%A1%B9%E7%9B%AE%E4%B8%8A%E4%BC%A0Github/" title="记录第一次项目上传Github">记录第一次项目上传Github</a><time datetime="2024-04-08T08:49:15.000Z" title="发表于 2024-04-08 16:49:15">2024-04-08</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2023 - 2024 By 黑板擦</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>